const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Cizri-kS.js","./Du3brXL7.js","./entry.Dwv9dJo8.css"])))=>i.map(i=>d[i]);
import{c7 as e,cn as t,co as r,c6 as n,c8 as i}from"./Du3brXL7.js";var s,o={exports:{}};function a(){if(s)return o.exports;s=1;var e,t="object"==typeof Reflect?Reflect:null,r=t&&"function"==typeof t.apply?t.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};e=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var n=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}o.exports=i,o.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,s),n(r)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}y(e,t,s,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&y(e,"error",t,r)}(e,i,{once:!0})}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function h(e,t,r,n){var i,s,o;if(c(r),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),o=s[t]),void 0===o)o=s[t]=r,++e._eventsCount;else if("function"==typeof o?o=s[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),(i=u(e))>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=o.length,console&&console.warn}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=l.bind(n);return i.listener=r,n.wrapFn=i,i}function p(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):g(i,i.length)}function d(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function g(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function y(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(s){n.once&&e.removeEventListener(t,i),r(s)}))}}return Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return u(this)},i.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(void 0===c)return!1;if("function"==typeof c)r(c,this,t);else{var u=c.length,h=g(c,u);for(n=0;n<u;++n)r(h[n],this,t)}return!0},i.prototype.addListener=function(e,t){return h(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return h(this,e,t,!0)},i.prototype.once=function(e,t){return c(t),this.on(e,f(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,f(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,n,i,s,o;if(c(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){o=r[s].listener,i=s;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,s=Object.keys(r);for(n=0;n<s.length;++n)"removeListener"!==(i=s[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},i.prototype.listeners=function(e){return p(this,e,!0)},i.prototype.rawListeners=function(e){return p(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},i.prototype.listenerCount=d,i.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]},o.exports}var c=a();const u=e(c);var h,l,f={},p={},d={},g={};function y(){if(l)return d;l=1,Object.defineProperty(d,"__esModule",{value:!0});var e,t=(h||(h=1,e=g,Object.defineProperty(e,"__esModule",{value:!0}),e.mul=Math.imul||function(e,t){var r=65535&e,n=65535&t;return r*n+((e>>>16&65535)*n+r*(t>>>16&65535)<<16>>>0)|0},e.add=function(e,t){return e+t|0},e.sub=function(e,t){return e-t|0},e.rotl=function(e,t){return e<<t|e>>>32-t},e.rotr=function(e,t){return e<<32-t|e>>>t},e.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},e.MAX_SAFE_INTEGER=9007199254740991,e.isSafeInteger=function(t){return e.isInteger(t)&&t>=-e.MAX_SAFE_INTEGER&&t<=e.MAX_SAFE_INTEGER}),g);function r(e,t,r){return void 0===t&&(t=new Uint8Array(2)),void 0===r&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}function n(e,t,r){return void 0===t&&(t=new Uint8Array(2)),void 0===r&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}function i(e,t){return void 0===t&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function s(e,t){return void 0===t&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function o(e,t){return void 0===t&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function a(e,t){return void 0===t&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}function c(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}function u(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}function f(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),c(e/4294967296>>>0,t,r),c(e>>>0,t,r+4),t}function p(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),u(e>>>0,t,r),u(e/4294967296>>>0,t,r+4),t}return d.readInt16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16},d.readUint16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])>>>0},d.readInt16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])<<16>>16},d.readUint16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])>>>0},d.writeUint16BE=r,d.writeInt16BE=r,d.writeUint16LE=n,d.writeInt16LE=n,d.readInt32BE=i,d.readUint32BE=s,d.readInt32LE=o,d.readUint32LE=a,d.writeUint32BE=c,d.writeInt32BE=c,d.writeUint32LE=u,d.writeInt32LE=u,d.readInt64BE=function(e,t){void 0===t&&(t=0);var r=i(e,t),n=i(e,t+4);return 4294967296*r+n-4294967296*(n>>31)},d.readUint64BE=function(e,t){return void 0===t&&(t=0),4294967296*s(e,t)+s(e,t+4)},d.readInt64LE=function(e,t){void 0===t&&(t=0);var r=o(e,t);return 4294967296*o(e,t+4)+r-4294967296*(r>>31)},d.readUint64LE=function(e,t){void 0===t&&(t=0);var r=a(e,t);return 4294967296*a(e,t+4)+r},d.writeUint64BE=f,d.writeInt64BE=f,d.writeUint64LE=p,d.writeInt64LE=p,d.readUintBE=function(e,t,r){if(void 0===r&&(r=0),e%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=e/8+r-1;s>=r;s--)n+=t[s]*i,i*=256;return n},d.readUintLE=function(e,t,r){if(void 0===r&&(r=0),e%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+e/8;s++)n+=t[s]*i,i*=256;return n},d.writeUintBE=function(e,r,n,i){if(void 0===n&&(n=new Uint8Array(e/8)),void 0===i&&(i=0),e%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!t.isSafeInteger(r))throw new Error("writeUintBE value must be an integer");for(var s=1,o=e/8+i-1;o>=i;o--)n[o]=r/s&255,s*=256;return n},d.writeUintLE=function(e,r,n,i){if(void 0===n&&(n=new Uint8Array(e/8)),void 0===i&&(i=0),e%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!t.isSafeInteger(r))throw new Error("writeUintLE value must be an integer");for(var s=1,o=i;o<i+e/8;o++)n[o]=r/s&255,s*=256;return n},d.readFloat32BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t)},d.readFloat32LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!0)},d.readFloat64BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t)},d.readFloat64LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!0)},d.writeFloat32BE=function(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(r,e),t},d.writeFloat32LE=function(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(r,e,!0),t},d.writeFloat64BE=function(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(r,e),t},d.writeFloat64LE=function(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(r,e,!0),t},d}var v,m,b={};function _(){if(v)return b;return v=1,Object.defineProperty(b,"__esModule",{value:!0}),b.wipe=function(e){for(var t=0;t<e.length;t++)e[t]=0;return e},b}var w,E,S,I={},O={};function P(){if(w)return O;function e(e,t){if(e.length!==t.length)return 0;for(var r=0,n=0;n<e.length;n++)r|=e[n]^t[n];return 1&r-1>>>8}return w=1,Object.defineProperty(O,"__esModule",{value:!0}),O.select=function(e,t,r){return~(e-1)&t|e-1&r},O.lessOrEqual=function(e,t){return(0|e)-(0|t)-1>>>31&1},O.compare=e,O.equal=function(t,r){return 0!==t.length&&0!==r.length&&0!==e(t,r)},O}var A,N,T,x=(S||(S=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=function(){if(m)return p;m=1,Object.defineProperty(p,"__esModule",{value:!0});var e=y(),t=_();function r(t,r,n){for(var i=1634760805,s=857760878,o=2036477234,a=1797285236,c=n[3]<<24|n[2]<<16|n[1]<<8|n[0],u=n[7]<<24|n[6]<<16|n[5]<<8|n[4],h=n[11]<<24|n[10]<<16|n[9]<<8|n[8],l=n[15]<<24|n[14]<<16|n[13]<<8|n[12],f=n[19]<<24|n[18]<<16|n[17]<<8|n[16],p=n[23]<<24|n[22]<<16|n[21]<<8|n[20],d=n[27]<<24|n[26]<<16|n[25]<<8|n[24],g=n[31]<<24|n[30]<<16|n[29]<<8|n[28],y=r[3]<<24|r[2]<<16|r[1]<<8|r[0],v=r[7]<<24|r[6]<<16|r[5]<<8|r[4],m=r[11]<<24|r[10]<<16|r[9]<<8|r[8],b=r[15]<<24|r[14]<<16|r[13]<<8|r[12],_=i,w=s,E=o,S=a,I=c,O=u,P=h,A=l,N=f,T=p,x=d,R=g,j=y,C=v,U=m,L=b,M=0;M<20;M+=2)I=(I^=N=N+(j=(j^=_=_+I|0)>>>16|j<<16)|0)>>>20|I<<12,O=(O^=T=T+(C=(C^=w=w+O|0)>>>16|C<<16)|0)>>>20|O<<12,P=(P^=x=x+(U=(U^=E=E+P|0)>>>16|U<<16)|0)>>>20|P<<12,A=(A^=R=R+(L=(L^=S=S+A|0)>>>16|L<<16)|0)>>>20|A<<12,P=(P^=x=x+(U=(U^=E=E+P|0)>>>24|U<<8)|0)>>>25|P<<7,A=(A^=R=R+(L=(L^=S=S+A|0)>>>24|L<<8)|0)>>>25|A<<7,O=(O^=T=T+(C=(C^=w=w+O|0)>>>24|C<<8)|0)>>>25|O<<7,I=(I^=N=N+(j=(j^=_=_+I|0)>>>24|j<<8)|0)>>>25|I<<7,O=(O^=x=x+(L=(L^=_=_+O|0)>>>16|L<<16)|0)>>>20|O<<12,P=(P^=R=R+(j=(j^=w=w+P|0)>>>16|j<<16)|0)>>>20|P<<12,A=(A^=N=N+(C=(C^=E=E+A|0)>>>16|C<<16)|0)>>>20|A<<12,I=(I^=T=T+(U=(U^=S=S+I|0)>>>16|U<<16)|0)>>>20|I<<12,A=(A^=N=N+(C=(C^=E=E+A|0)>>>24|C<<8)|0)>>>25|A<<7,I=(I^=T=T+(U=(U^=S=S+I|0)>>>24|U<<8)|0)>>>25|I<<7,P=(P^=R=R+(j=(j^=w=w+P|0)>>>24|j<<8)|0)>>>25|P<<7,O=(O^=x=x+(L=(L^=_=_+O|0)>>>24|L<<8)|0)>>>25|O<<7;e.writeUint32LE(_+i|0,t,0),e.writeUint32LE(w+s|0,t,4),e.writeUint32LE(E+o|0,t,8),e.writeUint32LE(S+a|0,t,12),e.writeUint32LE(I+c|0,t,16),e.writeUint32LE(O+u|0,t,20),e.writeUint32LE(P+h|0,t,24),e.writeUint32LE(A+l|0,t,28),e.writeUint32LE(N+f|0,t,32),e.writeUint32LE(T+p|0,t,36),e.writeUint32LE(x+d|0,t,40),e.writeUint32LE(R+g|0,t,44),e.writeUint32LE(j+y|0,t,48),e.writeUint32LE(C+v|0,t,52),e.writeUint32LE(U+m|0,t,56),e.writeUint32LE(L+b|0,t,60)}function n(e,n,s,o,a){if(void 0===a&&(a=0),32!==e.length)throw new Error("ChaCha: key size must be 32 bytes");if(o.length<s.length)throw new Error("ChaCha: destination is shorter than source");var c,u;if(0===a){if(8!==n.length&&12!==n.length)throw new Error("ChaCha nonce must be 8 or 12 bytes");u=(c=new Uint8Array(16)).length-n.length,c.set(n,u)}else{if(16!==n.length)throw new Error("ChaCha nonce with counter must be 16 bytes");c=n,u=a}for(var h=new Uint8Array(64),l=0;l<s.length;l+=64){r(h,c,e);for(var f=l;f<l+64&&f<s.length;f++)o[f]=s[f]^h[f-l];i(c,0,u)}return t.wipe(h),0===a&&t.wipe(c),o}function i(e,t,r){for(var n=1;r--;)n=n+(255&e[t])|0,e[t]=255&n,n>>>=8,t++;if(n>0)throw new Error("ChaCha: counter overflow")}return p.streamXOR=n,p.stream=function(e,r,i,s){return void 0===s&&(s=0),t.wipe(i),n(e,r,i,i,s)},p}(),r=(E||(E=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=P(),r=_();e.DIGEST_LENGTH=16;var n=function(){function t(t){this.digestLength=e.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=t[0]|t[1]<<8;this._r[0]=8191&r;var n=t[2]|t[3]<<8;this._r[1]=8191&(r>>>13|n<<3);var i=t[4]|t[5]<<8;this._r[2]=7939&(n>>>10|i<<6);var s=t[6]|t[7]<<8;this._r[3]=8191&(i>>>7|s<<9);var o=t[8]|t[9]<<8;this._r[4]=255&(s>>>4|o<<12),this._r[5]=o>>>1&8190;var a=t[10]|t[11]<<8;this._r[6]=8191&(o>>>14|a<<2);var c=t[12]|t[13]<<8;this._r[7]=8065&(a>>>11|c<<5);var u=t[14]|t[15]<<8;this._r[8]=8191&(c>>>8|u<<8),this._r[9]=u>>>5&127,this._pad[0]=t[16]|t[17]<<8,this._pad[1]=t[18]|t[19]<<8,this._pad[2]=t[20]|t[21]<<8,this._pad[3]=t[22]|t[23]<<8,this._pad[4]=t[24]|t[25]<<8,this._pad[5]=t[26]|t[27]<<8,this._pad[6]=t[28]|t[29]<<8,this._pad[7]=t[30]|t[31]<<8}return t.prototype._blocks=function(e,t,r){for(var n=this._fin?0:2048,i=this._h[0],s=this._h[1],o=this._h[2],a=this._h[3],c=this._h[4],u=this._h[5],h=this._h[6],l=this._h[7],f=this._h[8],p=this._h[9],d=this._r[0],g=this._r[1],y=this._r[2],v=this._r[3],m=this._r[4],b=this._r[5],_=this._r[6],w=this._r[7],E=this._r[8],S=this._r[9];r>=16;){var I=e[t+0]|e[t+1]<<8;i+=8191&I;var O=e[t+2]|e[t+3]<<8;s+=8191&(I>>>13|O<<3);var P=e[t+4]|e[t+5]<<8;o+=8191&(O>>>10|P<<6);var A=e[t+6]|e[t+7]<<8;a+=8191&(P>>>7|A<<9);var N=e[t+8]|e[t+9]<<8;c+=8191&(A>>>4|N<<12),u+=N>>>1&8191;var T=e[t+10]|e[t+11]<<8;h+=8191&(N>>>14|T<<2);var x=e[t+12]|e[t+13]<<8;l+=8191&(T>>>11|x<<5);var R=e[t+14]|e[t+15]<<8,j=0,C=j;C+=i*d,C+=s*(5*S),C+=o*(5*E),C+=a*(5*w),j=(C+=c*(5*_))>>>13,C&=8191,C+=u*(5*b),C+=h*(5*m),C+=l*(5*v),C+=(f+=8191&(x>>>8|R<<8))*(5*y);var U=j+=(C+=(p+=R>>>5|n)*(5*g))>>>13;U+=i*g,U+=s*d,U+=o*(5*S),U+=a*(5*E),j=(U+=c*(5*w))>>>13,U&=8191,U+=u*(5*_),U+=h*(5*b),U+=l*(5*m),U+=f*(5*v),j+=(U+=p*(5*y))>>>13,U&=8191;var L=j;L+=i*y,L+=s*g,L+=o*d,L+=a*(5*S),j=(L+=c*(5*E))>>>13,L&=8191,L+=u*(5*w),L+=h*(5*_),L+=l*(5*b),L+=f*(5*m);var M=j+=(L+=p*(5*v))>>>13;M+=i*v,M+=s*y,M+=o*g,M+=a*d,j=(M+=c*(5*S))>>>13,M&=8191,M+=u*(5*E),M+=h*(5*w),M+=l*(5*_),M+=f*(5*b);var D=j+=(M+=p*(5*m))>>>13;D+=i*m,D+=s*v,D+=o*y,D+=a*g,j=(D+=c*d)>>>13,D&=8191,D+=u*(5*S),D+=h*(5*E),D+=l*(5*w),D+=f*(5*_);var k=j+=(D+=p*(5*b))>>>13;k+=i*b,k+=s*m,k+=o*v,k+=a*y,j=(k+=c*g)>>>13,k&=8191,k+=u*d,k+=h*(5*S),k+=l*(5*E),k+=f*(5*w);var $=j+=(k+=p*(5*_))>>>13;$+=i*_,$+=s*b,$+=o*m,$+=a*v,j=($+=c*y)>>>13,$&=8191,$+=u*g,$+=h*d,$+=l*(5*S),$+=f*(5*E);var z=j+=($+=p*(5*w))>>>13;z+=i*w,z+=s*_,z+=o*b,z+=a*m,j=(z+=c*v)>>>13,z&=8191,z+=u*y,z+=h*g,z+=l*d,z+=f*(5*S);var q=j+=(z+=p*(5*E))>>>13;q+=i*E,q+=s*w,q+=o*_,q+=a*b,j=(q+=c*m)>>>13,q&=8191,q+=u*v,q+=h*y,q+=l*g,q+=f*d;var H=j+=(q+=p*(5*S))>>>13;H+=i*S,H+=s*E,H+=o*w,H+=a*_,j=(H+=c*b)>>>13,H&=8191,H+=u*m,H+=h*v,H+=l*y,H+=f*g,i=C=8191&(j=(j=((j+=(H+=p*d)>>>13)<<2)+j|0)+(C&=8191)|0),s=U+=j>>>=13,o=L&=8191,a=M&=8191,c=D&=8191,u=k&=8191,h=$&=8191,l=z&=8191,f=q&=8191,p=H&=8191,t+=16,r-=16}this._h[0]=i,this._h[1]=s,this._h[2]=o,this._h[3]=a,this._h[4]=c,this._h[5]=u,this._h[6]=h,this._h[7]=l,this._h[8]=f,this._h[9]=p},t.prototype.finish=function(e,t){void 0===t&&(t=0);var r,n,i,s,o=new Uint16Array(10);if(this._leftover){for(s=this._leftover,this._buffer[s++]=1;s<16;s++)this._buffer[s]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(r=this._h[1]>>>13,this._h[1]&=8191,s=2;s<10;s++)this._h[s]+=r,r=this._h[s]>>>13,this._h[s]&=8191;for(this._h[0]+=5*r,r=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=r,r=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=r,o[0]=this._h[0]+5,r=o[0]>>>13,o[0]&=8191,s=1;s<10;s++)o[s]=this._h[s]+r,r=o[s]>>>13,o[s]&=8191;for(o[9]-=8192,n=(1^r)-1,s=0;s<10;s++)o[s]&=n;for(n=~n,s=0;s<10;s++)this._h[s]=this._h[s]&n|o[s];for(this._h[0]=65535&(this._h[0]|this._h[1]<<13),this._h[1]=65535&(this._h[1]>>>3|this._h[2]<<10),this._h[2]=65535&(this._h[2]>>>6|this._h[3]<<7),this._h[3]=65535&(this._h[3]>>>9|this._h[4]<<4),this._h[4]=65535&(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14),this._h[5]=65535&(this._h[6]>>>2|this._h[7]<<11),this._h[6]=65535&(this._h[7]>>>5|this._h[8]<<8),this._h[7]=65535&(this._h[8]>>>8|this._h[9]<<5),i=this._h[0]+this._pad[0],this._h[0]=65535&i,s=1;s<8;s++)i=(this._h[s]+this._pad[s]|0)+(i>>>16)|0,this._h[s]=65535&i;return e[t+0]=this._h[0]>>>0,e[t+1]=this._h[0]>>>8,e[t+2]=this._h[1]>>>0,e[t+3]=this._h[1]>>>8,e[t+4]=this._h[2]>>>0,e[t+5]=this._h[2]>>>8,e[t+6]=this._h[3]>>>0,e[t+7]=this._h[3]>>>8,e[t+8]=this._h[4]>>>0,e[t+9]=this._h[4]>>>8,e[t+10]=this._h[5]>>>0,e[t+11]=this._h[5]>>>8,e[t+12]=this._h[6]>>>0,e[t+13]=this._h[6]>>>8,e[t+14]=this._h[7]>>>0,e[t+15]=this._h[7]>>>8,this._finished=!0,this},t.prototype.update=function(e){var t,r=0,n=e.length;if(this._leftover){(t=16-this._leftover)>n&&(t=n);for(var i=0;i<t;i++)this._buffer[this._leftover+i]=e[r+i];if(n-=t,r+=t,this._leftover+=t,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(n>=16&&(t=n-n%16,this._blocks(e,r,t),r+=t,n-=t),n){for(i=0;i<n;i++)this._buffer[this._leftover+i]=e[r+i];this._leftover+=n}return this},t.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},t.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},t}();e.Poly1305=n,e.oneTimeAuth=function(e,t){var r=new n(e);r.update(t);var i=r.digest();return r.clean(),i},e.equal=function(r,n){return r.length===e.DIGEST_LENGTH&&n.length===e.DIGEST_LENGTH&&t.equal(r,n)}}(I)),I),n=_(),i=y(),s=P();e.KEY_LENGTH=32,e.NONCE_LENGTH=12,e.TAG_LENGTH=16;var o=new Uint8Array(16),a=function(){function a(t){if(this.nonceLength=e.NONCE_LENGTH,this.tagLength=e.TAG_LENGTH,t.length!==e.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(t)}return a.prototype.seal=function(e,r,i,s){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var o=new Uint8Array(16);o.set(e,o.length-e.length);var a=new Uint8Array(32);t.stream(this._key,o,a,4);var c,u=r.length+this.tagLength;if(s){if(s.length!==u)throw new Error("ChaCha20Poly1305: incorrect destination length");c=s}else c=new Uint8Array(u);return t.streamXOR(this._key,o,r,c,4),this._authenticate(c.subarray(c.length-this.tagLength,c.length),a,c.subarray(0,c.length-this.tagLength),i),n.wipe(o),c},a.prototype.open=function(e,r,i,o){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(r.length<this.tagLength)return null;var a=new Uint8Array(16);a.set(e,a.length-e.length);var c=new Uint8Array(32);t.stream(this._key,a,c,4);var u=new Uint8Array(this.tagLength);if(this._authenticate(u,c,r.subarray(0,r.length-this.tagLength),i),!s.equal(u,r.subarray(r.length-this.tagLength,r.length)))return null;var h,l=r.length-this.tagLength;if(o){if(o.length!==l)throw new Error("ChaCha20Poly1305: incorrect destination length");h=o}else h=new Uint8Array(l);return t.streamXOR(this._key,a,r.subarray(0,r.length-this.tagLength),h,4),n.wipe(a),h},a.prototype.clean=function(){return n.wipe(this._key),this},a.prototype._authenticate=function(e,t,s,a){var c=new r.Poly1305(t);a&&(c.update(a),a.length%16>0&&c.update(o.subarray(a.length%16))),c.update(s),s.length%16>0&&c.update(o.subarray(s.length%16));var u=new Uint8Array(8);a&&i.writeUint64LE(a.length,u),c.update(u),i.writeUint64LE(s.length,u),c.update(u);for(var h=c.digest(),l=0;l<h.length;l++)e[l]=h[l];c.clean(),n.wipe(h),n.wipe(u)},a}();e.ChaCha20Poly1305=a}(f)),f),R={},j={},C={};function U(){if(N)return j;N=1,Object.defineProperty(j,"__esModule",{value:!0});var e=(A||(A=1,Object.defineProperty(C,"__esModule",{value:!0}),C.isSerializableHash=function(e){return void 0!==e.saveState&&void 0!==e.restoreState&&void 0!==e.cleanSavedState}),C),t=P(),r=_(),n=function(){function t(t,n){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);n.length>this.blockSize?this._inner.update(n).finish(i).clean():i.set(n);for(var s=0;s<i.length;s++)i[s]^=54;this._inner.update(i);for(s=0;s<i.length;s++)i[s]^=106;this._outer.update(i),e.isSerializableHash(this._inner)&&e.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),r.wipe(i)}return t.prototype.reset=function(){if(!e.isSerializableHash(this._inner)||!e.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){e.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),e.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!e.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(t){if(!e.isSerializableHash(this._inner)||!e.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(t){if(!e.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},t}();return j.HMAC=n,j.hmac=function(e,t,r){var i=new n(e,t);i.update(r);var s=i.digest();return i.clean(),s},j.equal=t.equal,j}var L,M=function(){if(T)return R;T=1,Object.defineProperty(R,"__esModule",{value:!0});var e=U(),t=_(),r=function(){function r(t,r,n,i){void 0===n&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=i;var s=e.hmac(this._hash,n,r);this._hmac=new e.HMAC(t,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return r.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(0===e)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},r.prototype.expand=function(e){for(var t=new Uint8Array(e),r=0;r<t.length;r++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[r]=this._buffer[this._bufpos++];return t},r.prototype.clean=function(){this._hmac.clean(),t.wipe(this._buffer),t.wipe(this._counter),this._bufpos=0},r}();return R.HKDF=r,R}(),D={},k={},$={};function z(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var q={};const H=t(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var K,B,V;function F(){if(K)return q;K=1,Object.defineProperty(q,"__esModule",{value:!0}),q.NodeRandomSource=void 0;const e=_();return q.NodeRandomSource=class{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,void 0!==z){const e=H;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(t);for(let e=0;e<n.length;e++)n[e]=r[e];return(0,e.wipe)(r),n}},q}function W(){if(B)return k;B=1,Object.defineProperty(k,"__esModule",{value:!0}),k.SystemRandomSource=void 0;const e=(L||(L=1,Object.defineProperty($,"__esModule",{value:!0}),$.BrowserRandomSource=void 0,$.BrowserRandomSource=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e="undefined"!=typeof self?self.crypto||self.msCrypto:null;e&&void 0!==e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let r=0;r<t.length;r+=65536)this._crypto.getRandomValues(t.subarray(r,r+Math.min(t.length-r,65536)));return t}}),$),t=F();return k.SystemRandomSource=class{constructor(){return this.isAvailable=!1,this.name="",this._source=new e.BrowserRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Browser")):(this._source=new t.NodeRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Node")):void 0)}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}},k}function G(){return V||(V=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.randomStringForEntropy=e.randomString=e.randomUint32=e.randomBytes=e.defaultRandomSource=void 0;const t=W(),r=y(),n=_();function i(t,r=e.defaultRandomSource){return r.randomBytes(t)}e.defaultRandomSource=new t.SystemRandomSource,e.randomBytes=i,e.randomUint32=function(t=e.defaultRandomSource){const s=i(4,t),o=(0,r.readUint32LE)(s);return(0,n.wipe)(s),o};const s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function o(t,r=s,o=e.defaultRandomSource){if(r.length<2)throw new Error("randomString charset is too short");if(r.length>256)throw new Error("randomString charset is too long");let a="";const c=r.length,u=256-256%c;for(;t>0;){const e=i(Math.ceil(256*t/u),o);for(let n=0;n<e.length&&t>0;n++){const i=e[n];i<u&&(a+=r.charAt(i%c),t--)}(0,n.wipe)(e)}return a}e.randomString=o,e.randomStringForEntropy=function(t,r=s,n=e.defaultRandomSource){return o(Math.ceil(t/(Math.log(r.length)/Math.LN2)),r,n)}}(D)),D}var Y,J=G(),Q={};var X,Z=(Y||(Y=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=y(),r=_();e.DIGEST_LENGTH=32,e.BLOCK_SIZE=64;var n=function(){function n(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return n.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},n.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},n.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},n.prototype.update=function(e,t){if(void 0===t&&(t=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var r=0;if(this._bytesHashed+=t,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&t>0;)this._buffer[this._bufferLength++]=e[r++],t--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(t>=this.blockSize&&(r=s(this._temp,this._state,e,r,t),t%=this.blockSize);t>0;)this._buffer[this._bufferLength++]=e[r++],t--;return this},n.prototype.finish=function(e){if(!this._finished){var r=this._bytesHashed,n=this._bufferLength,i=r/536870912|0,o=r<<3,a=r%64<56?64:128;this._buffer[n]=128;for(var c=n+1;c<a-8;c++)this._buffer[c]=0;t.writeUint32BE(i,this._buffer,a-8),t.writeUint32BE(o,this._buffer,a-4),s(this._temp,this._state,this._buffer,0,a),this._finished=!0}for(c=0;c<this.digestLength/4;c++)t.writeUint32BE(this._state[c],e,4*c);return this},n.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},n.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},n.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},n.prototype.cleanSavedState=function(e){r.wipe(e.state),e.buffer&&r.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},n}();e.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(e,r,n,s,o){for(;o>=64;){for(var a=r[0],c=r[1],u=r[2],h=r[3],l=r[4],f=r[5],p=r[6],d=r[7],g=0;g<16;g++){var y=s+4*g;e[g]=t.readUint32BE(n,y)}for(g=16;g<64;g++){var v=e[g-2],m=(v>>>17|v<<15)^(v>>>19|v<<13)^v>>>10,b=((v=e[g-15])>>>7|v<<25)^(v>>>18|v<<14)^v>>>3;e[g]=(m+e[g-7]|0)+(b+e[g-16]|0)}for(g=0;g<64;g++)m=(((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+(l&f^~l&p)|0)+(d+(i[g]+e[g]|0)|0)|0,b=((a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10))+(a&c^a&u^c&u)|0,d=p,p=f,f=l,l=h+m|0,h=u,u=c,c=a,a=m+b|0;r[0]+=a,r[1]+=c,r[2]+=u,r[3]+=h,r[4]+=l,r[5]+=f,r[6]+=p,r[7]+=d,s+=64,o-=64}return s}e.hash=function(e){var t=new n;t.update(e);var r=t.digest();return t.clean(),r}}(Q)),Q),ee={};var te=(X||(X=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.sharedKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.scalarMultBase=e.scalarMult=e.SHARED_KEY_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=void 0;const t=G(),r=_();function n(e){const t=new Float64Array(16);if(e)for(let r=0;r<e.length;r++)t[r]=e[r];return t}e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=32,e.SHARED_KEY_LENGTH=32;const i=new Uint8Array(32);i[0]=9;const s=n([56129,1]);function o(e){let t=1;for(let r=0;r<16;r++){let n=e[r]+t+65535;t=Math.floor(n/65536),e[r]=n-65536*t}e[0]+=t-1+37*(t-1)}function a(e,t,r){const n=~(r-1);for(let i=0;i<16;i++){const r=n&(e[i]^t[i]);e[i]^=r,t[i]^=r}}function c(e,t,r){for(let n=0;n<16;n++)e[n]=t[n]+r[n]}function u(e,t,r){for(let n=0;n<16;n++)e[n]=t[n]-r[n]}function h(e,t,r){let n,i,s=0,o=0,a=0,c=0,u=0,h=0,l=0,f=0,p=0,d=0,g=0,y=0,v=0,m=0,b=0,_=0,w=0,E=0,S=0,I=0,O=0,P=0,A=0,N=0,T=0,x=0,R=0,j=0,C=0,U=0,L=0,M=r[0],D=r[1],k=r[2],$=r[3],z=r[4],q=r[5],H=r[6],K=r[7],B=r[8],V=r[9],F=r[10],W=r[11],G=r[12],Y=r[13],J=r[14],Q=r[15];n=t[0],s+=n*M,o+=n*D,a+=n*k,c+=n*$,u+=n*z,h+=n*q,l+=n*H,f+=n*K,p+=n*B,d+=n*V,g+=n*F,y+=n*W,v+=n*G,m+=n*Y,b+=n*J,_+=n*Q,n=t[1],o+=n*M,a+=n*D,c+=n*k,u+=n*$,h+=n*z,l+=n*q,f+=n*H,p+=n*K,d+=n*B,g+=n*V,y+=n*F,v+=n*W,m+=n*G,b+=n*Y,_+=n*J,w+=n*Q,n=t[2],a+=n*M,c+=n*D,u+=n*k,h+=n*$,l+=n*z,f+=n*q,p+=n*H,d+=n*K,g+=n*B,y+=n*V,v+=n*F,m+=n*W,b+=n*G,_+=n*Y,w+=n*J,E+=n*Q,n=t[3],c+=n*M,u+=n*D,h+=n*k,l+=n*$,f+=n*z,p+=n*q,d+=n*H,g+=n*K,y+=n*B,v+=n*V,m+=n*F,b+=n*W,_+=n*G,w+=n*Y,E+=n*J,S+=n*Q,n=t[4],u+=n*M,h+=n*D,l+=n*k,f+=n*$,p+=n*z,d+=n*q,g+=n*H,y+=n*K,v+=n*B,m+=n*V,b+=n*F,_+=n*W,w+=n*G,E+=n*Y,S+=n*J,I+=n*Q,n=t[5],h+=n*M,l+=n*D,f+=n*k,p+=n*$,d+=n*z,g+=n*q,y+=n*H,v+=n*K,m+=n*B,b+=n*V,_+=n*F,w+=n*W,E+=n*G,S+=n*Y,I+=n*J,O+=n*Q,n=t[6],l+=n*M,f+=n*D,p+=n*k,d+=n*$,g+=n*z,y+=n*q,v+=n*H,m+=n*K,b+=n*B,_+=n*V,w+=n*F,E+=n*W,S+=n*G,I+=n*Y,O+=n*J,P+=n*Q,n=t[7],f+=n*M,p+=n*D,d+=n*k,g+=n*$,y+=n*z,v+=n*q,m+=n*H,b+=n*K,_+=n*B,w+=n*V,E+=n*F,S+=n*W,I+=n*G,O+=n*Y,P+=n*J,A+=n*Q,n=t[8],p+=n*M,d+=n*D,g+=n*k,y+=n*$,v+=n*z,m+=n*q,b+=n*H,_+=n*K,w+=n*B,E+=n*V,S+=n*F,I+=n*W,O+=n*G,P+=n*Y,A+=n*J,N+=n*Q,n=t[9],d+=n*M,g+=n*D,y+=n*k,v+=n*$,m+=n*z,b+=n*q,_+=n*H,w+=n*K,E+=n*B,S+=n*V,I+=n*F,O+=n*W,P+=n*G,A+=n*Y,N+=n*J,T+=n*Q,n=t[10],g+=n*M,y+=n*D,v+=n*k,m+=n*$,b+=n*z,_+=n*q,w+=n*H,E+=n*K,S+=n*B,I+=n*V,O+=n*F,P+=n*W,A+=n*G,N+=n*Y,T+=n*J,x+=n*Q,n=t[11],y+=n*M,v+=n*D,m+=n*k,b+=n*$,_+=n*z,w+=n*q,E+=n*H,S+=n*K,I+=n*B,O+=n*V,P+=n*F,A+=n*W,N+=n*G,T+=n*Y,x+=n*J,R+=n*Q,n=t[12],v+=n*M,m+=n*D,b+=n*k,_+=n*$,w+=n*z,E+=n*q,S+=n*H,I+=n*K,O+=n*B,P+=n*V,A+=n*F,N+=n*W,T+=n*G,x+=n*Y,R+=n*J,j+=n*Q,n=t[13],m+=n*M,b+=n*D,_+=n*k,w+=n*$,E+=n*z,S+=n*q,I+=n*H,O+=n*K,P+=n*B,A+=n*V,N+=n*F,T+=n*W,x+=n*G,R+=n*Y,j+=n*J,C+=n*Q,n=t[14],b+=n*M,_+=n*D,w+=n*k,E+=n*$,S+=n*z,I+=n*q,O+=n*H,P+=n*K,A+=n*B,N+=n*V,T+=n*F,x+=n*W,R+=n*G,j+=n*Y,C+=n*J,U+=n*Q,n=t[15],_+=n*M,w+=n*D,E+=n*k,S+=n*$,I+=n*z,O+=n*q,P+=n*H,A+=n*K,N+=n*B,T+=n*V,x+=n*F,R+=n*W,j+=n*G,C+=n*Y,U+=n*J,L+=n*Q,s+=38*w,o+=38*E,a+=38*S,c+=38*I,u+=38*O,h+=38*P,l+=38*A,f+=38*N,p+=38*T,d+=38*x,g+=38*R,y+=38*j,v+=38*C,m+=38*U,b+=38*L,i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-65536*i,n=o+i+65535,i=Math.floor(n/65536),o=n-65536*i,n=a+i+65535,i=Math.floor(n/65536),a=n-65536*i,n=c+i+65535,i=Math.floor(n/65536),c=n-65536*i,n=u+i+65535,i=Math.floor(n/65536),u=n-65536*i,n=h+i+65535,i=Math.floor(n/65536),h=n-65536*i,n=l+i+65535,i=Math.floor(n/65536),l=n-65536*i,n=f+i+65535,i=Math.floor(n/65536),f=n-65536*i,n=p+i+65535,i=Math.floor(n/65536),p=n-65536*i,n=d+i+65535,i=Math.floor(n/65536),d=n-65536*i,n=g+i+65535,i=Math.floor(n/65536),g=n-65536*i,n=y+i+65535,i=Math.floor(n/65536),y=n-65536*i,n=v+i+65535,i=Math.floor(n/65536),v=n-65536*i,n=m+i+65535,i=Math.floor(n/65536),m=n-65536*i,n=b+i+65535,i=Math.floor(n/65536),b=n-65536*i,n=_+i+65535,i=Math.floor(n/65536),_=n-65536*i,s+=i-1+37*(i-1),i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-65536*i,n=o+i+65535,i=Math.floor(n/65536),o=n-65536*i,n=a+i+65535,i=Math.floor(n/65536),a=n-65536*i,n=c+i+65535,i=Math.floor(n/65536),c=n-65536*i,n=u+i+65535,i=Math.floor(n/65536),u=n-65536*i,n=h+i+65535,i=Math.floor(n/65536),h=n-65536*i,n=l+i+65535,i=Math.floor(n/65536),l=n-65536*i,n=f+i+65535,i=Math.floor(n/65536),f=n-65536*i,n=p+i+65535,i=Math.floor(n/65536),p=n-65536*i,n=d+i+65535,i=Math.floor(n/65536),d=n-65536*i,n=g+i+65535,i=Math.floor(n/65536),g=n-65536*i,n=y+i+65535,i=Math.floor(n/65536),y=n-65536*i,n=v+i+65535,i=Math.floor(n/65536),v=n-65536*i,n=m+i+65535,i=Math.floor(n/65536),m=n-65536*i,n=b+i+65535,i=Math.floor(n/65536),b=n-65536*i,n=_+i+65535,i=Math.floor(n/65536),_=n-65536*i,s+=i-1+37*(i-1),e[0]=s,e[1]=o,e[2]=a,e[3]=c,e[4]=u,e[5]=h,e[6]=l,e[7]=f,e[8]=p,e[9]=d,e[10]=g,e[11]=y,e[12]=v,e[13]=m,e[14]=b,e[15]=_}function l(e,t){h(e,t,t)}function f(e,t){const r=new Uint8Array(32),i=new Float64Array(80),f=n(),p=n(),d=n(),g=n(),y=n(),v=n();for(let n=0;n<31;n++)r[n]=e[n];r[31]=127&e[31]|64,r[0]&=248,function(e,t){for(let r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}(i,t);for(let n=0;n<16;n++)p[n]=i[n];f[0]=g[0]=1;for(let n=254;n>=0;--n){const e=r[n>>>3]>>>(7&n)&1;a(f,p,e),a(d,g,e),c(y,f,d),u(f,f,d),c(d,p,g),u(p,p,g),l(g,y),l(v,f),h(f,d,f),h(d,p,y),c(y,f,d),u(f,f,d),l(p,f),u(d,g,v),h(f,d,s),c(f,f,g),h(d,d,f),h(f,g,v),h(g,p,i),l(p,y),a(f,p,e),a(d,g,e)}for(let n=0;n<16;n++)i[n+16]=f[n],i[n+32]=d[n],i[n+48]=p[n],i[n+64]=g[n];const m=i.subarray(32),b=i.subarray(16);!function(e,t){const r=n();for(let n=0;n<16;n++)r[n]=t[n];for(let n=253;n>=0;n--)l(r,r),2!==n&&4!==n&&h(r,r,t);for(let n=0;n<16;n++)e[n]=r[n]}(m,m),h(b,b,m);const _=new Uint8Array(32);return function(e,t){const r=n(),i=n();for(let n=0;n<16;n++)i[n]=t[n];o(i),o(i),o(i);for(let n=0;n<2;n++){r[0]=i[0]-65517;for(let t=1;t<15;t++)r[t]=i[t]-65535-(r[t-1]>>16&1),r[t-1]&=65535;r[15]=i[15]-32767-(r[14]>>16&1);const e=r[15]>>16&1;r[14]&=65535,a(i,r,1-e)}for(let n=0;n<16;n++)e[2*n]=255&i[n],e[2*n+1]=i[n]>>8}(_,b),_}function p(e){return f(e,i)}function d(t){if(t.length!==e.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${e.SECRET_KEY_LENGTH} bytes`);const r=new Uint8Array(t);return{publicKey:p(r),secretKey:r}}e.scalarMult=f,e.scalarMultBase=p,e.generateKeyPairFromSeed=d,e.generateKeyPair=function(e){const n=(0,t.randomBytes)(32,e),i=d(n);return(0,r.wipe)(n),i},e.sharedKey=function(t,r,n=!1){if(t.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(r.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const i=f(t,r);if(n){let e=0;for(let t=0;t<i.length;t++)e|=i[t];if(0===e)throw new Error("X25519: invalid shared key")}return i}}(ee)),ee);function re(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function ne(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?re(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function ie(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const r=ne(t);let n=0;for(const i of e)r.set(i,n),n+=i.length;return re(r)}var se=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function l(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*u+1>>>0,o=new Uint8Array(s);e[t];){var h=r[e.charCodeAt(t)];if(255===h)return;for(var l=0,f=s-1;(0!==h||l<i)&&-1!==f;f--,l++)h+=a*o[f]>>>0,o[f]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");i=l,t++}if(" "!==e[t]){for(var p=s-i;p!==s&&0===o[p];)p++;for(var d=new Uint8Array(n+(s-p)),g=n;p!==s;)d[g++]=o[p++];return d}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*h+1>>>0,u=new Uint8Array(o);i!==s;){for(var l=t[i],f=0,p=o-1;(0!==l||f<n)&&-1!==p;p--,f++)l+=256*u[p]>>>0,u[p]=l%a>>>0,l=l/a>>>0;if(0!==l)throw new Error("Non-zero carry");n=f,i++}for(var d=o-n;d!==o&&0===u[d];)d++;for(var g=c.repeat(r);d<o;++d)g+=e.charAt(u[d]);return g},decodeUnsafe:l,decode:function(e){var r=l(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class oe{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class ae{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return ue(this,e)}}class ce{constructor(e){this.decoders=e}or(e){return ue(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ue=(e,t)=>new ce({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class he{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new oe(e,t,r),this.decoder=new ae(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const le=({name:e,prefix:t,encode:r,decode:n})=>new he(e,t,r,n),fe=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=se(r,t);return le({prefix:e,name:t,encode:n,decode:e=>(e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")})(i(e))})},pe=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>le({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let h=0;h<t.length;++h)i[t[h]]=h;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let h=0;h<s;++h){const t=i[e[h]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),de=le({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),ge=Object.freeze(Object.defineProperty({__proto__:null,identity:de},Symbol.toStringTag,{value:"Module"})),ye=pe({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),ve=Object.freeze(Object.defineProperty({__proto__:null,base2:ye},Symbol.toStringTag,{value:"Module"})),me=pe({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),be=Object.freeze(Object.defineProperty({__proto__:null,base8:me},Symbol.toStringTag,{value:"Module"})),_e=fe({prefix:"9",name:"base10",alphabet:"0123456789"}),we=Object.freeze(Object.defineProperty({__proto__:null,base10:_e},Symbol.toStringTag,{value:"Module"})),Ee=pe({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Se=pe({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Ie=Object.freeze(Object.defineProperty({__proto__:null,base16:Ee,base16upper:Se},Symbol.toStringTag,{value:"Module"})),Oe=pe({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Pe=pe({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ae=pe({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ne=pe({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Te=pe({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),xe=pe({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Re=pe({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),je=pe({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ce=pe({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Ue=Object.freeze(Object.defineProperty({__proto__:null,base32:Oe,base32hex:Te,base32hexpad:Re,base32hexpadupper:je,base32hexupper:xe,base32pad:Ae,base32padupper:Ne,base32upper:Pe,base32z:Ce},Symbol.toStringTag,{value:"Module"})),Le=fe({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Me=fe({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),De=Object.freeze(Object.defineProperty({__proto__:null,base36:Le,base36upper:Me},Symbol.toStringTag,{value:"Module"})),ke=fe({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),$e=fe({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),ze=Object.freeze(Object.defineProperty({__proto__:null,base58btc:ke,base58flickr:$e},Symbol.toStringTag,{value:"Module"})),qe=pe({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),He=pe({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ke=pe({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Be=pe({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Ve=Object.freeze(Object.defineProperty({__proto__:null,base64:qe,base64pad:He,base64url:Ke,base64urlpad:Be},Symbol.toStringTag,{value:"Module"})),Fe=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),We=Fe.reduce(((e,t,r)=>(e[r]=t,e)),[]),Ge=Fe.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const Ye=le({prefix:"ðŸš€",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=We[t]),"")},decode:function(e){const t=[];for(const r of e){const e=Ge[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}}),Je=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:Ye},Symbol.toStringTag,{value:"Module"}));new TextEncoder,new TextDecoder;const Qe={...ge,...ve,...be,...we,...Ie,...Ue,...De,...ze,...Ve,...Je};function Xe(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Ze=Xe("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),et=Xe("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=ne((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),tt={utf8:Ze,"utf-8":Ze,hex:Qe.base16,latin1:et,ascii:et,binary:et,...Qe};function rt(e,t="utf8"){const r=tt[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):re(globalThis.Buffer.from(e,"utf-8"))}function nt(e,t="utf8"){const r=tt[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}var it={},st=function(e,t){return(st=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ot=function(){return ot=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ot.apply(this,arguments)};function at(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ct(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}function ut(e){return this instanceof ut?(this.v=e,this):new ut(e)}const ht=t(Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return ot},__asyncDelegator:function(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:ut(e[n](t)),done:"return"===n}:i?i(t):t}:i}},__asyncGenerator:function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){s.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=i[e](t)).value instanceof ut?Promise.resolve(r.value.v).then(c,u):h(s[0][2],r)}catch(n){h(s[0][3],n)}var r}function c(e){a("next",e)}function u(e){a("throw",e)}function h(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}},__asyncValues:function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=at(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,i,(t=e[r](t)).done,t.value)}))}}},__await:ut,__awaiter:function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{c(n.next(e))}catch(t){s(t)}}function a(e){try{c(n.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},__classPrivateFieldGet:function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},__classPrivateFieldSet:function(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r},__createBinding:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]},__decorate:function(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},__exportStar:function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])},__extends:function(e,t){function r(){this.constructor=e}st(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},__generator:function(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(a){s=[6,a],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},__importDefault:function(e){return e&&e.__esModule?e:{default:e}},__importStar:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},__makeTemplateObject:function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__metadata:function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param:function(e,t){return function(r,n){t(r,n,e)}},__read:ct,__rest:function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r},__spread:function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(ct(arguments[t]));return e},__spreadArrays:function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n},__values:at},Symbol.toStringTag,{value:"Module"})));var lt,ft={},pt={};var dt,gt={},yt={},vt={};var mt,bt,_t,wt,Et={};function St(){return bt||(bt=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=ht;t.__exportStar((dt||(dt=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.ONE_THOUSAND=vt.ONE_HUNDRED=void 0,vt.ONE_HUNDRED=100,vt.ONE_THOUSAND=1e3),vt),e),t.__exportStar(function(){return mt||(mt=1,e=Et,Object.defineProperty(e,"__esModule",{value:!0}),e.ONE_YEAR=e.FOUR_WEEKS=e.THREE_WEEKS=e.TWO_WEEKS=e.ONE_WEEK=e.THIRTY_DAYS=e.SEVEN_DAYS=e.FIVE_DAYS=e.THREE_DAYS=e.ONE_DAY=e.TWENTY_FOUR_HOURS=e.TWELVE_HOURS=e.SIX_HOURS=e.THREE_HOURS=e.ONE_HOUR=e.SIXTY_MINUTES=e.THIRTY_MINUTES=e.TEN_MINUTES=e.FIVE_MINUTES=e.ONE_MINUTE=e.SIXTY_SECONDS=e.THIRTY_SECONDS=e.TEN_SECONDS=e.FIVE_SECONDS=e.ONE_SECOND=void 0,e.ONE_SECOND=1,e.FIVE_SECONDS=5,e.TEN_SECONDS=10,e.THIRTY_SECONDS=30,e.SIXTY_SECONDS=60,e.ONE_MINUTE=e.SIXTY_SECONDS,e.FIVE_MINUTES=5*e.ONE_MINUTE,e.TEN_MINUTES=10*e.ONE_MINUTE,e.THIRTY_MINUTES=30*e.ONE_MINUTE,e.SIXTY_MINUTES=60*e.ONE_MINUTE,e.ONE_HOUR=e.SIXTY_MINUTES,e.THREE_HOURS=3*e.ONE_HOUR,e.SIX_HOURS=6*e.ONE_HOUR,e.TWELVE_HOURS=12*e.ONE_HOUR,e.TWENTY_FOUR_HOURS=24*e.ONE_HOUR,e.ONE_DAY=e.TWENTY_FOUR_HOURS,e.THREE_DAYS=3*e.ONE_DAY,e.FIVE_DAYS=5*e.ONE_DAY,e.SEVEN_DAYS=7*e.ONE_DAY,e.THIRTY_DAYS=30*e.ONE_DAY,e.ONE_WEEK=e.SEVEN_DAYS,e.TWO_WEEKS=2*e.ONE_WEEK,e.THREE_WEEKS=3*e.ONE_WEEK,e.FOUR_WEEKS=4*e.ONE_WEEK,e.ONE_YEAR=365*e.ONE_DAY),Et;var e}(),e)}(yt)),yt}function It(){return wt||(wt=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=ht;t.__exportStar((lt||(lt=1,Object.defineProperty(pt,"__esModule",{value:!0}),pt.delay=void 0,pt.delay=function(e){return new Promise((t=>{setTimeout((()=>{t(!0)}),e)}))}),pt),e),t.__exportStar(function(){if(_t)return gt;_t=1,Object.defineProperty(gt,"__esModule",{value:!0}),gt.fromMiliseconds=gt.toMiliseconds=void 0;const e=St();return gt.toMiliseconds=function(t){return t*e.ONE_THOUSAND},gt.fromMiliseconds=function(t){return Math.floor(t/e.ONE_THOUSAND)},gt}(),e)}(ft)),ft}var Ot,Pt={};var At,Nt,Tt,xt={},Rt={};function jt(){return Nt||(Nt=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});ht.__exportStar((At||(At=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.IWatch=void 0,Rt.IWatch=class{}),Rt),e)}(xt)),xt}function Ct(){return Tt||(Tt=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=ht;t.__exportStar(It(),e),t.__exportStar(function(){if(Ot)return Pt;Ot=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.Watch=void 0;class e{constructor(){this.timestamps=new Map}start(e){if(this.timestamps.has(e))throw new Error(`Watch already started for label: ${e}`);this.timestamps.set(e,{started:Date.now()})}stop(e){const t=this.get(e);if(void 0!==t.elapsed)throw new Error(`Watch already stopped for label: ${e}`);const r=Date.now()-t.started;this.timestamps.set(e,{started:t.started,elapsed:r})}get(e){const t=this.timestamps.get(e);if(void 0===t)throw new Error(`No timestamp found for label: ${e}`);return t}elapsed(e){const t=this.get(e);return t.elapsed||Date.now()-t.started}}return Pt.Watch=e,Pt.default=e,Pt}(),e),t.__exportStar(jt(),e),t.__exportStar(St(),e)}(it)),it}var Ut,Lt=Ct(),Mt={};function Dt(){if(Ut)return Mt;function e(e){let t;return"undefined"!=typeof window&&void 0!==window[e]&&(t=window[e]),t}function t(t){const r=e(t);if(!r)throw new Error(`${t} is not defined in Window`);return r}return Ut=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.getLocalStorage=Mt.getLocalStorageOrThrow=Mt.getCrypto=Mt.getCryptoOrThrow=Mt.getLocation=Mt.getLocationOrThrow=Mt.getNavigator=Mt.getNavigatorOrThrow=Mt.getDocument=Mt.getDocumentOrThrow=Mt.getFromWindowOrThrow=Mt.getFromWindow=void 0,Mt.getFromWindow=e,Mt.getFromWindowOrThrow=t,Mt.getDocumentOrThrow=function(){return t("document")},Mt.getDocument=function(){return e("document")},Mt.getNavigatorOrThrow=function(){return t("navigator")},Mt.getNavigator=function(){return e("navigator")},Mt.getLocationOrThrow=function(){return t("location")},Mt.getLocation=function(){return e("location")},Mt.getCryptoOrThrow=function(){return t("crypto")},Mt.getCrypto=function(){return e("crypto")},Mt.getLocalStorageOrThrow=function(){return t("localStorage")},Mt.getLocalStorage=function(){return e("localStorage")},Mt}var kt,$t=Dt(),zt={};!function(){if(kt)return zt;kt=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.getWindowMetadata=void 0;const e=Dt();zt.getWindowMetadata=function(){let t,r;try{t=e.getDocumentOrThrow(),r=e.getLocationOrThrow()}catch(s){return null}function n(...e){const r=t.getElementsByTagName("meta");for(let t=0;t<r.length;t++){const n=r[t],i=["itemprop","property","name"].map((e=>n.getAttribute(e))).filter((t=>!!t&&e.includes(t)));if(i.length&&i){const e=n.getAttribute("content");if(e)return e}}return""}const i=function(){let e=n("name","og:site_name","og:title","twitter:title");return e||(e=t.title),e}();return{description:n("description","og:description","twitter:description","keywords"),url:r.origin,icons:function(){const e=t.getElementsByTagName("link"),n=[];for(let t=0;t<e.length;t++){const i=e[t],s=i.getAttribute("rel");if(s&&s.toLowerCase().indexOf("icon")>-1){const e=i.getAttribute("href");if(e)if(-1===e.toLowerCase().indexOf("https:")&&-1===e.toLowerCase().indexOf("http:")&&0!==e.indexOf("//")){let t=r.protocol+"//"+r.host;if(0===e.indexOf("/"))t+=e;else{const n=r.pathname.split("/");n.pop();t+=n.join("/")+"/"+e}n.push(t)}else if(0===e.indexOf("//")){const t=r.protocol+e;n.push(t)}else n.push(e)}}return n}(),name:i}}}();var qt,Ht,Kt,Bt,Vt,Ft,Wt,Gt,Yt,Jt={};function Qt(){return Ht?qt:(Ht=1,qt=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`)))}function Xt(){if(Bt)return Kt;Bt=1;var e="%[a-f0-9]{2}",t=new RegExp("("+e+")|([^%]+?)","gi"),r=new RegExp("("+e+")+","gi");function n(e,t){try{return[decodeURIComponent(e.join(""))]}catch(s){}if(1===e.length)return e;t=t||1;var r=e.slice(0,t),i=e.slice(t);return Array.prototype.concat.call([],n(r),n(i))}function i(e){try{return decodeURIComponent(e)}catch(s){for(var r=e.match(t)||[],i=1;i<r.length;i++)r=(e=n(r,i).join("")).match(t)||[];return e}}return Kt=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var n={"%FE%FF":"ï¿½ï¿½","%FF%FE":"ï¿½ï¿½"},s=r.exec(e);s;){try{n[s[0]]=decodeURIComponent(s[0])}catch(t){var o=i(s[0]);o!==s[0]&&(n[s[0]]=o)}s=r.exec(e)}n["%C2"]="ï¿½";for(var a=Object.keys(n),c=0;c<a.length;c++){var u=a[c];e=e.replace(new RegExp(u,"g"),n[u])}return e}(e)}}}function Zt(){return Ft?Vt:(Ft=1,Vt=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const r=e.indexOf(t);return-1===r?[e]:[e.slice(0,r),e.slice(r+t.length)]})}function er(){return Gt?Wt:(Gt=1,Wt=function(e,t){for(var r={},n=Object.keys(e),i=Array.isArray(t),s=0;s<n.length;s++){var o=n[s],a=e[o];(i?-1!==t.indexOf(o):t(o,a,e))&&(r[o]=a)}return r})}Yt||(Yt=1,function(e){const t=Qt(),r=Xt(),n=Zt(),i=er(),s=Symbol("encodeFragmentIdentifier");function o(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function a(e,r){return r.encode?r.strict?t(e):encodeURIComponent(e):e}function c(e,t){return t.decode?r(e):e}function u(e){return Array.isArray(e)?e.sort():"object"==typeof e?u(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function h(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function l(e){const t=(e=h(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function f(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function p(e,t){o((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const r=function(e){let t;switch(e.arrayFormat){case"index":return(e,r,n)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return(e,r,n)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"colon-list-separator":return(e,r,n)=>{t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"comma":case"separator":return(t,r,n)=>{const i="string"==typeof r&&r.includes(e.arrayFormatSeparator),s="string"==typeof r&&!i&&c(r,e).includes(e.arrayFormatSeparator);r=s?c(r,e):r;const o=i||s?r.split(e.arrayFormatSeparator).map((t=>c(t,e))):null===r?r:c(r,e);n[t]=o};case"bracket-separator":return(t,r,n)=>{const i=/(\[\])$/.test(t);if(t=t.replace(/\[\]$/,""),!i)return void(n[t]=r?c(r,e):r);const s=null===r?[]:r.split(e.arrayFormatSeparator).map((t=>c(t,e)));void 0!==n[t]?n[t]=[].concat(n[t],s):n[t]=s};default:return(e,t,r)=>{void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t),i=Object.create(null);if("string"!=typeof e)return i;if(!(e=e.trim().replace(/^[?#&]/,"")))return i;for(const s of e.split("&")){if(""===s)continue;let[e,o]=n(t.decode?s.replace(/\+/g," "):s,"=");o=void 0===o?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?o:c(o,t),r(c(e,t),o,i)}for(const n of Object.keys(i)){const e=i[n];if("object"==typeof e&&null!==e)for(const r of Object.keys(e))e[r]=f(e[r],t);else i[n]=f(e,t)}return!1===t.sort?i:(!0===t.sort?Object.keys(i).sort():Object.keys(i).sort(t.sort)).reduce(((e,t)=>{const r=i[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=u(r):e[t]=r,e}),Object.create(null))}e.extract=l,e.parse=p,e.stringify=(e,t)=>{if(!e)return"";o((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=r=>t.skipNull&&null==e[r]||t.skipEmptyString&&""===e[r],n=function(e){switch(e.arrayFormat){case"index":return t=>(r,n)=>{const i=r.length;return void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[a(t,e),"[",i,"]"].join("")]:[...r,[a(t,e),"[",a(i,e),"]=",a(n,e)].join("")]};case"bracket":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[a(t,e),"[]"].join("")]:[...r,[a(t,e),"[]=",a(n,e)].join("")];case"colon-list-separator":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[a(t,e),":list="].join("")]:[...r,[a(t,e),":list=",a(n,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return r=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:(i=null===i?"":i,0===n.length?[[a(r,e),t,a(i,e)].join("")]:[[n,a(i,e)].join(e.arrayFormatSeparator)])}default:return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,a(t,e)]:[...r,[a(t,e),"=",a(n,e)].join("")]}}(t),i={};for(const o of Object.keys(e))r(o)||(i[o]=e[o]);const s=Object.keys(i);return!1!==t.sort&&s.sort(t.sort),s.map((r=>{const i=e[r];return void 0===i?"":null===i?a(r,t):Array.isArray(i)?0===i.length&&"bracket-separator"===t.arrayFormat?a(r,t)+"[]":i.reduce(n(r),[]).join("&"):a(r,t)+"="+a(i,t)})).filter((e=>e.length>0)).join("&")},e.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[r,i]=n(e,"#");return Object.assign({url:r.split("?")[0]||"",query:p(l(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:c(i,t)}:{})},e.stringifyUrl=(t,r)=>{r=Object.assign({encode:!0,strict:!0,[s]:!0},r);const n=h(t.url).split("?")[0]||"",i=e.extract(t.url),o=e.parse(i,{sort:!1}),c=Object.assign(o,t.query);let u=e.stringify(c,r);u&&(u=`?${u}`);let l=function(e){let t="";const r=e.indexOf("#");return-1!==r&&(t=e.slice(r)),t}(t.url);return t.fragmentIdentifier&&(l=`#${r[s]?a(t.fragmentIdentifier,r):t.fragmentIdentifier}`),`${n}${u}${l}`},e.pick=(t,r,n)=>{n=Object.assign({parseFragmentIdentifier:!0,[s]:!1},n);const{url:o,query:a,fragmentIdentifier:c}=e.parseUrl(t,n);return e.stringifyUrl({url:o,query:i(a,r),fragmentIdentifier:c},n)},e.exclude=(t,r,n)=>{const i=Array.isArray(r)?e=>!r.includes(e):(e,t)=>!r(e,t);return e.pick(t,i,n)}}(Jt));const tr={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};const rr={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function nr(e,t){return!!Array.isArray(e)}function ir(e,...t){try{return(r=e(...t))&&"function"==typeof r.then?r:Promise.resolve(r)}catch(n){return Promise.reject(n)}var r}function sr(e){if(function(e){const t=typeof e;return null===e||"object"!==t&&"function"!==t}(e))return String(e);if(function(e){const t=Object.getPrototypeOf(e);return!t||t.isPrototypeOf(Object)}(e)||Array.isArray(e))return JSON.stringify(e);if("function"==typeof e.toJSON)return sr(e.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const or="base64:";function ar(e){return"string"==typeof e?e:or+function(e){if(globalThis.Buffer)return Buffer.from(e).toString("base64");return globalThis.btoa(String.fromCodePoint(...e))}(e)}function cr(e){return"string"!=typeof e?e:e.startsWith(or)?function(e){if(globalThis.Buffer)return Buffer.from(e,"base64");return Uint8Array.from(globalThis.atob(e),(e=>e.codePointAt(0)))}(e.slice(7)):e}function ur(e){var t;return e&&(null==(t=e.split("?")[0])?void 0:t.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function hr(...e){return ur(e.join(":"))}function lr(e){return(e=ur(e))?e+":":""}const fr=()=>{const e=new Map;return{name:"memory",getInstance:()=>e,hasItem:t=>e.has(t),getItem:t=>e.get(t)??null,getItemRaw:t=>e.get(t)??null,setItem(t,r){e.set(t,r)},setItemRaw(t,r){e.set(t,r)},removeItem(t){e.delete(t)},getKeys:()=>[...e.keys()],clear(){e.clear()},dispose(){e.clear()}}};function pr(e={}){const t={mounts:{"":e.driver||fr()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},n=e=>{for(const r of t.mountpoints)if(e.startsWith(r))return{base:r,relativeKey:e.slice(r.length),driver:t.mounts[r]};return{base:"",relativeKey:e,driver:t.mounts[""]}},i=(e,r)=>t.mountpoints.filter((t=>t.startsWith(e)||r&&e.startsWith(t))).map((r=>({relativeBase:e.length>r.length?e.slice(r.length):void 0,mountpoint:r,driver:t.mounts[r]}))),s=(e,r)=>{if(t.watching){r=ur(r);for(const n of t.watchListeners)n(e,r)}},o=async()=>{if(t.watching){for(const e in t.unwatch)await t.unwatch[e]();t.unwatch={},t.watching=!1}},a=(e,t,r)=>{const i=new Map,s=e=>{let t=i.get(e.base);return t||(t={driver:e.driver,base:e.base,items:[]},i.set(e.base,t)),t};for(const o of e){const e="string"==typeof o,r=ur(e?o:o.key),i=e?void 0:o.value,a=e||!o.options?t:{...t,...o.options},c=n(r);s(c).items.push({key:r,value:i,relativeKey:c.relativeKey,options:a})}return Promise.all([...i.values()].map((e=>r(e)))).then((e=>e.flat()))},c={hasItem(e,t={}){e=ur(e);const{relativeKey:r,driver:i}=n(e);return ir(i.hasItem,r,t)},getItem(e,t={}){e=ur(e);const{relativeKey:i,driver:s}=n(e);return ir(s.getItem,i,t).then((e=>r(e)))},getItems:(e,t={})=>a(e,t,(e=>e.driver.getItems?ir(e.driver.getItems,e.items.map((e=>({key:e.relativeKey,options:e.options}))),t).then((t=>t.map((t=>({key:hr(e.base,t.key),value:r(t.value)}))))):Promise.all(e.items.map((t=>ir(e.driver.getItem,t.relativeKey,t.options).then((e=>({key:t.key,value:r(e)})))))))),getItemRaw(e,t={}){e=ur(e);const{relativeKey:r,driver:i}=n(e);return i.getItemRaw?ir(i.getItemRaw,r,t):ir(i.getItem,r,t).then((e=>cr(e)))},async setItem(e,t,r={}){if(void 0===t)return c.removeItem(e);e=ur(e);const{relativeKey:i,driver:o}=n(e);o.setItem&&(await ir(o.setItem,i,sr(t),r),o.watch||s("update",e))},async setItems(e,t){await a(e,t,(async e=>{if(e.driver.setItems)return ir(e.driver.setItems,e.items.map((e=>({key:e.relativeKey,value:sr(e.value),options:e.options}))),t);e.driver.setItem&&await Promise.all(e.items.map((t=>ir(e.driver.setItem,t.relativeKey,sr(t.value),t.options))))}))},async setItemRaw(e,t,r={}){if(void 0===t)return c.removeItem(e,r);e=ur(e);const{relativeKey:i,driver:o}=n(e);if(o.setItemRaw)await ir(o.setItemRaw,i,t,r);else{if(!o.setItem)return;await ir(o.setItem,i,ar(t),r)}o.watch||s("update",e)},async removeItem(e,t={}){"boolean"==typeof t&&(t={removeMeta:t}),e=ur(e);const{relativeKey:r,driver:i}=n(e);i.removeItem&&(await ir(i.removeItem,r,t),(t.removeMeta||t.removeMata)&&await ir(i.removeItem,r+"$",t),i.watch||s("remove",e))},async getMeta(e,t={}){"boolean"==typeof t&&(t={nativeOnly:t}),e=ur(e);const{relativeKey:i,driver:s}=n(e),o=Object.create(null);if(s.getMeta&&Object.assign(o,await ir(s.getMeta,i,t)),!t.nativeOnly){const e=await ir(s.getItem,i+"$",t).then((e=>r(e)));e&&"object"==typeof e&&("string"==typeof e.atime&&(e.atime=new Date(e.atime)),"string"==typeof e.mtime&&(e.mtime=new Date(e.mtime)),Object.assign(o,e))}return o},setMeta(e,t,r={}){return this.setItem(e+"$",t,r)},removeMeta(e,t={}){return this.removeItem(e+"$",t)},async getKeys(e,t={}){e=lr(e);const r=i(e,!0);let n=[];const s=[];for(const i of r){const e=await ir(i.driver.getKeys,i.relativeBase,t);for(const t of e){const e=i.mountpoint+ur(t);n.some((t=>e.startsWith(t)))||s.push(e)}n=[i.mountpoint,...n.filter((e=>!e.startsWith(i.mountpoint)))]}return e?s.filter((t=>t.startsWith(e)&&"$"!==t[t.length-1])):s.filter((e=>"$"!==e[e.length-1]))},async clear(e,t={}){e=lr(e),await Promise.all(i(e,!1).map((async e=>{if(e.driver.clear)return ir(e.driver.clear,e.relativeBase,t);if(e.driver.removeItem){const r=await e.driver.getKeys(e.relativeBase||"",t);return Promise.all(r.map((r=>e.driver.removeItem(r,t))))}})))},async dispose(){await Promise.all(Object.values(t.mounts).map((e=>gr(e))))},watch:async e=>(await(async()=>{if(!t.watching){t.watching=!0;for(const e in t.mounts)t.unwatch[e]=await dr(t.mounts[e],s,e)}})(),t.watchListeners.push(e),async()=>{t.watchListeners=t.watchListeners.filter((t=>t!==e)),0===t.watchListeners.length&&await o()}),async unwatch(){t.watchListeners=[],await o()},mount(e,r){if((e=lr(e))&&t.mounts[e])throw new Error(`already mounted at ${e}`);return e&&(t.mountpoints.push(e),t.mountpoints.sort(((e,t)=>t.length-e.length))),t.mounts[e]=r,t.watching&&Promise.resolve(dr(r,s,e)).then((r=>{t.unwatch[e]=r})).catch(console.error),c},async unmount(e,r=!0){var n,i;(e=lr(e))&&t.mounts[e]&&(t.watching&&e in t.unwatch&&(null==(i=(n=t.unwatch)[e])||i.call(n),delete t.unwatch[e]),r&&await gr(t.mounts[e]),t.mountpoints=t.mountpoints.filter((t=>t!==e)),delete t.mounts[e])},getMount(e=""){e=ur(e)+":";const t=n(e);return{driver:t.driver,base:t.base}},getMounts(e="",t={}){e=ur(e);return i(e,t.parents).map((e=>({driver:e.driver,base:e.mountpoint})))},keys:(e,t={})=>c.getKeys(e,t),get:(e,t={})=>c.getItem(e,t),set:(e,t,r={})=>c.setItem(e,t,r),has:(e,t={})=>c.hasItem(e,t),del:(e,t={})=>c.removeItem(e,t),remove:(e,t={})=>c.removeItem(e,t)};return c}function dr(e,t,r){return e.watch?e.watch(((e,n)=>t(e,r+n))):()=>{}}async function gr(e){"function"==typeof e.dispose&&await ir(e.dispose)}function yr(e){return new Promise(((t,r)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>r(e.error)}))}function vr(e,t){const r=indexedDB.open(e);r.onupgradeneeded=()=>r.result.createObjectStore(t);const n=yr(r);return(e,r)=>n.then((n=>r(n.transaction(t,e).objectStore(t))))}let mr;function br(){return mr||(mr=vr("keyval-store","keyval")),mr}function _r(e,t=br()){return t("readonly",(t=>yr(t.get(e))))}function wr(e=br()){return e("readonly",(e=>{if(e.getAllKeys)return yr(e.getAllKeys());const t=[];return function(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},yr(e.transaction)}(e,(e=>t.push(e.key))).then((()=>t))}))}function Er(e){if("string"!=typeof e)throw new Error("Cannot safe json parse value of type "+typeof e);try{return(e=>{const t=e.replace(/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,'$1"$2n"$3');return JSON.parse(t,((e,t)=>"string"==typeof t&&t.match(/^\d+n$/)?BigInt(t.substring(0,t.length-1)):t))})(e)}catch(t){return e}}function Sr(e){return"string"==typeof e?e:(t=e,JSON.stringify(t,((e,t)=>"bigint"==typeof t?t.toString()+"n":t))||"");var t}var Ir=(e={})=>{const t=e.base&&e.base.length>0?`${e.base}:`:"",r=e=>t+e;let n;return e.dbName&&e.storeName&&(n=vr(e.dbName,e.storeName)),{name:"idb-keyval",options:e,hasItem:async e=>!(typeof(await _r(r(e),n))>"u"),getItem:async e=>await _r(r(e),n)??null,setItem:(e,t)=>function(e,t,r=br()){return r("readwrite",(r=>(r.put(t,e),yr(r.transaction))))}(r(e),t,n),removeItem:e=>function(e,t=br()){return t("readwrite",(t=>(t.delete(e),yr(t.transaction))))}(r(e),n),getKeys:()=>wr(n),clear:()=>function(e=br()){return e("readwrite",(e=>(e.clear(),yr(e.transaction))))}(n)}};let Or=class{constructor(){this.indexedDb=pr({driver:Ir({dbName:"WALLET_CONNECT_V2_INDEXED_DB",storeName:"keyvaluestorage"})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map((e=>[e.key,e.value]))}async getItem(e){const t=await this.indexedDb.getItem(e);if(null!==t)return t}async setItem(e,t){await this.indexedDb.setItem(e,Sr(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Pr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ar={exports:{}};function Nr(e){var t;return[e[0],Er(null!=(t=e[1])?t:"")]}!function(){let e;function t(){}e=t,e.prototype.getItem=function(e){return this.hasOwnProperty(e)?String(this[e]):null},e.prototype.setItem=function(e,t){this[e]=String(t)},e.prototype.removeItem=function(e){delete this[e]},e.prototype.clear=function(){const e=this;Object.keys(e).forEach((function(t){e[t]=void 0,delete e[t]}))},e.prototype.key=function(e){return e=e||0,Object.keys(this)[e]},e.prototype.__defineGetter__("length",(function(){return Object.keys(this).length})),typeof Pr<"u"&&Pr.localStorage?Ar.exports=Pr.localStorage:typeof window<"u"&&window.localStorage?Ar.exports=window.localStorage:Ar.exports=new t}();let Tr=class{constructor(){this.localStorage=Ar.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(Nr)}async getItem(e){const t=this.localStorage.getItem(e);if(null!==t)return Er(t)}async setItem(e,t){this.localStorage.setItem(e,Sr(t))}async removeItem(e){this.localStorage.removeItem(e)}};const xr=async(e,t)=>{t.length&&t.forEach((async t=>{await e.removeItem(t)}))};let Rr=class{constructor(){this.initialized=!1,this.setInitialized=e=>{this.storage=e,this.initialized=!0};const e=new Tr;this.storage=e;try{(async(e,t,r)=>{const n="wc_storage_version",i=await t.getItem(n);if(i&&i>=1)return void r(t);const s=await e.getKeys();if(!s.length)return void r(t);const o=[];for(;s.length;){const r=s.shift();if(!r)continue;const n=r.toLowerCase();if(n.includes("wc@")||n.includes("walletconnect")||n.includes("wc_")||n.includes("wallet_connect")){const n=await e.getItem(r);await t.setItem(r,n),o.push(r)}}await t.setItem(n,1),r(t),xr(e,o)})(e,new Or,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise((e=>{const t=setInterval((()=>{this.initialized&&(clearInterval(t),e())}),20)}))}};var jr={},Cr={},Ur={},Lr={};class Mr{}const Dr=t(Object.freeze(Object.defineProperty({__proto__:null,IEvents:Mr},Symbol.toStringTag,{value:"Module"})));var kr,$r;function zr(){return $r||($r=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});ht.__exportStar(function(){if(kr)return Lr;kr=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.IHeartBeat=void 0;const e=Dr;class t extends e.IEvents{constructor(e){super()}}return Lr.IHeartBeat=t,Lr}(),e)}(Ur)),Ur}var qr,Hr,Kr,Br,Vr={},Fr={};function Wr(){return Hr||(Hr=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});ht.__exportStar(function(){if(qr)return Fr;qr=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.HEARTBEAT_EVENTS=Fr.HEARTBEAT_INTERVAL=void 0;const e=Ct();return Fr.HEARTBEAT_INTERVAL=e.FIVE_SECONDS,Fr.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Fr}(),e)}(Vr)),Vr}var Gr,Yr,Jr,Qr,Xr=(Br||(Br=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=ht;t.__exportStar(function(){if(Kr)return Cr;Kr=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.HeartBeat=void 0;const e=ht,t=a(),r=Ct(),n=zr(),i=Wr();class s extends n.IHeartBeat{constructor(e){super(e),this.events=new t.EventEmitter,this.interval=i.HEARTBEAT_INTERVAL,this.interval=(null==e?void 0:e.interval)||i.HEARTBEAT_INTERVAL}static init(t){return e.__awaiter(this,void 0,void 0,(function*(){const e=new s(t);return yield e.init(),e}))}init(){return e.__awaiter(this,void 0,void 0,(function*(){yield this.initialize()}))}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}initialize(){return e.__awaiter(this,void 0,void 0,(function*(){this.intervalRef=setInterval((()=>this.pulse()),r.toMiliseconds(this.interval))}))}pulse(){this.events.emit(i.HEARTBEAT_EVENTS.pulse)}}return Cr.HeartBeat=s,Cr}(),e),t.__exportStar(zr(),e),t.__exportStar(Wr(),e)}(jr)),jr);const Zr=e(function(){if(Qr)return Jr;Qr=1;const e=function(){if(Yr)return Gr;function e(e){try{return JSON.stringify(e)}catch(t){return'"[Circular]"'}}return Yr=1,Gr=function(t,r,n){var i=n&&n.stringify||e;if("object"==typeof t&&null!==t){var s=r.length+1;if(1===s)return t;var o=new Array(s);o[0]=i(t);for(var a=1;a<s;a++)o[a]=i(r[a]);return o.join(" ")}if("string"!=typeof t)return t;var c=r.length;if(0===c)return t;for(var u="",h=0,l=-1,f=t&&t.length||0,p=0;p<f;){if(37===t.charCodeAt(p)&&p+1<f){switch(l=l>-1?l:0,t.charCodeAt(p+1)){case 100:case 102:if(h>=c)break;if(null==r[h])break;l<p&&(u+=t.slice(l,p)),u+=Number(r[h]),l=p+2,p++;break;case 105:if(h>=c)break;if(null==r[h])break;l<p&&(u+=t.slice(l,p)),u+=Math.floor(Number(r[h])),l=p+2,p++;break;case 79:case 111:case 106:if(h>=c)break;if(void 0===r[h])break;l<p&&(u+=t.slice(l,p));var d=typeof r[h];if("string"===d){u+="'"+r[h]+"'",l=p+2,p++;break}if("function"===d){u+=r[h].name||"<anonymous>",l=p+2,p++;break}u+=i(r[h]),l=p+2,p++;break;case 115:if(h>=c)break;l<p&&(u+=t.slice(l,p)),u+=String(r[h]),l=p+2,p++;break;case 37:l<p&&(u+=t.slice(l,p)),u+="%",l=p+2,p++,h--}++h}++p}return-1===l?t:(l<f&&(u+=t.slice(l)),u)}}();Jr=n;const t=function(){function e(e){return void 0!==e&&e}try{return"undefined"!=typeof globalThis||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{},r={mapHttpRequest:u,mapHttpResponse:u,wrapRequestSerializer:h,wrapResponseSerializer:h,wrapErrorSerializer:h,req:u,res:u,err:function(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const r in e)void 0===t[r]&&(t[r]=e[r]);return t}};function n(e){(e=e||{}).browser=e.browser||{};const r=e.browser.transmit;if(r&&"function"!=typeof r.send)throw Error("pino: transmit option must have a send function");const u=e.browser.write||t;e.browser.write&&(e.browser.asObject=!0);const h=e.serializers||{},f=function(e,t){if(Array.isArray(e))return e.filter((function(e){return"!stdSerializers.err"!==e}));return!0===e&&Object.keys(t)}(e.browser.serialize,h);let p=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(p=!1);"function"==typeof u&&(u.error=u.fatal=u.warn=u.info=u.debug=u.trace=u),!1===e.enabled&&(e.level="silent");const d=e.level||"info",g=Object.create(u);g.log||(g.log=l),Object.defineProperty(g,"levelVal",{get:function(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(g,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,i(y,g,"error","log"),i(y,g,"fatal","error"),i(y,g,"warn","error"),i(y,g,"info","log"),i(y,g,"debug","log"),i(y,g,"trace","log")}});const y={transmit:r,serialize:f,asObject:e.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:c(e)};return g.levels=n.levels,g.level=d,g.setMaxListeners=g.getMaxListeners=g.emit=g.addListener=g.on=g.prependListener=g.once=g.prependOnceListener=g.removeListener=g.removeAllListeners=g.listeners=g.listenerCount=g.eventNames=g.write=g.flush=l,g.serializers=h,g._serialize=f,g._stdErrSerialize=p,g.child=function(t,n){if(!t)throw new Error("missing bindings for child Pino");n=n||{},f&&t.serializers&&(n.serializers=t.serializers);const i=n.serializers;if(f&&i){var c=Object.assign({},h,i),u=!0===e.browser.serialize?Object.keys(c):f;delete t.serializers,s([t],u,c,this._stdErrSerialize)}function l(e){this._childLevel=1+(0|e._childLevel),this.error=o(e,t,"error"),this.fatal=o(e,t,"fatal"),this.warn=o(e,t,"warn"),this.info=o(e,t,"info"),this.debug=o(e,t,"debug"),this.trace=o(e,t,"trace"),c&&(this.serializers=c,this._serialize=u),r&&(this._logEvent=a([].concat(e._logEvent.bindings,t)))}return l.prototype=this,new l(this)},r&&(g._logEvent=a()),g}function i(r,i,o,c){const u=Object.getPrototypeOf(i);i[o]=i.levelVal>i.levels.values[o]?l:u[o]?u[o]:t[o]||t[c]||l,function(r,i,o){if(!r.transmit&&i[o]===l)return;i[o]=function(c){return function(){const u=r.timestamp(),h=new Array(arguments.length),l=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var f=0;f<h.length;f++)h[f]=arguments[f];if(r.serialize&&!r.asObject&&s(h,this._serialize,this.serializers,this._stdErrSerialize),r.asObject?c.call(l,function(t,r,i,o){t._serialize&&s(i,t._serialize,t.serializers,t._stdErrSerialize);const a=i.slice();let c=a[0];const u={};o&&(u.time=o);u.level=n.levels.values[r];let h=1+(0|t._childLevel);h<1&&(h=1);if(null!==c&&"object"==typeof c){for(;h--&&"object"==typeof a[0];)Object.assign(u,a.shift());c=a.length?e(a.shift(),a):void 0}else"string"==typeof c&&(c=e(a.shift(),a));void 0!==c&&(u.msg=c);return u}(this,o,h,u)):c.apply(l,h),r.transmit){const e=r.transmit.level||i.level,t=n.levels.values[e],c=n.levels.values[o];if(c<t)return;!function(e,t,r){const n=t.send,i=t.ts,o=t.methodLevel,c=t.methodValue,u=t.val,h=e._logEvent.bindings;s(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter((function(e){return-1===h.indexOf(e)})),e._logEvent.level.label=o,e._logEvent.level.value=c,n(o,e._logEvent,u),e._logEvent=a(h)}(this,{ts:u,methodLevel:o,methodValue:c,transmitLevel:e,transmitValue:n.levels.values[r.transmit.level||i.level],send:r.transmit.send,val:i.levelVal},h)}}}(i[o])}(r,i,o)}function s(e,t,r,i){for(const s in e)if(i&&e[s]instanceof Error)e[s]=n.stdSerializers.err(e[s]);else if("object"==typeof e[s]&&!Array.isArray(e[s]))for(const n in e[s])t&&t.indexOf(n)>-1&&n in r&&(e[s][n]=r[n](e[s][n]))}function o(e,t,r){return function(){const n=new Array(1+arguments.length);n[0]=t;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return e[r].apply(this,n)}}function a(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function c(e){return"function"==typeof e.timestamp?e.timestamp:!1===e.timestamp?f:p}function u(){return{}}function h(e){return e}function l(){}function f(){return!1}function p(){return Date.now()}return n.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},n.stdSerializers=r,n.stdTimeFunctions=Object.assign({},{nullTime:f,epochTime:p,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}}),Jr}()),en="info",tn="custom_context";var rn=Object.defineProperty,nn=Object.defineProperties,sn=Object.getOwnPropertyDescriptors,on=Object.getOwnPropertySymbols,an=Object.prototype.hasOwnProperty,cn=Object.prototype.propertyIsEnumerable,un=(e,t,r)=>t in e?rn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;function hn(e){return((e,t)=>nn(e,sn(t)))(((e,t)=>{for(var r in t||(t={}))an.call(t,r)&&un(e,r,t[r]);if(on)for(var r of on(t))cn.call(t,r)&&un(e,r,t[r]);return e})({},e),{level:(null==e?void 0:e.level)||en})}function ln(e,t=tn){let r="";return r=typeof e.bindings>"u"?function(e,t=tn){return e[t]||""}(e,t):e.bindings().context||"",r}function fn(e,t,r=tn){const n=function(e,t,r=tn){const n=ln(e,r);return n.trim()?`${n}/${t}`:t}(e,t,r);return function(e,t,r=tn){return e[r]=t,e}(e.child({context:n}),n,r)}let pn=class extends Mr{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}};class dn extends Mr{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}}class gn{constructor(e,t){this.logger=e,this.core=t}}let yn=class extends Mr{constructor(e,t){super(),this.relayer=e,this.logger=t}},vn=class extends Mr{constructor(e){super()}},mn=class{constructor(e,t,r,n){this.core=e,this.logger=t,this.name=r}},bn=class extends Mr{constructor(e,t){super(),this.relayer=e,this.logger=t}},_n=class extends Mr{constructor(e,t){super(),this.core=e,this.logger=t}},wn=class{constructor(e,t){this.projectId=e,this.logger=t}},En=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},Sn=class{constructor(e){this.client=e}};var In,On,Pn={},An={};var Nn=(On||(On=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.convertSecretKeyToX25519=e.convertPublicKeyToX25519=e.verify=e.sign=e.extractPublicKeyFromSecretKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.SEED_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=e.SIGNATURE_LENGTH=void 0;const t=G(),r=(In||(In=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=y(),r=_();e.DIGEST_LENGTH=64,e.BLOCK_SIZE=128;var n=function(){function n(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return n.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},n.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},n.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},n.prototype.update=function(t,r){if(void 0===r&&(r=t.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var n=0;if(this._bytesHashed+=r,this._bufferLength>0){for(;this._bufferLength<e.BLOCK_SIZE&&r>0;)this._buffer[this._bufferLength++]=t[n++],r--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(r>=this.blockSize&&(n=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,t,n,r),r%=this.blockSize);r>0;)this._buffer[this._bufferLength++]=t[n++],r--;return this},n.prototype.finish=function(e){if(!this._finished){var r=this._bytesHashed,n=this._bufferLength,i=r/536870912|0,o=r<<3,a=r%128<112?128:256;this._buffer[n]=128;for(var c=n+1;c<a-8;c++)this._buffer[c]=0;t.writeUint32BE(i,this._buffer,a-8),t.writeUint32BE(o,this._buffer,a-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,a),this._finished=!0}for(c=0;c<this.digestLength/8;c++)t.writeUint32BE(this._stateHi[c],e,8*c),t.writeUint32BE(this._stateLo[c],e,8*c+4);return this},n.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},n.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},n.prototype.restoreState=function(e){return this._stateHi.set(e.stateHi),this._stateLo.set(e.stateLo),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},n.prototype.cleanSavedState=function(e){r.wipe(e.stateHi),r.wipe(e.stateLo),e.buffer&&r.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},n}();e.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(e,r,n,s,o,a,c){for(var u,h,l,f,p,d,g,y,v=n[0],m=n[1],b=n[2],_=n[3],w=n[4],E=n[5],S=n[6],I=n[7],O=s[0],P=s[1],A=s[2],N=s[3],T=s[4],x=s[5],R=s[6],j=s[7];c>=128;){for(var C=0;C<16;C++){var U=8*C+a;e[C]=t.readUint32BE(o,U),r[C]=t.readUint32BE(o,U+4)}for(C=0;C<80;C++){var L,M,D=v,k=m,$=b,z=_,q=w,H=E,K=S,B=O,V=P,F=A,W=N,G=T,Y=x,J=R;if(p=65535&(h=j),d=h>>>16,g=65535&(u=I),y=u>>>16,p+=65535&(h=(T>>>14|w<<18)^(T>>>18|w<<14)^(w>>>9|T<<23)),d+=h>>>16,g+=65535&(u=(w>>>14|T<<18)^(w>>>18|T<<14)^(T>>>9|w<<23)),y+=u>>>16,p+=65535&(h=T&x^~T&R),d+=h>>>16,g+=65535&(u=w&E^~w&S),y+=u>>>16,u=i[2*C],p+=65535&(h=i[2*C+1]),d+=h>>>16,g+=65535&u,y+=u>>>16,u=e[C%16],d+=(h=r[C%16])>>>16,g+=65535&u,y+=u>>>16,g+=(d+=(p+=65535&h)>>>16)>>>16,p=65535&(h=f=65535&p|d<<16),d=h>>>16,g=65535&(u=l=65535&g|(y+=g>>>16)<<16),y=u>>>16,p+=65535&(h=(O>>>28|v<<4)^(v>>>2|O<<30)^(v>>>7|O<<25)),d+=h>>>16,g+=65535&(u=(v>>>28|O<<4)^(O>>>2|v<<30)^(O>>>7|v<<25)),y+=u>>>16,d+=(h=O&P^O&A^P&A)>>>16,g+=65535&(u=v&m^v&b^m&b),y+=u>>>16,L=65535&(g+=(d+=(p+=65535&h)>>>16)>>>16)|(y+=g>>>16)<<16,M=65535&p|d<<16,p=65535&(h=W),d=h>>>16,g=65535&(u=z),y=u>>>16,d+=(h=f)>>>16,g+=65535&(u=l),y+=u>>>16,m=D,b=k,_=$,w=z=65535&(g+=(d+=(p+=65535&h)>>>16)>>>16)|(y+=g>>>16)<<16,E=q,S=H,I=K,v=L,P=B,A=V,N=F,T=W=65535&p|d<<16,x=G,R=Y,j=J,O=M,C%16==15)for(U=0;U<16;U++)u=e[U],p=65535&(h=r[U]),d=h>>>16,g=65535&u,y=u>>>16,u=e[(U+9)%16],p+=65535&(h=r[(U+9)%16]),d+=h>>>16,g+=65535&u,y+=u>>>16,l=e[(U+1)%16],p+=65535&(h=((f=r[(U+1)%16])>>>1|l<<31)^(f>>>8|l<<24)^(f>>>7|l<<25)),d+=h>>>16,g+=65535&(u=(l>>>1|f<<31)^(l>>>8|f<<24)^l>>>7),y+=u>>>16,l=e[(U+14)%16],d+=(h=((f=r[(U+14)%16])>>>19|l<<13)^(l>>>29|f<<3)^(f>>>6|l<<26))>>>16,g+=65535&(u=(l>>>19|f<<13)^(f>>>29|l<<3)^l>>>6),y+=u>>>16,y+=(g+=(d+=(p+=65535&h)>>>16)>>>16)>>>16,e[U]=65535&g|y<<16,r[U]=65535&p|d<<16}p=65535&(h=O),d=h>>>16,g=65535&(u=v),y=u>>>16,u=n[0],d+=(h=s[0])>>>16,g+=65535&u,y+=u>>>16,y+=(g+=(d+=(p+=65535&h)>>>16)>>>16)>>>16,n[0]=v=65535&g|y<<16,s[0]=O=65535&p|d<<16,p=65535&(h=P),d=h>>>16,g=65535&(u=m),y=u>>>16,u=n[1],d+=(h=s[1])>>>16,g+=65535&u,y+=u>>>16,y+=(g+=(d+=(p+=65535&h)>>>16)>>>16)>>>16,n[1]=m=65535&g|y<<16,s[1]=P=65535&p|d<<16,p=65535&(h=A),d=h>>>16,g=65535&(u=b),y=u>>>16,u=n[2],d+=(h=s[2])>>>16,g+=65535&u,y+=u>>>16,y+=(g+=(d+=(p+=65535&h)>>>16)>>>16)>>>16,n[2]=b=65535&g|y<<16,s[2]=A=65535&p|d<<16,p=65535&(h=N),d=h>>>16,g=65535&(u=_),y=u>>>16,u=n[3],d+=(h=s[3])>>>16,g+=65535&u,y+=u>>>16,y+=(g+=(d+=(p+=65535&h)>>>16)>>>16)>>>16,n[3]=_=65535&g|y<<16,s[3]=N=65535&p|d<<16,p=65535&(h=T),d=h>>>16,g=65535&(u=w),y=u>>>16,u=n[4],d+=(h=s[4])>>>16,g+=65535&u,y+=u>>>16,y+=(g+=(d+=(p+=65535&h)>>>16)>>>16)>>>16,n[4]=w=65535&g|y<<16,s[4]=T=65535&p|d<<16,p=65535&(h=x),d=h>>>16,g=65535&(u=E),y=u>>>16,u=n[5],d+=(h=s[5])>>>16,g+=65535&u,y+=u>>>16,y+=(g+=(d+=(p+=65535&h)>>>16)>>>16)>>>16,n[5]=E=65535&g|y<<16,s[5]=x=65535&p|d<<16,p=65535&(h=R),d=h>>>16,g=65535&(u=S),y=u>>>16,u=n[6],d+=(h=s[6])>>>16,g+=65535&u,y+=u>>>16,y+=(g+=(d+=(p+=65535&h)>>>16)>>>16)>>>16,n[6]=S=65535&g|y<<16,s[6]=R=65535&p|d<<16,p=65535&(h=j),d=h>>>16,g=65535&(u=I),y=u>>>16,u=n[7],d+=(h=s[7])>>>16,g+=65535&u,y+=u>>>16,y+=(g+=(d+=(p+=65535&h)>>>16)>>>16)>>>16,n[7]=I=65535&g|y<<16,s[7]=j=65535&p|d<<16,a+=128,c-=128}return a}e.hash=function(e){var t=new n;t.update(e);var r=t.digest();return t.clean(),r}}(An)),An),n=_();function i(e){const t=new Float64Array(16);if(e)for(let r=0;r<e.length;r++)t[r]=e[r];return t}e.SIGNATURE_LENGTH=64,e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=64,e.SEED_LENGTH=32,new Uint8Array(32)[0]=9;const s=i(),o=i([1]),a=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),c=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),u=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),h=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),l=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function f(e,t){for(let r=0;r<16;r++)e[r]=0|t[r]}function p(e){let t=1;for(let r=0;r<16;r++){let n=e[r]+t+65535;t=Math.floor(n/65536),e[r]=n-65536*t}e[0]+=t-1+37*(t-1)}function d(e,t,r){const n=~(r-1);for(let i=0;i<16;i++){const r=n&(e[i]^t[i]);e[i]^=r,t[i]^=r}}function g(e,t){const r=i(),n=i();for(let i=0;i<16;i++)n[i]=t[i];p(n),p(n),p(n);for(let i=0;i<2;i++){r[0]=n[0]-65517;for(let t=1;t<15;t++)r[t]=n[t]-65535-(r[t-1]>>16&1),r[t-1]&=65535;r[15]=n[15]-32767-(r[14]>>16&1);const e=r[15]>>16&1;r[14]&=65535,d(n,r,1-e)}for(let i=0;i<16;i++)e[2*i]=255&n[i],e[2*i+1]=n[i]>>8}function v(e,t){let r=0;for(let n=0;n<32;n++)r|=e[n]^t[n];return(1&r-1>>>8)-1}function m(e,t){const r=new Uint8Array(32),n=new Uint8Array(32);return g(r,e),g(n,t),v(r,n)}function b(e){const t=new Uint8Array(32);return g(t,e),1&t[0]}function w(e,t,r){for(let n=0;n<16;n++)e[n]=t[n]+r[n]}function E(e,t,r){for(let n=0;n<16;n++)e[n]=t[n]-r[n]}function S(e,t,r){let n,i,s=0,o=0,a=0,c=0,u=0,h=0,l=0,f=0,p=0,d=0,g=0,y=0,v=0,m=0,b=0,_=0,w=0,E=0,S=0,I=0,O=0,P=0,A=0,N=0,T=0,x=0,R=0,j=0,C=0,U=0,L=0,M=r[0],D=r[1],k=r[2],$=r[3],z=r[4],q=r[5],H=r[6],K=r[7],B=r[8],V=r[9],F=r[10],W=r[11],G=r[12],Y=r[13],J=r[14],Q=r[15];n=t[0],s+=n*M,o+=n*D,a+=n*k,c+=n*$,u+=n*z,h+=n*q,l+=n*H,f+=n*K,p+=n*B,d+=n*V,g+=n*F,y+=n*W,v+=n*G,m+=n*Y,b+=n*J,_+=n*Q,n=t[1],o+=n*M,a+=n*D,c+=n*k,u+=n*$,h+=n*z,l+=n*q,f+=n*H,p+=n*K,d+=n*B,g+=n*V,y+=n*F,v+=n*W,m+=n*G,b+=n*Y,_+=n*J,w+=n*Q,n=t[2],a+=n*M,c+=n*D,u+=n*k,h+=n*$,l+=n*z,f+=n*q,p+=n*H,d+=n*K,g+=n*B,y+=n*V,v+=n*F,m+=n*W,b+=n*G,_+=n*Y,w+=n*J,E+=n*Q,n=t[3],c+=n*M,u+=n*D,h+=n*k,l+=n*$,f+=n*z,p+=n*q,d+=n*H,g+=n*K,y+=n*B,v+=n*V,m+=n*F,b+=n*W,_+=n*G,w+=n*Y,E+=n*J,S+=n*Q,n=t[4],u+=n*M,h+=n*D,l+=n*k,f+=n*$,p+=n*z,d+=n*q,g+=n*H,y+=n*K,v+=n*B,m+=n*V,b+=n*F,_+=n*W,w+=n*G,E+=n*Y,S+=n*J,I+=n*Q,n=t[5],h+=n*M,l+=n*D,f+=n*k,p+=n*$,d+=n*z,g+=n*q,y+=n*H,v+=n*K,m+=n*B,b+=n*V,_+=n*F,w+=n*W,E+=n*G,S+=n*Y,I+=n*J,O+=n*Q,n=t[6],l+=n*M,f+=n*D,p+=n*k,d+=n*$,g+=n*z,y+=n*q,v+=n*H,m+=n*K,b+=n*B,_+=n*V,w+=n*F,E+=n*W,S+=n*G,I+=n*Y,O+=n*J,P+=n*Q,n=t[7],f+=n*M,p+=n*D,d+=n*k,g+=n*$,y+=n*z,v+=n*q,m+=n*H,b+=n*K,_+=n*B,w+=n*V,E+=n*F,S+=n*W,I+=n*G,O+=n*Y,P+=n*J,A+=n*Q,n=t[8],p+=n*M,d+=n*D,g+=n*k,y+=n*$,v+=n*z,m+=n*q,b+=n*H,_+=n*K,w+=n*B,E+=n*V,S+=n*F,I+=n*W,O+=n*G,P+=n*Y,A+=n*J,N+=n*Q,n=t[9],d+=n*M,g+=n*D,y+=n*k,v+=n*$,m+=n*z,b+=n*q,_+=n*H,w+=n*K,E+=n*B,S+=n*V,I+=n*F,O+=n*W,P+=n*G,A+=n*Y,N+=n*J,T+=n*Q,n=t[10],g+=n*M,y+=n*D,v+=n*k,m+=n*$,b+=n*z,_+=n*q,w+=n*H,E+=n*K,S+=n*B,I+=n*V,O+=n*F,P+=n*W,A+=n*G,N+=n*Y,T+=n*J,x+=n*Q,n=t[11],y+=n*M,v+=n*D,m+=n*k,b+=n*$,_+=n*z,w+=n*q,E+=n*H,S+=n*K,I+=n*B,O+=n*V,P+=n*F,A+=n*W,N+=n*G,T+=n*Y,x+=n*J,R+=n*Q,n=t[12],v+=n*M,m+=n*D,b+=n*k,_+=n*$,w+=n*z,E+=n*q,S+=n*H,I+=n*K,O+=n*B,P+=n*V,A+=n*F,N+=n*W,T+=n*G,x+=n*Y,R+=n*J,j+=n*Q,n=t[13],m+=n*M,b+=n*D,_+=n*k,w+=n*$,E+=n*z,S+=n*q,I+=n*H,O+=n*K,P+=n*B,A+=n*V,N+=n*F,T+=n*W,x+=n*G,R+=n*Y,j+=n*J,C+=n*Q,n=t[14],b+=n*M,_+=n*D,w+=n*k,E+=n*$,S+=n*z,I+=n*q,O+=n*H,P+=n*K,A+=n*B,N+=n*V,T+=n*F,x+=n*W,R+=n*G,j+=n*Y,C+=n*J,U+=n*Q,n=t[15],_+=n*M,w+=n*D,E+=n*k,S+=n*$,I+=n*z,O+=n*q,P+=n*H,A+=n*K,N+=n*B,T+=n*V,x+=n*F,R+=n*W,j+=n*G,C+=n*Y,U+=n*J,L+=n*Q,s+=38*w,o+=38*E,a+=38*S,c+=38*I,u+=38*O,h+=38*P,l+=38*A,f+=38*N,p+=38*T,d+=38*x,g+=38*R,y+=38*j,v+=38*C,m+=38*U,b+=38*L,i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-65536*i,n=o+i+65535,i=Math.floor(n/65536),o=n-65536*i,n=a+i+65535,i=Math.floor(n/65536),a=n-65536*i,n=c+i+65535,i=Math.floor(n/65536),c=n-65536*i,n=u+i+65535,i=Math.floor(n/65536),u=n-65536*i,n=h+i+65535,i=Math.floor(n/65536),h=n-65536*i,n=l+i+65535,i=Math.floor(n/65536),l=n-65536*i,n=f+i+65535,i=Math.floor(n/65536),f=n-65536*i,n=p+i+65535,i=Math.floor(n/65536),p=n-65536*i,n=d+i+65535,i=Math.floor(n/65536),d=n-65536*i,n=g+i+65535,i=Math.floor(n/65536),g=n-65536*i,n=y+i+65535,i=Math.floor(n/65536),y=n-65536*i,n=v+i+65535,i=Math.floor(n/65536),v=n-65536*i,n=m+i+65535,i=Math.floor(n/65536),m=n-65536*i,n=b+i+65535,i=Math.floor(n/65536),b=n-65536*i,n=_+i+65535,i=Math.floor(n/65536),_=n-65536*i,s+=i-1+37*(i-1),i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-65536*i,n=o+i+65535,i=Math.floor(n/65536),o=n-65536*i,n=a+i+65535,i=Math.floor(n/65536),a=n-65536*i,n=c+i+65535,i=Math.floor(n/65536),c=n-65536*i,n=u+i+65535,i=Math.floor(n/65536),u=n-65536*i,n=h+i+65535,i=Math.floor(n/65536),h=n-65536*i,n=l+i+65535,i=Math.floor(n/65536),l=n-65536*i,n=f+i+65535,i=Math.floor(n/65536),f=n-65536*i,n=p+i+65535,i=Math.floor(n/65536),p=n-65536*i,n=d+i+65535,i=Math.floor(n/65536),d=n-65536*i,n=g+i+65535,i=Math.floor(n/65536),g=n-65536*i,n=y+i+65535,i=Math.floor(n/65536),y=n-65536*i,n=v+i+65535,i=Math.floor(n/65536),v=n-65536*i,n=m+i+65535,i=Math.floor(n/65536),m=n-65536*i,n=b+i+65535,i=Math.floor(n/65536),b=n-65536*i,n=_+i+65535,i=Math.floor(n/65536),_=n-65536*i,s+=i-1+37*(i-1),e[0]=s,e[1]=o,e[2]=a,e[3]=c,e[4]=u,e[5]=h,e[6]=l,e[7]=f,e[8]=p,e[9]=d,e[10]=g,e[11]=y,e[12]=v,e[13]=m,e[14]=b,e[15]=_}function I(e,t){S(e,t,t)}function O(e,t){const r=i();let n;for(n=0;n<16;n++)r[n]=t[n];for(n=253;n>=0;n--)I(r,r),2!==n&&4!==n&&S(r,r,t);for(n=0;n<16;n++)e[n]=r[n]}function P(e,t){const r=i(),n=i(),s=i(),o=i(),a=i(),u=i(),h=i(),l=i(),f=i();E(r,e[1],e[0]),E(f,t[1],t[0]),S(r,r,f),w(n,e[0],e[1]),w(f,t[0],t[1]),S(n,n,f),S(s,e[3],t[3]),S(s,s,c),S(o,e[2],t[2]),w(o,o,o),E(a,n,r),E(u,o,s),w(h,o,s),w(l,n,r),S(e[0],a,u),S(e[1],l,h),S(e[2],h,u),S(e[3],a,l)}function A(e,t,r){for(let n=0;n<4;n++)d(e[n],t[n],r)}function N(e,t){const r=i(),n=i(),s=i();O(s,t[2]),S(r,t[0],s),S(n,t[1],s),g(e,n),e[31]^=b(r)<<7}function T(e,t,r){f(e[0],s),f(e[1],o),f(e[2],o),f(e[3],s);for(let n=255;n>=0;--n){const i=r[n/8|0]>>(7&n)&1;A(e,t,i),P(t,e),P(e,e),A(e,t,i)}}function x(e,t){const r=[i(),i(),i(),i()];f(r[0],u),f(r[1],h),f(r[2],o),S(r[3],u,h),T(e,r,t)}function R(t){if(t.length!==e.SEED_LENGTH)throw new Error(`ed25519: seed must be ${e.SEED_LENGTH} bytes`);const n=(0,r.hash)(t);n[0]&=248,n[31]&=127,n[31]|=64;const s=new Uint8Array(32),o=[i(),i(),i(),i()];x(o,n),N(s,o);const a=new Uint8Array(64);return a.set(t),a.set(s,32),{publicKey:s,secretKey:a}}e.generateKeyPairFromSeed=R,e.generateKeyPair=function(e){const r=(0,t.randomBytes)(32,e),i=R(r);return(0,n.wipe)(r),i},e.extractPublicKeyFromSecretKey=function(t){if(t.length!==e.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${e.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(t.subarray(32))};const j=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function C(e,t){let r,n,i,s;for(n=63;n>=32;--n){for(r=0,i=n-32,s=n-12;i<s;++i)t[i]+=r-16*t[n]*j[i-(n-32)],r=Math.floor((t[i]+128)/256),t[i]-=256*r;t[i]+=r,t[n]=0}for(r=0,i=0;i<32;i++)t[i]+=r-(t[31]>>4)*j[i],r=t[i]>>8,t[i]&=255;for(i=0;i<32;i++)t[i]-=r*j[i];for(n=0;n<32;n++)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function U(e){const t=new Float64Array(64);for(let r=0;r<64;r++)t[r]=e[r];for(let r=0;r<64;r++)e[r]=0;C(e,t)}function L(e,t){const r=i(),n=i(),c=i(),u=i(),h=i(),p=i(),d=i();return f(e[2],o),function(e,t){for(let r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}(e[1],t),I(c,e[1]),S(u,c,a),E(c,c,e[2]),w(u,e[2],u),I(h,u),I(p,h),S(d,p,h),S(r,d,c),S(r,r,u),function(e,t){const r=i();let n;for(n=0;n<16;n++)r[n]=t[n];for(n=250;n>=0;n--)I(r,r),1!==n&&S(r,r,t);for(n=0;n<16;n++)e[n]=r[n]}(r,r),S(r,r,c),S(r,r,u),S(r,r,u),S(e[0],r,u),I(n,e[0]),S(n,n,u),m(n,c)&&S(e[0],e[0],l),I(n,e[0]),S(n,n,u),m(n,c)?-1:(b(e[0])===t[31]>>7&&E(e[0],s,e[0]),S(e[3],e[0],e[1]),0)}e.sign=function(e,t){const n=new Float64Array(64),s=[i(),i(),i(),i()],o=(0,r.hash)(e.subarray(0,32));o[0]&=248,o[31]&=127,o[31]|=64;const a=new Uint8Array(64);a.set(o.subarray(32),32);const c=new r.SHA512;c.update(a.subarray(32)),c.update(t);const u=c.digest();c.clean(),U(u),x(s,u),N(a,s),c.reset(),c.update(a.subarray(0,32)),c.update(e.subarray(32)),c.update(t);const h=c.digest();U(h);for(let r=0;r<32;r++)n[r]=u[r];for(let r=0;r<32;r++)for(let e=0;e<32;e++)n[r+e]+=h[r]*o[e];return C(a.subarray(32),n),a},e.verify=function(t,n,s){const o=new Uint8Array(32),a=[i(),i(),i(),i()],c=[i(),i(),i(),i()];if(s.length!==e.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${e.SIGNATURE_LENGTH} bytes`);if(L(c,t))return!1;const u=new r.SHA512;u.update(s.subarray(0,32)),u.update(t),u.update(n);const h=u.digest();return U(h),T(a,c,h),x(c,s.subarray(32)),P(a,c),N(o,a),!v(s,o)},e.convertPublicKeyToX25519=function(e){let t=[i(),i(),i(),i()];if(L(t,e))throw new Error("Ed25519: invalid public key");let r=i(),n=i(),s=t[1];w(r,o,s),E(n,o,s),O(n,n),S(r,r,n);let a=new Uint8Array(32);return g(a,r),a},e.convertSecretKeyToX25519=function(e){const t=(0,r.hash)(e.subarray(0,32));t[0]&=248,t[31]&=127,t[31]|=64;const i=new Uint8Array(t.subarray(0,32));return(0,n.wipe)(t),i}}(Pn)),Pn);const Tn="base64url",xn="did",Rn="key",jn="base58btc";function Cn(e){return nt(rt(Sr(e),"utf8"),Tn)}function Un(e){const t="z"+nt(ie([rt("K36",jn),e]),jn);return[xn,Rn,t].join(":")}function Ln(e=J.randomBytes(32)){return Nn.generateKeyPairFromSeed(e)}async function Mn(e,t,r,n,i=Lt.fromMiliseconds(Date.now())){const s={alg:"EdDSA",typ:"JWT"},o={iss:Un(n.publicKey),sub:e,aud:t,iat:i,exp:i+r},a=rt([Cn((c={header:s,payload:o}).header),Cn(c.payload)].join("."),"utf8");var c;return function(e){return[Cn(e.header),Cn(e.payload),(t=e.signature,nt(t,Tn))].join(".");var t}({header:s,payload:o,signature:Nn.sign(n.secretKey,a)})}var Dn=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},kn=function(){return function(e,t,r){this.name=e,this.version=t,this.os=r,this.type="browser"}}(),$n=function(){return function(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}}(),zn=function(){return function(e,t,r,n){this.name=e,this.version=t,this.os=r,this.bot=n,this.type="bot-device"}}(),qn=function(){return function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}}(),Hn=function(){return function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}}(),Kn=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Bn=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],Vn=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Fn(e){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new Hn:"undefined"!=typeof navigator?function(e){var t=function(e){return""!==e&&Bn.reduce((function(t,r){var n=r[0],i=r[1];if(t)return t;var s=i.exec(e);return!!s&&[n,s]}),!1)}(e);if(!t)return null;var r=t[0],n=t[1];if("searchbot"===r)return new qn;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<3&&(i=Dn(Dn([],i,!0),function(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}(3-i.length),!0)):i=[];var s=i.join("."),o=function(e){for(var t=0,r=Vn.length;t<r;t++){var n=Vn[t],i=n[0];if(n[1].exec(e))return i}return null}(e),a=Kn.exec(e);if(a&&a[1])return new zn(r,s,o,a[1]);return new kn(r,s,o)}(navigator.userAgent):"undefined"!=typeof process&&process.version?new $n(process.version.slice(1)):null}var Wn,Gn={};var Yn,Jn=function(){if(Wn)return Gn;Wn=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.getWindowMetadata=void 0;const e=Dt();return Gn.getWindowMetadata=function(){let t,r;try{t=e.getDocumentOrThrow(),r=e.getLocationOrThrow()}catch(s){return null}function n(...e){const r=t.getElementsByTagName("meta");for(let t=0;t<r.length;t++){const n=r[t],i=["itemprop","property","name"].map((e=>n.getAttribute(e))).filter((t=>!!t&&e.includes(t)));if(i.length&&i){const e=n.getAttribute("content");if(e)return e}}return""}const i=function(){let e=n("name","og:site_name","og:title","twitter:title");return e||(e=t.title),e}();return{description:n("description","og:description","twitter:description","keywords"),url:r.origin,icons:function(){const e=t.getElementsByTagName("link"),n=[];for(let t=0;t<e.length;t++){const i=e[t],s=i.getAttribute("rel");if(s&&s.toLowerCase().indexOf("icon")>-1){const e=i.getAttribute("href");if(e)if(-1===e.toLowerCase().indexOf("https:")&&-1===e.toLowerCase().indexOf("http:")&&0!==e.indexOf("//")){let t=r.protocol+"//"+r.host;if(0===e.indexOf("/"))t+=e;else{const n=r.pathname.split("/");n.pop();t+=n.join("/")+"/"+e}n.push(t)}else if(0===e.indexOf("//")){const t=r.protocol+e;n.push(t)}else n.push(e)}}return n}(),name:i}},Gn}(),Qn={};var Xn=(Yn||(Yn=1,function(e){const t=Qt(),r=Xt(),n=Zt(),i=er(),s=Symbol("encodeFragmentIdentifier");function o(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function a(e,r){return r.encode?r.strict?t(e):encodeURIComponent(e):e}function c(e,t){return t.decode?r(e):e}function u(e){return Array.isArray(e)?e.sort():"object"==typeof e?u(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function h(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function l(e){const t=(e=h(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function f(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function p(e,t){o((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const r=function(e){let t;switch(e.arrayFormat){case"index":return(e,r,n)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return(e,r,n)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"colon-list-separator":return(e,r,n)=>{t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"comma":case"separator":return(t,r,n)=>{const i="string"==typeof r&&r.includes(e.arrayFormatSeparator),s="string"==typeof r&&!i&&c(r,e).includes(e.arrayFormatSeparator);r=s?c(r,e):r;const o=i||s?r.split(e.arrayFormatSeparator).map((t=>c(t,e))):null===r?r:c(r,e);n[t]=o};case"bracket-separator":return(t,r,n)=>{const i=/(\[\])$/.test(t);if(t=t.replace(/\[\]$/,""),!i)return void(n[t]=r?c(r,e):r);const s=null===r?[]:r.split(e.arrayFormatSeparator).map((t=>c(t,e)));void 0!==n[t]?n[t]=[].concat(n[t],s):n[t]=s};default:return(e,t,r)=>{void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t),i=Object.create(null);if("string"!=typeof e)return i;if(!(e=e.trim().replace(/^[?#&]/,"")))return i;for(const s of e.split("&")){if(""===s)continue;let[e,o]=n(t.decode?s.replace(/\+/g," "):s,"=");o=void 0===o?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?o:c(o,t),r(c(e,t),o,i)}for(const n of Object.keys(i)){const e=i[n];if("object"==typeof e&&null!==e)for(const r of Object.keys(e))e[r]=f(e[r],t);else i[n]=f(e,t)}return!1===t.sort?i:(!0===t.sort?Object.keys(i).sort():Object.keys(i).sort(t.sort)).reduce(((e,t)=>{const r=i[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=u(r):e[t]=r,e}),Object.create(null))}e.extract=l,e.parse=p,e.stringify=(e,t)=>{if(!e)return"";o((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=r=>t.skipNull&&null==e[r]||t.skipEmptyString&&""===e[r],n=function(e){switch(e.arrayFormat){case"index":return t=>(r,n)=>{const i=r.length;return void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[a(t,e),"[",i,"]"].join("")]:[...r,[a(t,e),"[",a(i,e),"]=",a(n,e)].join("")]};case"bracket":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[a(t,e),"[]"].join("")]:[...r,[a(t,e),"[]=",a(n,e)].join("")];case"colon-list-separator":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[a(t,e),":list="].join("")]:[...r,[a(t,e),":list=",a(n,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return r=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:(i=null===i?"":i,0===n.length?[[a(r,e),t,a(i,e)].join("")]:[[n,a(i,e)].join(e.arrayFormatSeparator)])}default:return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,a(t,e)]:[...r,[a(t,e),"=",a(n,e)].join("")]}}(t),i={};for(const o of Object.keys(e))r(o)||(i[o]=e[o]);const s=Object.keys(i);return!1!==t.sort&&s.sort(t.sort),s.map((r=>{const i=e[r];return void 0===i?"":null===i?a(r,t):Array.isArray(i)?0===i.length&&"bracket-separator"===t.arrayFormat?a(r,t)+"[]":i.reduce(n(r),[]).join("&"):a(r,t)+"="+a(i,t)})).filter((e=>e.length>0)).join("&")},e.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[r,i]=n(e,"#");return Object.assign({url:r.split("?")[0]||"",query:p(l(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:c(i,t)}:{})},e.stringifyUrl=(t,r)=>{r=Object.assign({encode:!0,strict:!0,[s]:!0},r);const n=h(t.url).split("?")[0]||"",i=e.extract(t.url),o=e.parse(i,{sort:!1}),c=Object.assign(o,t.query);let u=e.stringify(c,r);u&&(u=`?${u}`);let l=function(e){let t="";const r=e.indexOf("#");return-1!==r&&(t=e.slice(r)),t}(t.url);return t.fragmentIdentifier&&(l=`#${r[s]?a(t.fragmentIdentifier,r):t.fragmentIdentifier}`),`${n}${u}${l}`},e.pick=(t,r,n)=>{n=Object.assign({parseFragmentIdentifier:!0,[s]:!1},n);const{url:o,query:a,fragmentIdentifier:c}=e.parseUrl(t,n);return e.stringifyUrl({url:o,query:i(a,r),fragmentIdentifier:c},n)},e.exclude=(t,r,n)=>{const i=Array.isArray(r)?e=>!r.includes(e):(e,t)=>!r(e,t);return e.pick(t,i,n)}}(Qn)),Qn);function Zn(e,t){return e.includes(":")?[e]:t.chains||[]}const ei="base10",ti="base16",ri="base64pad",ni="utf8";function ii(){return nt(J.randomBytes(32),ti)}function si(e){return nt(Z.hash(rt(e,ni)),ti)}function oi(e){return Number(nt(e,ei))}function ai(e){const t=function(e){return rt(`${e}`,ei)}(typeof e.type<"u"?e.type:0);if(1===oi(t)&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof e.senderPublicKey<"u"?rt(e.senderPublicKey,ti):void 0,n=typeof e.iv<"u"?rt(e.iv,ti):J.randomBytes(12);return function(e){if(1===oi(e.type)){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return nt(ie([e.type,e.senderPublicKey,e.iv,e.sealed]),ri)}return nt(ie([e.type,e.iv,e.sealed]),ri)}({type:t,sealed:new x.ChaCha20Poly1305(rt(e.symKey,ti)).seal(n,rt(e.message,ni)),iv:n,senderPublicKey:r})}function ci(e){const t=rt(e,ri),r=t.slice(0,1);if(1===oi(r)){const e=33,n=e+12,i=t.slice(1,e),s=t.slice(e,n);return{type:r,sealed:t.slice(n),iv:s,senderPublicKey:i}}const n=t.slice(1,13);return{type:r,sealed:t.slice(13),iv:n}}function ui(e){const t=(null==e?void 0:e.type)||0;if(1===t){if(typeof(null==e?void 0:e.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(null==e?void 0:e.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:null==e?void 0:e.senderPublicKey,receiverPublicKey:null==e?void 0:e.receiverPublicKey}}function hi(e){return 1===e.type&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}var li=Object.defineProperty,fi=Object.getOwnPropertySymbols,pi=Object.prototype.hasOwnProperty,di=Object.prototype.propertyIsEnumerable,gi=(e,t,r)=>t in e?li(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,yi=(e,t)=>{for(var r in t||(t={}))pi.call(t,r)&&gi(e,r,t[r]);if(fi)for(var r of fi(t))di.call(t,r)&&gi(e,r,t[r]);return e};const vi="react-native",mi="node",bi="browser",_i="unknown",wi="js";function Ei(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Si(){return!$t.getDocument()&&!!$t.getNavigator()&&"ReactNative"===navigator.product}function Ii(){return!Ei()&&!!$t.getNavigator()}function Oi(){return Si()?vi:Ei()?mi:Ii()?bi:_i}function Pi(e,t,r){const n=function(){if(Oi()===vi&&typeof global<"u"&&typeof(null==global?void 0:global.Platform)<"u"){const{OS:e,Version:t}=global.Platform;return[e,t].join("-")}const e=Fn();if(null===e)return"unknown";const t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[t,e.name,e.version].join("-"):[t,e.version].join("-")}(),i=function(){var e;const t=Oi();return t===bi?[t,(null==(e=$t.getLocation())?void 0:e.host)||"unknown"].join(":"):t}();return[[e,t].join("-"),[wi,r].join("-"),n,i].join("/")}function Ai({protocol:e,version:t,relayUrl:r,sdkVersion:n,auth:i,projectId:s,useOnCloseEvent:o}){const a=r.split("?"),c={auth:i,ua:Pi(e,t,n),projectId:s,useOnCloseEvent:o||void 0},u=function(e,t){let r=Xn.parse(e);return r=yi(yi({},r),t),Xn.stringify(r)}(a[1]||"",c);return a[0]+"?"+u}function Ni(e,t){return e.filter((e=>t.includes(e))).length===e.length}function Ti(e){return Object.fromEntries(e.entries())}function xi(e){return new Map(Object.entries(e))}function Ri(e=Lt.FIVE_MINUTES,t){const r=Lt.toMiliseconds(e||Lt.FIVE_MINUTES);let n,i,s;return{resolve:e=>{s&&n&&(clearTimeout(s),n(e))},reject:e=>{s&&i&&(clearTimeout(s),i(e))},done:()=>new Promise(((e,o)=>{s=setTimeout((()=>{o(new Error(t))}),r),n=e,i=o}))}}function ji(e,t,r){return new Promise((async(n,i)=>{const s=setTimeout((()=>i(new Error(r))),t);try{n(await e)}catch(o){i(o)}clearTimeout(s)}))}function Ci(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function Ui(e){const[t,r]=e.split(":"),n={id:void 0,topic:void 0};if("topic"===t&&"string"==typeof r)n.topic=r;else{if("id"!==t||!Number.isInteger(Number(r)))throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);n.id=Number(r)}return n}function Li(e,t){return Lt.fromMiliseconds(Date.now()+Lt.toMiliseconds(e))}function Mi(e){return Date.now()>=Lt.toMiliseconds(e)}function Di(e,t){return`${e}${t?`:${t}`:""}`}function ki(e){return(null==e?void 0:e.relay)||{protocol:"irn"}}function $i(e){const t=tr[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}var zi=Object.defineProperty,qi=Object.getOwnPropertySymbols,Hi=Object.prototype.hasOwnProperty,Ki=Object.prototype.propertyIsEnumerable,Bi=(e,t,r)=>t in e?zi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;function Vi(e,t="-"){const r={},n="relay"+t;return Object.keys(e).forEach((t=>{if(t.startsWith(n)){const i=t.replace(n,""),s=e[t];r[i]=s}})),r}function Fi(e){return e.startsWith("//")?e.substring(2):e}function Wi(e){return`${e.protocol}:${e.topic}@${e.version}?`+Xn.stringify(((e,t)=>{for(var r in t||(t={}))Hi.call(t,r)&&Bi(e,r,t[r]);if(qi)for(var r of qi(t))Ki.call(t,r)&&Bi(e,r,t[r]);return e})({symKey:e.symKey},function(e,t="-"){const r={};return Object.keys(e).forEach((n=>{const i="relay"+t+n;e[n]&&(r[i]=e[n])})),r}(e.relay)))}function Gi(e){const t=[];return e.forEach((e=>{const[r,n]=e.split(":");t.push(`${r}:${n}`)})),t}const Yi={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Ji={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Qi(e,t){const{message:r,code:n}=Ji[e];return{message:t?`${r} ${t}`:r,code:n}}function Xi(e,t){const{message:r,code:n}=Yi[e];return{message:t?`${r} ${t}`:r,code:n}}function Zi(e,t){return!!Array.isArray(e)}function es(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function ts(e){return typeof e>"u"}function rs(e,t){return!(!t||!ts(e))||"string"==typeof e&&!!e.trim().length}function ns(e,t){return!(!t||!ts(e))||"number"==typeof e&&!isNaN(e)}function is(e){return!(!rs(e,!1)||!e.includes(":"))&&2===e.split(":").length}function ss(e){let t=!0;return Zi(e)?e.length&&(t=e.every((e=>rs(e,!1)))):t=!1,t}function os(e,t,r){let n=null;return Object.entries(e).forEach((([e,i])=>{if(n)return;const s=function(e,t,r){let n=null;return Zi(t)&&t.length?t.forEach((e=>{n||is(e)||(n=Xi("UNSUPPORTED_CHAINS",`${r}, chain ${e} should be a string and conform to "namespace:chainId" format`))})):is(e)||(n=Xi("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}(e,Zn(e,i),`${t} ${r}`);s&&(n=s)})),n}function as(e,t){let r=null;return Zi(e)?e.forEach((e=>{r||function(e){if(rs(e,!1)&&e.includes(":")){const t=e.split(":");if(3===t.length){const e=t[0]+":"+t[1];return!!t[2]&&is(e)}}return!1}(e)||(r=Xi("UNSUPPORTED_ACCOUNTS",`${t}, account ${e} should be a string and conform to "namespace:chainId:address" format`))})):r=Xi("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function cs(e,t){let r=null;return Object.values(e).forEach((e=>{if(r)return;const n=function(e,t){let r=null;return ss(null==e?void 0:e.methods)?ss(null==e?void 0:e.events)||(r=Xi("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=Xi("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}(e,`${t}, namespace`);n&&(r=n)})),r}function us(e,t){let r=null;if(e&&es(e)){const n=cs(e,t);n&&(r=n);const i=function(e,t){let r=null;return Object.values(e).forEach((e=>{if(r)return;const n=as(null==e?void 0:e.accounts,`${t} namespace`);n&&(r=n)})),r}(e,t);i&&(r=i)}else r=Qi("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function hs(e){return rs(e.protocol,!0)}function ls(e){return typeof e<"u"&&null!==typeof e}function fs(e,t){return!(!is(t)||!function(e){const t=[];return Object.values(e).forEach((e=>{t.push(...Gi(e.accounts))})),t}(e).includes(t))}function ps(e,t,r){return!!rs(r,!1)&&function(e,t){const r=[];return Object.values(e).forEach((e=>{Gi(e.accounts).includes(t)&&r.push(...e.methods)})),r}(e,t).includes(r)}function ds(e,t,r){return!!rs(r,!1)&&function(e,t){const r=[];return Object.values(e).forEach((e=>{Gi(e.accounts).includes(t)&&r.push(...e.events)})),r}(e,t).includes(r)}function gs(e,t,r){let n=null;const i=function(e){const t={};return Object.keys(e).forEach((r=>{var n;r.includes(":")?t[r]=e[r]:null==(n=e[r].chains)||n.forEach((n=>{t[n]={methods:e[r].methods,events:e[r].events}}))})),t}(e),s=function(e){const t={};return Object.keys(e).forEach((r=>{if(r.includes(":"))t[r]=e[r];else{const n=Gi(e[r].accounts);null==n||n.forEach((n=>{t[n]={accounts:e[r].accounts.filter((e=>e.includes(`${n}:`))),methods:e[r].methods,events:e[r].events}}))}})),t}(t),o=Object.keys(i),a=Object.keys(s),c=ys(Object.keys(e)),u=ys(Object.keys(t)),h=c.filter((e=>!u.includes(e)));return h.length&&(n=Qi("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.\n      Required: ${h.toString()}\n      Received: ${Object.keys(t).toString()}`)),Ni(o,a)||(n=Qi("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.\n      Required: ${o.toString()}\n      Approved: ${a.toString()}`)),Object.keys(t).forEach((e=>{if(!e.includes(":")||n)return;const i=Gi(t[e].accounts);i.includes(e)||(n=Qi("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${e}\n        Required: ${e}\n        Approved: ${i.toString()}`))})),o.forEach((e=>{n||(Ni(i[e].methods,s[e].methods)?Ni(i[e].events,s[e].events)||(n=Qi("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${e}`)):n=Qi("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${e}`))})),n}function ys(e){return[...new Set(e.map((e=>e.includes(":")?e.split(":")[0]:e)))]}const vs="PARSE_ERROR",ms="INVALID_REQUEST",bs="METHOD_NOT_FOUND",_s="INVALID_PARAMS",ws="INTERNAL_ERROR",Es="SERVER_ERROR",Ss=[-32700,-32600,-32601,-32602,-32603],Is={[vs]:{code:-32700,message:"Parse error"},[ms]:{code:-32600,message:"Invalid Request"},[bs]:{code:-32601,message:"Method not found"},[_s]:{code:-32602,message:"Invalid params"},[ws]:{code:-32603,message:"Internal error"},[Es]:{code:-32e3,message:"Server error"}},Os=Es;function Ps(e){return Object.keys(Is).includes(e)?Is[e]:Is[Os]}function As(e,t,r){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):e}var Ns,Ts={},xs={};var Rs,js,Cs={};var Us=(js||(js=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=ht;t.__exportStar(function(){if(Ns)return xs;function e(){return(null==n?void 0:n.crypto)||(null==n?void 0:n.msCrypto)||{}}function t(){const t=e();return t.subtle||t.webkitSubtle}return Ns=1,Object.defineProperty(xs,"__esModule",{value:!0}),xs.isBrowserCryptoAvailable=xs.getSubtleCrypto=xs.getBrowerCrypto=void 0,xs.getBrowerCrypto=e,xs.getSubtleCrypto=t,xs.isBrowserCryptoAvailable=function(){return!!e()&&!!t()},xs}(),e),t.__exportStar(function(){if(Rs)return Cs;function e(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product}function t(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node}return Rs=1,Object.defineProperty(Cs,"__esModule",{value:!0}),Cs.isBrowser=Cs.isNode=Cs.isReactNative=void 0,Cs.isReactNative=e,Cs.isNode=t,Cs.isBrowser=function(){return!e()&&!t()},Cs}(),e)}(Ts)),Ts);function Ls(e=3){return Date.now()*Math.pow(10,e)+Math.floor(Math.random()*Math.pow(10,e))}function Ms(e=6){return BigInt(Ls(e))}function Ds(e,t,r){return{id:r||Ls(),jsonrpc:"2.0",method:e,params:t}}function ks(e,t){return{id:e,jsonrpc:"2.0",result:t}}function $s(e,t,r){return{id:e,jsonrpc:"2.0",error:zs(t)}}function zs(e,t){return void 0===e?Ps(ws):("string"==typeof e&&(e=Object.assign(Object.assign({},Ps(Es)),{message:e})),r=e.code,Ss.includes(r)&&(e=function(e){const t=Object.values(Is).find((t=>t.code===e));return t||Is[Os]}(e.code)),e);var r}class qs{}class Hs extends qs{constructor(){super()}}class Ks extends Hs{constructor(e){super()}}function Bs(e,t){const r=function(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(t&&t.length)return t[0]}(e);return void 0!==r&&new RegExp(t).test(r)}function Vs(e){return Bs(e,"^https?:")}function Fs(e){return Bs(e,"^wss?:")}function Ws(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}function Gs(e){return"object"==typeof e&&"id"in e&&"jsonrpc"in e&&"2.0"===e.jsonrpc}function Ys(e){return Gs(e)&&"method"in e}function Js(e){return Gs(e)&&(Qs(e)||Xs(e))}function Qs(e){return"result"in e}function Xs(e){return"error"in e}class Zs extends Ks{constructor(e){super(e),this.events=new c.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Ds(e.method,e.params||[],e.id||Ms().toString()),t)}async requestStrict(e,t){return new Promise((async(r,n)=>{if(!this.connection.connected)try{await this.open()}catch(i){n(i)}this.events.on(`${e.id}`,(e=>{Xs(e)?n(e.error):r(e.result)}));try{await this.connection.send(e,t)}catch(i){n(i)}}))}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Js(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&3e3===e.code&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),"string"==typeof e&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",(e=>this.onPayload(e))),this.connection.on("close",(e=>this.onClose(e))),this.connection.on("error",(e=>this.events.emit("error",e))),this.connection.on("register_error",(e=>this.onClose())),this.hasRegisteredEventListeners=!0)}}const eo=e=>e.split("?")[0],to="undefined"!=typeof WebSocket?WebSocket:"undefined"!=typeof global&&void 0!==globalThis.WebSocket?globalThis.WebSocket:"undefined"!=typeof window&&void 0!==window.WebSocket?window.WebSocket:"undefined"!=typeof self&&void 0!==self.WebSocket?self.WebSocket:require("ws");class ro{constructor(e){if(this.url=e,this.events=new c.EventEmitter,this.registering=!1,!Fs(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return void 0!==this.socket}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise(((e,t)=>{void 0!==this.socket?(this.socket.onclose=t=>{this.onClose(t),e()},this.socket.close()):t(new Error("Connection already closed"))}))}async send(e,t){void 0===this.socket&&(this.socket=await this.register());try{this.socket.send(Sr(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!Fs(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise(((e,t)=>{this.events.once("register_error",(e=>{this.resetMaxListeners(),t(e)})),this.events.once("open",(()=>{if(this.resetMaxListeners(),void 0===this.socket)return t(new Error("WebSocket connection is missing or invalid"));e(this.socket)}))}))}return this.url=e,this.registering=!0,new Promise(((t,r)=>{const n=Us.isReactNative()?void 0:{rejectUnauthorized:!Ws(e)},i=new to(e,[],n);"undefined"!=typeof WebSocket||"undefined"!=typeof global&&void 0!==globalThis.WebSocket||"undefined"!=typeof window&&void 0!==window.WebSocket||"undefined"!=typeof self&&void 0!==self.WebSocket?i.onerror=e=>{const t=e;r(this.emitError(t.error))}:i.on("error",(e=>{r(this.emitError(e))})),i.onopen=()=>{this.onOpen(i),t(i)}}))}onOpen(e){e.onmessage=e=>this.onPayload(e),e.onclose=e=>this.onClose(e),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(void 0===e.data)return;const t="string"==typeof e.data?Er(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const r=this.parseError(t),n=$s(e,r.message||r.toString());this.events.emit("payload",n)}parseError(e,t=this.url){return As(e,eo(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}emitError(e){const t=this.parseError(new Error((null==e?void 0:e.message)||`WebSocket connection failed for host: ${eo(this.url)}`));return this.events.emit("register_error",t),t}}var no,io={exports:{}};const so=e((no||(no=1,function(e,t){var r="__lodash_hash_undefined__",i=9007199254740991,s="[object Arguments]",o="[object Array]",a="[object Boolean]",c="[object Date]",u="[object Error]",h="[object Function]",l="[object Map]",f="[object Number]",p="[object Object]",d="[object Promise]",g="[object RegExp]",y="[object Set]",v="[object String]",m="[object Symbol]",b="[object WeakMap]",_="[object ArrayBuffer]",w="[object DataView]",E=/^\[object .+?Constructor\]$/,S=/^(?:0|[1-9]\d*)$/,I={};I["[object Float32Array]"]=I["[object Float64Array]"]=I["[object Int8Array]"]=I["[object Int16Array]"]=I["[object Int32Array]"]=I["[object Uint8Array]"]=I["[object Uint8ClampedArray]"]=I["[object Uint16Array]"]=I["[object Uint32Array]"]=!0,I[s]=I[o]=I[_]=I[a]=I[w]=I[c]=I[u]=I[h]=I[l]=I[f]=I[p]=I[g]=I[y]=I[v]=I[b]=!1;var O="object"==typeof n&&n&&n.Object===Object&&n,P="object"==typeof self&&self&&self.Object===Object&&self,A=O||P||Function("return this")(),N=t&&!t.nodeType&&t,T=N&&e&&!e.nodeType&&e,x=T&&T.exports===N,R=x&&O.process,j=function(){try{return R&&R.binding&&R.binding("util")}catch(e){}}(),C=j&&j.isTypedArray;function U(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function L(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function M(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var D,k,$,z=Array.prototype,q=Function.prototype,H=Object.prototype,K=A["__core-js_shared__"],B=q.toString,V=H.hasOwnProperty,F=(D=/[^.]+$/.exec(K&&K.keys&&K.keys.IE_PROTO||""))?"Symbol(src)_1."+D:"",W=H.toString,G=RegExp("^"+B.call(V).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Y=x?A.Buffer:void 0,J=A.Symbol,Q=A.Uint8Array,X=H.propertyIsEnumerable,Z=z.splice,ee=J?J.toStringTag:void 0,te=Object.getOwnPropertySymbols,re=Y?Y.isBuffer:void 0,ne=(k=Object.keys,$=Object,function(e){return k($(e))}),ie=je(A,"DataView"),se=je(A,"Map"),oe=je(A,"Promise"),ae=je(A,"Set"),ce=je(A,"WeakMap"),ue=je(Object,"create"),he=Me(ie),le=Me(se),fe=Me(oe),pe=Me(ae),de=Me(ce),ge=J?J.prototype:void 0,ye=ge?ge.valueOf:void 0;function ve(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function me(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function be(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function _e(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new be;++t<r;)this.add(e[t])}function we(e){var t=this.__data__=new me(e);this.size=t.size}function Ee(e,t){var r=$e(e),n=!r&&ke(e),i=!r&&!n&&ze(e),s=!r&&!n&&!i&&Ve(e),o=r||n||i||s,a=o?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=a.length;for(var u in e)!V.call(e,u)||o&&("length"==u||i&&("offset"==u||"parent"==u)||s&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Le(u,c))||a.push(u);return a}function Se(e,t){for(var r=e.length;r--;)if(De(e[r][0],t))return r;return-1}function Ie(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":ee&&ee in Object(e)?function(e){var t=V.call(e,ee),r=e[ee];try{e[ee]=void 0;var n=!0}catch(s){}var i=W.call(e);return n&&(t?e[ee]=r:delete e[ee]),i}(e):function(e){return W.call(e)}(e)}function Oe(e){return Be(e)&&Ie(e)==s}function Pe(e,t,r,n,i){return e===t||(null==e||null==t||!Be(e)&&!Be(t)?e!=e&&t!=t:function(e,t,r,n,i,h){var d=$e(e),b=$e(t),E=d?o:Ue(e),S=b?o:Ue(t),I=(E=E==s?p:E)==p,O=(S=S==s?p:S)==p,P=E==S;if(P&&ze(e)){if(!ze(t))return!1;d=!0,I=!1}if(P&&!I)return h||(h=new we),d||Ve(e)?Te(e,t,r,n,i,h):function(e,t,r,n,i,s,o){switch(r){case w:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case _:return!(e.byteLength!=t.byteLength||!s(new Q(e),new Q(t)));case a:case c:case f:return De(+e,+t);case u:return e.name==t.name&&e.message==t.message;case g:case v:return e==t+"";case l:var h=L;case y:var p=1&n;if(h||(h=M),e.size!=t.size&&!p)return!1;var d=o.get(e);if(d)return d==t;n|=2,o.set(e,t);var b=Te(h(e),h(t),n,i,s,o);return o.delete(e),b;case m:if(ye)return ye.call(e)==ye.call(t)}return!1}(e,t,E,r,n,i,h);if(!(1&r)){var A=I&&V.call(e,"__wrapped__"),N=O&&V.call(t,"__wrapped__");if(A||N){var T=A?e.value():e,x=N?t.value():t;return h||(h=new we),i(T,x,r,n,h)}}return!!P&&(h||(h=new we),function(e,t,r,n,i,s){var o=1&r,a=xe(e),c=a.length,u=xe(t),h=u.length;if(c!=h&&!o)return!1;for(var l=c;l--;){var f=a[l];if(!(o?f in t:V.call(t,f)))return!1}var p=s.get(e);if(p&&s.get(t))return p==t;var d=!0;s.set(e,t),s.set(t,e);for(var g=o;++l<c;){var y=e[f=a[l]],v=t[f];if(n)var m=o?n(v,y,f,t,e,s):n(y,v,f,e,t,s);if(!(void 0===m?y===v||i(y,v,r,n,s):m)){d=!1;break}g||(g="constructor"==f)}if(d&&!g){var b=e.constructor,_=t.constructor;b==_||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof _&&_ instanceof _||(d=!1)}return s.delete(e),s.delete(t),d}(e,t,r,n,i,h))}(e,t,r,n,Pe,i))}function Ae(e){return!(!Ke(e)||function(e){return!!F&&F in e}(e))&&(qe(e)?G:E).test(Me(e))}function Ne(e){if(r=(t=e)&&t.constructor,n="function"==typeof r&&r.prototype||H,t!==n)return ne(e);var t,r,n,i=[];for(var s in Object(e))V.call(e,s)&&"constructor"!=s&&i.push(s);return i}function Te(e,t,r,n,i,s){var o=1&r,a=e.length,c=t.length;if(a!=c&&!(o&&c>a))return!1;var u=s.get(e);if(u&&s.get(t))return u==t;var h=-1,l=!0,f=2&r?new _e:void 0;for(s.set(e,t),s.set(t,e);++h<a;){var p=e[h],d=t[h];if(n)var g=o?n(d,p,h,t,e,s):n(p,d,h,e,t,s);if(void 0!==g){if(g)continue;l=!1;break}if(f){if(!U(t,(function(e,t){if(o=t,!f.has(o)&&(p===e||i(p,e,r,n,s)))return f.push(t);var o}))){l=!1;break}}else if(p!==d&&!i(p,d,r,n,s)){l=!1;break}}return s.delete(e),s.delete(t),l}function xe(e){return function(e,t,r){var n=t(e);return $e(e)?n:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(n,r(e))}(e,Fe,Ce)}function Re(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function je(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return Ae(r)?r:void 0}ve.prototype.clear=function(){this.__data__=ue?ue(null):{},this.size=0},ve.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ve.prototype.get=function(e){var t=this.__data__;if(ue){var n=t[e];return n===r?void 0:n}return V.call(t,e)?t[e]:void 0},ve.prototype.has=function(e){var t=this.__data__;return ue?void 0!==t[e]:V.call(t,e)},ve.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ue&&void 0===t?r:t,this},me.prototype.clear=function(){this.__data__=[],this.size=0},me.prototype.delete=function(e){var t=this.__data__,r=Se(t,e);return!(r<0||(r==t.length-1?t.pop():Z.call(t,r,1),--this.size,0))},me.prototype.get=function(e){var t=this.__data__,r=Se(t,e);return r<0?void 0:t[r][1]},me.prototype.has=function(e){return Se(this.__data__,e)>-1},me.prototype.set=function(e,t){var r=this.__data__,n=Se(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},be.prototype.clear=function(){this.size=0,this.__data__={hash:new ve,map:new(se||me),string:new ve}},be.prototype.delete=function(e){var t=Re(this,e).delete(e);return this.size-=t?1:0,t},be.prototype.get=function(e){return Re(this,e).get(e)},be.prototype.has=function(e){return Re(this,e).has(e)},be.prototype.set=function(e,t){var r=Re(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},_e.prototype.add=_e.prototype.push=function(e){return this.__data__.set(e,r),this},_e.prototype.has=function(e){return this.__data__.has(e)},we.prototype.clear=function(){this.__data__=new me,this.size=0},we.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},we.prototype.get=function(e){return this.__data__.get(e)},we.prototype.has=function(e){return this.__data__.has(e)},we.prototype.set=function(e,t){var r=this.__data__;if(r instanceof me){var n=r.__data__;if(!se||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new be(n)}return r.set(e,t),this.size=r.size,this};var Ce=te?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,s=[];++r<n;){var o=e[r];t(o,r,e)&&(s[i++]=o)}return s}(te(e),(function(t){return X.call(e,t)})))}:function(){return[]},Ue=Ie;function Le(e,t){return!!(t=null==t?i:t)&&("number"==typeof e||S.test(e))&&e>-1&&e%1==0&&e<t}function Me(e){if(null!=e){try{return B.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function De(e,t){return e===t||e!=e&&t!=t}(ie&&Ue(new ie(new ArrayBuffer(1)))!=w||se&&Ue(new se)!=l||oe&&Ue(oe.resolve())!=d||ae&&Ue(new ae)!=y||ce&&Ue(new ce)!=b)&&(Ue=function(e){var t=Ie(e),r=t==p?e.constructor:void 0,n=r?Me(r):"";if(n)switch(n){case he:return w;case le:return l;case fe:return d;case pe:return y;case de:return b}return t});var ke=Oe(function(){return arguments}())?Oe:function(e){return Be(e)&&V.call(e,"callee")&&!X.call(e,"callee")},$e=Array.isArray,ze=re||function(){return!1};function qe(e){if(!Ke(e))return!1;var t=Ie(e);return t==h||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function He(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}function Ke(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Be(e){return null!=e&&"object"==typeof e}var Ve=C?function(e){return function(t){return e(t)}}(C):function(e){return Be(e)&&He(e.length)&&!!I[Ie(e)]};function Fe(e){return null!=(t=e)&&He(t.length)&&!qe(t)?Ee(e):Ne(e);var t}e.exports=function(e,t){return Pe(e,t)}}(io,io.exports)),io.exports));var oo={};var ao=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function l(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*u+1>>>0,o=new Uint8Array(s);e[t];){var h=r[e.charCodeAt(t)];if(255===h)return;for(var l=0,f=s-1;(0!==h||l<i)&&-1!==f;f--,l++)h+=a*o[f]>>>0,o[f]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");i=l,t++}if(" "!==e[t]){for(var p=s-i;p!==s&&0===o[p];)p++;for(var d=new Uint8Array(n+(s-p)),g=n;p!==s;)d[g++]=o[p++];return d}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*h+1>>>0,u=new Uint8Array(o);i!==s;){for(var l=t[i],f=0,p=o-1;(0!==l||f<n)&&-1!==p;p--,f++)l+=256*u[p]>>>0,u[p]=l%a>>>0,l=l/a>>>0;if(0!==l)throw new Error("Non-zero carry");n=f,i++}for(var d=o-n;d!==o&&0===u[d];)d++;for(var g=c.repeat(r);d<o;++d)g+=e.charAt(u[d]);return g},decodeUnsafe:l,decode:function(e){var r=l(e);if(r)return r;throw new Error(`Non-${t} character`)}}},co=ao;const uo=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class ho{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class lo{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return po(this,e)}}class fo{constructor(e){this.decoders=e}or(e){return po(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const po=(e,t)=>new fo({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class go{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new ho(e,t,r),this.decoder=new lo(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const yo=({name:e,prefix:t,encode:r,decode:n})=>new go(e,t,r,n),vo=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=co(r,t);return yo({prefix:e,name:t,encode:n,decode:e=>uo(i(e))})},mo=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>yo({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let h=0;h<t.length;++h)i[t[h]]=h;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let h=0;h<s;++h){const t=i[e[h]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),bo=yo({prefix:"\0",name:"identity",encode:e=>(e=>(new TextDecoder).decode(e))(e),decode:e=>(e=>(new TextEncoder).encode(e))(e)});var _o=Object.freeze({__proto__:null,identity:bo});const wo=mo({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Eo=Object.freeze({__proto__:null,base2:wo});const So=mo({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Io=Object.freeze({__proto__:null,base8:So});const Oo=vo({prefix:"9",name:"base10",alphabet:"0123456789"});var Po=Object.freeze({__proto__:null,base10:Oo});const Ao=mo({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),No=mo({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var To=Object.freeze({__proto__:null,base16:Ao,base16upper:No});const xo=mo({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ro=mo({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),jo=mo({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Co=mo({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Uo=mo({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Lo=mo({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Mo=mo({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Do=mo({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ko=mo({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var $o=Object.freeze({__proto__:null,base32:xo,base32upper:Ro,base32pad:jo,base32padupper:Co,base32hex:Uo,base32hexupper:Lo,base32hexpad:Mo,base32hexpadupper:Do,base32z:ko});const zo=vo({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),qo=vo({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ho=Object.freeze({__proto__:null,base36:zo,base36upper:qo});const Ko=vo({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Bo=vo({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Vo=Object.freeze({__proto__:null,base58btc:Ko,base58flickr:Bo});const Fo=mo({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Wo=mo({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Go=mo({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Yo=mo({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Jo=Object.freeze({__proto__:null,base64:Fo,base64pad:Wo,base64url:Go,base64urlpad:Yo});const Qo=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),Xo=Qo.reduce(((e,t,r)=>(e[r]=t,e)),[]),Zo=Qo.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const ea=yo({prefix:"ðŸš€",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=Xo[t]),"")},decode:function(e){const t=[];for(const r of e){const e=Zo[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var ta=Object.freeze({__proto__:null,base256emoji:ea}),ra=function e(t,r,n){r=r||[];for(var i=n=n||0;t>=sa;)r[n++]=255&t|na,t/=128;for(;t&ia;)r[n++]=255&t|na,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},na=128,ia=-128,sa=Math.pow(2,31);var oa=function e(t,r){var n,i=0,s=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],i+=s<28?(n&ca)<<s:(n&ca)*Math.pow(2,s),s+=7}while(n>=aa);return e.bytes=o-r,i},aa=128,ca=127;var ua=Math.pow(2,7),ha=Math.pow(2,14),la=Math.pow(2,21),fa=Math.pow(2,28),pa=Math.pow(2,35),da=Math.pow(2,42),ga=Math.pow(2,49),ya=Math.pow(2,56),va=Math.pow(2,63),ma={encode:ra,decode:oa,encodingLength:function(e){return e<ua?1:e<ha?2:e<la?3:e<fa?4:e<pa?5:e<da?6:e<ga?7:e<ya?8:e<va?9:10}};const ba=(e,t,r=0)=>(ma.encode(e,t,r),t),_a=e=>ma.encodingLength(e),wa=(e,t)=>{const r=t.byteLength,n=_a(e),i=n+_a(r),s=new Uint8Array(i+r);return ba(e,s,0),ba(r,s,n),s.set(t,i),new Ea(e,r,t,s)};class Ea{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const Sa=({name:e,code:t,encode:r})=>new Ia(e,t,r);class Ia{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?wa(this.code,t):t.then((e=>wa(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Oa=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Pa=Sa({name:"sha2-256",code:18,encode:Oa("SHA-256")}),Aa=Sa({name:"sha2-512",code:19,encode:Oa("SHA-512")});Object.freeze({__proto__:null,sha256:Pa,sha512:Aa});const Na=uo,Ta={code:0,name:"identity",encode:Na,digest:e=>wa(0,Na(e))};Object.freeze({__proto__:null,identity:Ta});new TextEncoder,new TextDecoder;const xa={..._o,...Eo,...Io,...Po,...To,...$o,...Ho,...Vo,...Jo,...ta};function Ra(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function ja(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Ca=ja("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Ua=ja("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?Ra(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),La={utf8:Ca,"utf-8":Ca,hex:xa.base16,latin1:Ua,ascii:Ua,binary:Ua,...xa};const Ma="core",Da=`wc@2:${Ma}:`,ka="error",$a={database:":memory:"},za="client_ed25519_seed",qa=Lt.ONE_DAY,Ha=Lt.SIX_HOURS,Ka="wss://relay.walletconnect.com",Ba="wss://relay.walletconnect.org",Va="relayer_message",Fa="relayer_message_ack",Wa="relayer_connect",Ga="relayer_disconnect",Ya="relayer_error",Ja="relayer_connection_stalled",Qa="relayer_transport_closed",Xa="relayer_publish",Za="payload",ec="connect",tc="disconnect",rc="error",nc=Lt.ONE_SECOND/2,ic="subscription_created",sc="subscription_deleted",oc="subscription_sync",ac="subscription_resubscribed",cc=1e3*Lt.FIVE_SECONDS,uc={wc_pairingDelete:{req:{ttl:Lt.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Lt.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Lt.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Lt.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Lt.ONE_DAY,prompt:!1,tag:0},res:{ttl:Lt.ONE_DAY,prompt:!1,tag:0}}},hc="history_created",lc="history_updated",fc="history_deleted",pc="history_sync",dc="expirer_created",gc="expirer_deleted",yc="expirer_expired",vc="expirer_sync",mc="verify-api",bc="https://verify.walletconnect.com";class _c{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name="keychain",this.version="0.3",this.initialized=!1,this.storagePrefix=Da,this.init=async()=>{if(!this.initialized){const e=await this.getKeyChain();typeof e<"u"&&(this.keychain=e),this.initialized=!0}},this.has=e=>(this.isInitialized(),this.keychain.has(e)),this.set=async(e,t)=>{this.isInitialized(),this.keychain.set(e,t),await this.persist()},this.get=e=>{this.isInitialized();const t=this.keychain.get(e);if(typeof t>"u"){const{message:t}=Qi("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t},this.del=async e=>{this.isInitialized(),this.keychain.delete(e),await this.persist()},this.core=e,this.logger=fn(t,this.name)}get context(){return ln(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Ti(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?xi(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=Qi("NOT_INITIALIZED",this.name);throw new Error(e)}}}class wc{constructor(e,t,r){this.core=e,this.logger=t,this.name="crypto",this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=e=>(this.isInitialized(),this.keychain.has(e)),this.getClientId=async()=>{this.isInitialized();return Un(Ln(await this.getClientSeed()).publicKey)},this.generateKeyPair=()=>{this.isInitialized();const e=function(){const e=te.generateKeyPair();return{privateKey:nt(e.secretKey,ti),publicKey:nt(e.publicKey,ti)}}();return this.setPrivateKey(e.publicKey,e.privateKey)},this.signJWT=async e=>{this.isInitialized();const t=Ln(await this.getClientSeed()),r=ii(),n=qa;return await Mn(r,e,n,t)},this.generateSharedKey=(e,t,r)=>{this.isInitialized();const n=function(e,t){const r=te.sharedKey(rt(e,ti),rt(t,ti));return nt(new M.HKDF(Z.SHA256,r).expand(32),ti)}(this.getPrivateKey(e),t);return this.setSymKey(n,r)},this.setSymKey=async(e,t)=>{this.isInitialized();const r=t||function(e){return nt(Z.hash(rt(e,ti)),ti)}(e);return await this.keychain.set(r,e),r},this.deleteKeyPair=async e=>{this.isInitialized(),await this.keychain.del(e)},this.deleteSymKey=async e=>{this.isInitialized(),await this.keychain.del(e)},this.encode=async(e,t,r)=>{this.isInitialized();const n=ui(r),i=Sr(t);if(hi(n)){const t=n.senderPublicKey,r=n.receiverPublicKey;e=await this.generateSharedKey(t,r)}const s=this.getSymKey(e),{type:o,senderPublicKey:a}=n;return ai({type:o,symKey:s,message:i,senderPublicKey:a})},this.decode=async(e,t,r)=>{this.isInitialized();const n=function(e,t){const r=ci(e);return ui({type:oi(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?nt(r.senderPublicKey,ti):void 0,receiverPublicKey:null==t?void 0:t.receiverPublicKey})}(t,r);if(hi(n)){const t=n.receiverPublicKey,r=n.senderPublicKey;e=await this.generateSharedKey(t,r)}try{const r=function(e){const t=new x.ChaCha20Poly1305(rt(e.symKey,ti)),{sealed:r,iv:n}=ci(e.encoded),i=t.open(n,r);if(null===i)throw new Error("Failed to decrypt");return nt(i,ni)}({symKey:this.getSymKey(e),encoded:t});return Er(r)}catch(i){this.logger.error(`Failed to decode message from topic: '${e}', clientId: '${await this.getClientId()}'`),this.logger.error(i)}},this.getPayloadType=e=>oi(ci(e).type),this.getPayloadSenderPublicKey=e=>{const t=ci(e);return t.senderPublicKey?nt(t.senderPublicKey,ti):void 0},this.core=e,this.logger=fn(t,this.name),this.keychain=r||new _c(this.core,this.logger)}get context(){return ln(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(za)}catch{e=ii(),await this.keychain.set(za,e)}return function(e,t="utf8"){const r=La[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Ra(globalThis.Buffer.from(e,"utf-8"))}(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=Qi("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Ec extends gn{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name="messages",this.version="0.3",this.initialized=!1,this.storagePrefix=Da,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const e=await this.getRelayerMessages();typeof e<"u"&&(this.messages=e),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}finally{this.initialized=!0}}},this.set=async(e,t)=>{this.isInitialized();const r=si(t);let n=this.messages.get(e);return typeof n>"u"&&(n={}),typeof n[r]<"u"||(n[r]=t,this.messages.set(e,n),await this.persist()),r},this.get=e=>{this.isInitialized();let t=this.messages.get(e);return typeof t>"u"&&(t={}),t},this.has=(e,t)=>{this.isInitialized();return typeof this.get(e)[si(t)]<"u"},this.del=async e=>{this.isInitialized(),this.messages.delete(e),await this.persist()},this.logger=fn(e,this.name),this.core=t}get context(){return ln(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Ti(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?xi(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=Qi("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Sc extends yn{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new c.EventEmitter,this.name="publisher",this.queue=new Map,this.publishTimeout=Lt.toMiliseconds(Lt.TEN_SECONDS),this.queueTimeout=Lt.toMiliseconds(Lt.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(e,t,r)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:r}});try{const n=(null==r?void 0:r.ttl)||Ha,i=ki(r),s=(null==r?void 0:r.prompt)||!1,o=(null==r?void 0:r.tag)||0,a=(null==r?void 0:r.id)||Ms().toString(),c={topic:e,message:t,opts:{ttl:n,relay:i,prompt:s,tag:o,id:a}},u=setTimeout((()=>this.queue.set(a,c)),this.queueTimeout);try{await await ji(this.rpcPublish(e,t,n,i,s,o,a),this.publishTimeout),clearTimeout(u),this.relayer.events.emit(Xa,c)}catch{return this.logger.debug("Publishing Payload stalled"),void(this.needsTransportRestart=!0)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:r}})}catch(n){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(n),n}},this.on=(e,t)=>{this.events.on(e,t)},this.once=(e,t)=>{this.events.once(e,t)},this.off=(e,t)=>{this.events.off(e,t)},this.removeListener=(e,t)=>{this.events.removeListener(e,t)},this.relayer=e,this.logger=fn(t,this.name),this.registerEventListeners()}get context(){return ln(this.logger)}rpcPublish(e,t,r,n,i,s,o){var a,c,u,h;const l={method:$i(n.protocol).publish,params:{topic:e,message:t,ttl:r,prompt:i,tag:s},id:o};return ts(null==(a=l.params)?void 0:a.prompt)&&(null==(c=l.params)||delete c.prompt),ts(null==(u=l.params)?void 0:u.tag)&&(null==(h=l.params)||delete h.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:l}),this.relayer.request(l)}onPublish(e){this.queue.delete(e)}checkQueue(){this.queue.forEach((async e=>{const{topic:t,message:r,opts:n}=e;await this.publish(t,r,n)}))}registerEventListeners(){this.relayer.core.heartbeat.on(Xr.HEARTBEAT_EVENTS.pulse,(()=>{if(this.needsTransportRestart)return this.needsTransportRestart=!1,void this.relayer.events.emit(Ja);this.checkQueue()})),this.relayer.on(Fa,(e=>{this.onPublish(e.id.toString())}))}}class Ic{constructor(){this.map=new Map,this.set=(e,t)=>{const r=this.get(e);this.exists(e,t)||this.map.set(e,[...r,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u")return void this.map.delete(e);if(!this.map.has(e))return;const r=this.get(e);if(!this.exists(e,t))return;const n=r.filter((e=>e!==t));n.length?this.map.set(e,n):this.map.delete(e)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Oc=Object.defineProperty,Pc=Object.defineProperties,Ac=Object.getOwnPropertyDescriptors,Nc=Object.getOwnPropertySymbols,Tc=Object.prototype.hasOwnProperty,xc=Object.prototype.propertyIsEnumerable,Rc=(e,t,r)=>t in e?Oc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,jc=(e,t)=>{for(var r in t||(t={}))Tc.call(t,r)&&Rc(e,r,t[r]);if(Nc)for(var r of Nc(t))xc.call(t,r)&&Rc(e,r,t[r]);return e},Cc=(e,t)=>Pc(e,Ac(t));class Uc extends bn{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new Ic,this.events=new c.EventEmitter,this.name="subscription",this.version="0.3",this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Da,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(e,t)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{const r=ki(t),n={topic:e,relay:r};this.pending.set(e,n);const i=await this.rpcSubscribe(e,r);return this.onSubscribe(i,n),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}}),i}catch(r){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(r),r}},this.unsubscribe=async(e,t)=>{await this.restartToComplete(),this.isInitialized(),typeof(null==t?void 0:t.id)<"u"?await this.unsubscribeById(e,t.id,t):await this.unsubscribeByTopic(e,t)},this.isSubscribed=async e=>!!this.topics.includes(e)||await new Promise(((t,r)=>{const n=new Lt.Watch;n.start(this.pendingSubscriptionWatchLabel);const i=setInterval((()=>{!this.pending.has(e)&&this.topics.includes(e)&&(clearInterval(i),n.stop(this.pendingSubscriptionWatchLabel),t(!0)),n.elapsed(this.pendingSubscriptionWatchLabel)>=cc&&(clearInterval(i),n.stop(this.pendingSubscriptionWatchLabel),r(new Error("Subscription resolution timeout")))}),this.pollingInterval)})).catch((()=>!1)),this.on=(e,t)=>{this.events.on(e,t)},this.once=(e,t)=>{this.events.once(e,t)},this.off=(e,t)=>{this.events.off(e,t)},this.removeListener=(e,t)=>{this.events.removeListener(e,t)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=fn(t,this.name),this.clientId=""}get context(){return ln(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let r=!1;try{r=this.getSubscription(e).topic===t}catch{}return r}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const r=this.topicMap.get(e);await Promise.all(r.map((async r=>await this.unsubscribeById(e,r,t))))}async unsubscribeById(e,t,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{const n=ki(r);await this.rpcUnsubscribe(e,t,n);const i=Xi("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,t){const r={method:$i(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await ji(this.relayer.request(r),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Ja)}return si(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t={method:$i(e[0].relay.protocol).batchSubscribe,params:{topics:e.map((e=>e.topic))}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{return await await ji(this.relayer.request(t),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ja)}}rpcUnsubscribe(e,t,r){const n={method:$i(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(e,t){this.setSubscription(e,Cc(jc({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach((e=>{this.setSubscription(e.id,jc({},e)),this.pending.delete(e.topic)}))}async onUnsubscribe(e,t,r){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,jc({},t)),this.topicMap.set(t.topic,e),this.events.emit(ic,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:t}=Qi("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(sc,Cc(jc({},r),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(oc)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const e=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(e)}}this.events.emit(ac)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:e}=Qi("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);Zi(t)&&this.onBatchSubscribe(t.map(((t,r)=>Cc(jc({},e[r]),{id:t}))))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach((t=>{e.push(t)})),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Xr.HEARTBEAT_EVENTS.pulse,(async()=>{await this.checkPending()})),this.relayer.on(Wa,(async()=>{await this.onConnect()})),this.relayer.on(Ga,(()=>{this.onDisconnect()})),this.events.on(ic,(async e=>{const t=ic;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})),this.events.on(sc,(async e=>{const t=sc;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}))}isInitialized(){if(!this.initialized){const{message:e}=Qi("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise((e=>{const t=setInterval((()=>{this.restartInProgress||(clearInterval(t),e())}),this.pollingInterval)}))}}var Lc=Object.defineProperty,Mc=Object.getOwnPropertySymbols,Dc=Object.prototype.hasOwnProperty,kc=Object.prototype.propertyIsEnumerable,$c=(e,t,r)=>t in e?Lc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;class zc extends vn{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new c.EventEmitter,this.name="relayer",this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async e=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(e)}catch(t){throw this.logger.debug("Failed to Publish Request"),this.logger.error(t),t}},this.core=e.core,this.logger=typeof e.logger<"u"&&"string"!=typeof e.logger?fn(e.logger,this.name):Zr(hn({level:e.logger||"error"})),this.messages=new Ec(this.logger,e.core),this.subscriber=new Uc(this,this.logger),this.publisher=new Sc(this,this.logger),this.relayUrl=(null==e?void 0:e.relayUrl)||Ka,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Ba}...`),await this.restartTransport(Ba)}this.registerEventListeners(),this.initialized=!0,setTimeout((async()=>{0===this.subscriber.topics.length&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)}),1e4)}get context(){return ln(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,r){this.isInitialized(),await this.publisher.publish(e,t,r),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var r;this.isInitialized();let n=(null==(r=this.subscriber.topicMap.get(e))?void 0:r[0])||"";return n||(await Promise.all([new Promise((t=>{this.subscriber.once(ic,(r=>{r.topic===e&&t()}))})),new Promise((async r=>{n=await this.subscriber.subscribe(e,t),r()}))]),n)}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Qa))}async transportOpen(e){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=e||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise((e=>{this.initialized||e(),this.subscriber.once(ac,(()=>{e()}))})),await Promise.race([new Promise((async(e,t)=>{await ji(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`).catch((e=>t(e))).then((()=>e())).finally((()=>this.removeListener(Qa,this.rejectTransportOpen)))})),new Promise((e=>this.once(Qa,this.rejectTransportOpen)))])])}catch(t){this.logger.error(t);const e=t;if(!this.isConnectionStalled(e.message))throw t;this.events.emit(Qa)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=e||this.relayUrl,this.connected&&await Promise.all([new Promise((e=>{this.provider.once(tc,(()=>{e()}))})),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some((t=>e.includes(t)))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Zs(new ro(Ai({sdkVersion:"2.9.1",protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:r}=e;await this.messages.set(t,r)}async shouldIgnoreMessageEvent(e){const{topic:t,message:r}=e;if(!r||0===r.length)return this.logger.debug(`Ignoring invalid/empty message: ${r}`),!0;if(!(await this.subscriber.isSubscribed(t)))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const n=this.messages.has(t,r);return n&&this.logger.debug(`Ignoring duplicate message: ${r}`),n}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Ys(e)){if(!e.method.endsWith("_subscription"))return;const t=e.params,{topic:r,message:n,publishedAt:i}=t.data,s={topic:r,message:n,publishedAt:i};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(((e,t)=>{for(var r in t)Dc.call(t,r)&&$c(e,r,t[r]);if(Mc)for(var r of Mc(t))kc.call(t,r)&&$c(e,r,t[r]);return e})({type:"event",event:t.id},s)),this.events.emit(t.id,s),await this.acknowledgePayload(e),await this.onMessageEvent(s)}else Js(e)&&this.events.emit(Fa,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Va,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=ks(e.id,!0);await this.provider.connection.send(t)}registerProviderListeners(){this.provider.on(Za,(e=>this.onProviderPayload(e))),this.provider.on(ec,(()=>{this.events.emit(Wa)})),this.provider.on(tc,(()=>{this.onProviderDisconnect()})),this.provider.on(rc,(e=>{this.logger.error(e),this.events.emit(Ya,e)}))}registerEventListeners(){this.events.on(Ja,(async()=>{await this.restartTransport()}))}onProviderDisconnect(){this.events.emit(Ga),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout((async()=>{await this.restartTransport()}),Lt.toMiliseconds(nc))}isInitialized(){if(!this.initialized){const{message:e}=Qi("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise((e=>{const t=setInterval((()=>{this.connected&&(clearInterval(t),e())}),this.connectionStatusPollingInterval)}));await this.restartTransport()}}}var qc=Object.defineProperty,Hc=Object.getOwnPropertySymbols,Kc=Object.prototype.hasOwnProperty,Bc=Object.prototype.propertyIsEnumerable,Vc=(e,t,r)=>t in e?qc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Fc=(e,t)=>{for(var r in t||(t={}))Kc.call(t,r)&&Vc(e,r,t[r]);if(Hc)for(var r of Hc(t))Bc.call(t,r)&&Vc(e,r,t[r]);return e};class Wc extends mn{constructor(e,t,r,n=Da,i=void 0){super(e,t,r,n),this.core=e,this.logger=t,this.name=r,this.map=new Map,this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=Da,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((e=>{this.getKey&&null!==e&&!ts(e)?this.map.set(this.getKey(e),e):function(e){var t;return null==(t=null==e?void 0:e.proposer)?void 0:t.publicKey}(e)?this.map.set(e.id,e):function(e){return null==e?void 0:e.topic}(e)&&this.map.set(e.topic,e)})),this.cached=[],this.initialized=!0)},this.set=async(e,t)=>{this.isInitialized(),this.map.has(e)?await this.update(e,t):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:e,value:t}),this.map.set(e,t),await this.persist())},this.get=e=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:e}),this.getData(e)),this.getAll=e=>(this.isInitialized(),e?this.values.filter((t=>Object.keys(e).every((r=>so(t[r],e[r]))))):this.values),this.update=async(e,t)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:e,update:t});const r=Fc(Fc({},this.getData(e)),t);this.map.set(e,r),await this.persist()},this.delete=async(e,t)=>{this.isInitialized(),this.map.has(e)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:e,reason:t}),this.map.delete(e),await this.persist())},this.logger=fn(t,this.name),this.storagePrefix=n,this.getKey=i}get context(){return ln(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:t}=Qi("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),new Error(t)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:e}=Qi("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=Qi("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Gc{constructor(e,t){this.core=e,this.logger=t,this.name="pairing",this.version="0.3",this.events=new u,this.initialized=!1,this.storagePrefix=Da,this.ignoredPayloadTypes=[1],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:e})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...e])]},this.create=async()=>{this.isInitialized();const e=ii(),t=await this.core.crypto.setSymKey(e),r=Li(Lt.FIVE_MINUTES),n={protocol:"irn"},i={topic:t,expiry:r,relay:n,active:!1},s=Wi({protocol:this.core.protocol,version:this.core.version,topic:t,symKey:e,relay:n});return await this.pairings.set(t,i),await this.core.relayer.subscribe(t),this.core.expirer.set(t,r),{topic:t,uri:s}},this.pair=async e=>{this.isInitialized(),this.isValidPair(e);const{topic:t,symKey:r,relay:n}=function(e){const t=e.indexOf(":"),r=-1!==e.indexOf("?")?e.indexOf("?"):void 0,n=e.substring(0,t),i=e.substring(t+1,r).split("@"),s=typeof r<"u"?e.substring(r):"",o=Xn.parse(s);return{protocol:n,topic:Fi(i[0]),version:parseInt(i[1],10),symKey:o.symKey,relay:Vi(o)}}(e.uri);if(this.pairings.keys.includes(t))throw new Error(`Pairing already exists: ${t}`);if(this.core.crypto.hasKeys(t))throw new Error(`Keychain already exists: ${t}`);const i=Li(Lt.FIVE_MINUTES),s={topic:t,relay:n,expiry:i,active:!1};return await this.pairings.set(t,s),await this.core.crypto.setSymKey(r,t),await this.core.relayer.subscribe(t,{relay:n}),this.core.expirer.set(t,i),e.activatePairing&&await this.activate({topic:t}),s},this.activate=async({topic:e})=>{this.isInitialized();const t=Li(Lt.THIRTY_DAYS);await this.pairings.update(e,{active:!0,expiry:t}),this.core.expirer.set(e,t)},this.ping=async e=>{this.isInitialized(),await this.isValidPing(e);const{topic:t}=e;if(this.pairings.keys.includes(t)){const e=await this.sendRequest(t,"wc_pairingPing",{}),{done:r,resolve:n,reject:i}=Ri();this.events.once(Di("pairing_ping",e),(({error:e})=>{e?i(e):n()})),await r()}},this.updateExpiry=async({topic:e,expiry:t})=>{this.isInitialized(),await this.pairings.update(e,{expiry:t})},this.updateMetadata=async({topic:e,metadata:t})=>{this.isInitialized(),await this.pairings.update(e,{peerMetadata:t})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async e=>{this.isInitialized(),await this.isValidDisconnect(e);const{topic:t}=e;this.pairings.keys.includes(t)&&(await this.sendRequest(t,"wc_pairingDelete",Xi("USER_DISCONNECTED")),await this.deletePairing(t))},this.sendRequest=async(e,t,r)=>{const n=Ds(t,r),i=await this.core.crypto.encode(e,n),s=uc[t].req;return this.core.history.set(e,n),this.core.relayer.publish(e,i,s),n.id},this.sendResult=async(e,t,r)=>{const n=ks(e,r),i=await this.core.crypto.encode(t,n),s=await this.core.history.get(t,e),o=uc[s.request.method].res;await this.core.relayer.publish(t,i,o),await this.core.history.resolve(n)},this.sendError=async(e,t,r)=>{const n=$s(e,r),i=await this.core.crypto.encode(t,n),s=await this.core.history.get(t,e),o=uc[s.request.method]?uc[s.request.method].res:uc.unregistered_method.res;await this.core.relayer.publish(t,i,o),await this.core.history.resolve(n)},this.deletePairing=async(e,t)=>{await this.core.relayer.unsubscribe(e),await Promise.all([this.pairings.delete(e,Xi("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(e),t?Promise.resolve():this.core.expirer.del(e)])},this.cleanup=async()=>{const e=this.pairings.getAll().filter((e=>Mi(e.expiry)));await Promise.all(e.map((e=>this.deletePairing(e.topic))))},this.onRelayEventRequest=e=>{const{topic:t,payload:r}=e;switch(r.method){case"wc_pairingPing":return this.onPairingPingRequest(t,r);case"wc_pairingDelete":return this.onPairingDeleteRequest(t,r);default:return this.onUnknownRpcMethodRequest(t,r)}},this.onRelayEventResponse=async e=>{const{topic:t,payload:r}=e,n=(await this.core.history.get(t,r.id)).request.method;return"wc_pairingPing"===n?this.onPairingPingResponse(t,r):this.onUnknownRpcMethodResponse(n)},this.onPairingPingRequest=async(e,t)=>{const{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult(r,e,!0),this.events.emit("pairing_ping",{id:r,topic:e})}catch(n){await this.sendError(r,e,n),this.logger.error(n)}},this.onPairingPingResponse=(e,t)=>{const{id:r}=t;setTimeout((()=>{Qs(t)?this.events.emit(Di("pairing_ping",r),{}):Xs(t)&&this.events.emit(Di("pairing_ping",r),{error:t.error})}),500)},this.onPairingDeleteRequest=async(e,t)=>{const{id:r}=t;try{this.isValidDisconnect({topic:e}),await this.deletePairing(e),this.events.emit("pairing_delete",{id:r,topic:e})}catch(n){await this.sendError(r,e,n),this.logger.error(n)}},this.onUnknownRpcMethodRequest=async(e,t)=>{const{id:r,method:n}=t;try{if(this.registeredMethods.includes(n))return;const t=Xi("WC_METHOD_UNSUPPORTED",n);await this.sendError(r,e,t),this.logger.error(t)}catch(i){await this.sendError(r,e,i),this.logger.error(i)}},this.onUnknownRpcMethodResponse=e=>{this.registeredMethods.includes(e)||this.logger.error(Xi("WC_METHOD_UNSUPPORTED",e))},this.isValidPair=e=>{if(!ls(e)){const{message:t}=Qi("MISSING_OR_INVALID",`pair() params: ${e}`);throw new Error(t)}if(!function(e){if(rs(e,!1))try{return typeof new URL(e)<"u"}catch{return!1}return!1}(e.uri)){const{message:t}=Qi("MISSING_OR_INVALID",`pair() uri: ${e.uri}`);throw new Error(t)}},this.isValidPing=async e=>{if(!ls(e)){const{message:t}=Qi("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidPairingTopic(t)},this.isValidDisconnect=async e=>{if(!ls(e)){const{message:t}=Qi("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidPairingTopic(t)},this.isValidPairingTopic=async e=>{if(!rs(e,!1)){const{message:t}=Qi("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.pairings.keys.includes(e)){const{message:t}=Qi("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Mi(this.pairings.get(e).expiry)){await this.deletePairing(e);const{message:t}=Qi("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}},this.core=e,this.logger=fn(t,this.name),this.pairings=new Wc(this.core,this.logger,this.name,this.storagePrefix)}get context(){return ln(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=Qi("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Va,(async e=>{const{topic:t,message:r}=e;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))return;const n=await this.core.crypto.decode(t,r);Ys(n)?(this.core.history.set(t,n),this.onRelayEventRequest({topic:t,payload:n})):Js(n)&&(await this.core.history.resolve(n),await this.onRelayEventResponse({topic:t,payload:n}),this.core.history.delete(t,n.id))}))}registerExpirerEvents(){this.core.expirer.on(yc,(async e=>{const{topic:t}=Ui(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))}))}}class Yc extends dn{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new c.EventEmitter,this.name="history",this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=Da,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((e=>this.records.set(e.id,e))),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(e,t,r)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:r}),this.records.has(t.id))return;const n={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:r,expiry:Li(Lt.THIRTY_DAYS)};this.records.set(n.id,n),this.events.emit(hc,n)},this.resolve=async e=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:e}),!this.records.has(e.id))return;const t=await this.getRecord(e.id);typeof t.response>"u"&&(t.response=Xs(e)?{error:e.error}:{result:e.result},this.records.set(t.id,t),this.events.emit(lc,t))},this.get=async(e,t)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:e,id:t}),await this.getRecord(t)),this.delete=(e,t)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:t}),this.values.forEach((r=>{if(r.topic===e){if(typeof t<"u"&&r.id!==t)return;this.records.delete(r.id),this.events.emit(fc,r)}}))},this.exists=async(e,t)=>(this.isInitialized(),!!this.records.has(t)&&(await this.getRecord(t)).topic===e),this.on=(e,t)=>{this.events.on(e,t)},this.once=(e,t)=>{this.events.once(e,t)},this.off=(e,t)=>{this.events.off(e,t)},this.removeListener=(e,t)=>{this.events.removeListener(e,t)},this.logger=fn(t,this.name)}get context(){return ln(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach((t=>{if(typeof t.response<"u")return;const r={topic:t.topic,request:Ds(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)})),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:t}=Qi("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(pc)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:e}=Qi("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(hc,(e=>{const t=hc;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()})),this.events.on(lc,(e=>{const t=lc;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()})),this.events.on(fc,(e=>{const t=fc;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()})),this.core.heartbeat.on(Xr.HEARTBEAT_EVENTS.pulse,(()=>{this.cleanup()}))}cleanup(){try{this.records.forEach((e=>{Lt.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))}))}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=Qi("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Jc extends _n{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new c.EventEmitter,this.name="expirer",this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=Da,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((e=>this.expirations.set(e.target,e))),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=e=>{try{const t=this.formatTarget(e);return typeof this.getExpiration(t)<"u"}catch{return!1}},this.set=(e,t)=>{this.isInitialized();const r=this.formatTarget(e),n={target:r,expiry:t};this.expirations.set(r,n),this.checkExpiry(r,n),this.events.emit(dc,{target:r,expiration:n})},this.get=e=>{this.isInitialized();const t=this.formatTarget(e);return this.getExpiration(t)},this.del=e=>{if(this.isInitialized(),this.has(e)){const t=this.formatTarget(e),r=this.getExpiration(t);this.expirations.delete(t),this.events.emit(gc,{target:t,expiration:r})}},this.on=(e,t)=>{this.events.on(e,t)},this.once=(e,t)=>{this.events.once(e,t)},this.off=(e,t)=>{this.events.off(e,t)},this.removeListener=(e,t)=>{this.events.removeListener(e,t)},this.logger=fn(t,this.name)}get context(){return ln(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if("string"==typeof e)return function(e){return Ci("topic",e)}(e);if("number"==typeof e)return function(e){return Ci("id",e)}(e);const{message:t}=Qi("UNKNOWN_TYPE","Target type: "+typeof e);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(vc)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:e}=Qi("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:t}=Qi("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),new Error(t)}return t}checkExpiry(e,t){const{expiry:r}=t;Lt.toMiliseconds(r)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(yc,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach(((e,t)=>this.checkExpiry(t,e)))}registerEventListeners(){this.core.heartbeat.on(Xr.HEARTBEAT_EVENTS.pulse,(()=>this.checkExpirations())),this.events.on(dc,(e=>{const t=dc;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})),this.events.on(yc,(e=>{const t=yc;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})),this.events.on(gc,(e=>{const t=gc;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}))}isInitialized(){if(!this.initialized){const{message:e}=Qi("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Qc extends wn{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=mc,this.initialized=!1,this.init=async e=>{Si()||!Ii()||(this.verifyUrl=(null==e?void 0:e.verifyUrl)||bc,await this.createIframe())},this.register=async e=>{var t;if(this.initialized||await this.init(),this.iframe)try{null==(t=this.iframe.contentWindow)||t.postMessage(e.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${e.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async e=>{var t;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${e.attestationId}`);const r=this.startAbortTimer(Lt.FIVE_SECONDS),n=await fetch(`${this.verifyUrl}/attestation/${e.attestationId}`,{signal:this.abortController.signal});return clearTimeout(r),200===n.status?null==(t=await n.json())?void 0:t.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise(((e,t)=>{if(document.getElementById(mc))return e();const r=document.createElement("iframe");r.setAttribute("id",mc),r.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),r.style.display="none",r.addEventListener("load",(()=>{this.initialized=!0,e()})),r.addEventListener("error",(e=>{t(e)})),document.body.append(r),this.iframe=r})),new Promise((e=>{setTimeout((()=>e("iframe load timeout")),Lt.toMiliseconds(Lt.ONE_SECOND/2))}))])}catch(e){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(e)}},this.logger=fn(t,this.name),this.verifyUrl=bc,this.abortController=new AbortController,this.isDevEnv=Ei()&&oo.IS_VITEST}get context(){return ln(this.logger)}startAbortTimer(e){return setTimeout((()=>this.abortController.abort()),Lt.toMiliseconds(e))}}var Xc=Object.defineProperty,Zc=Object.getOwnPropertySymbols,eu=Object.prototype.hasOwnProperty,tu=Object.prototype.propertyIsEnumerable,ru=(e,t,r)=>t in e?Xc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,nu=(e,t)=>{for(var r in t||(t={}))eu.call(t,r)&&ru(e,r,t[r]);if(Zc)for(var r of Zc(t))tu.call(t,r)&&ru(e,r,t[r]);return e};class iu extends pn{constructor(e){super(e),this.protocol="wc",this.version=2,this.name=Ma,this.events=new c.EventEmitter,this.initialized=!1,this.on=(e,t)=>this.events.on(e,t),this.once=(e,t)=>this.events.once(e,t),this.off=(e,t)=>this.events.off(e,t),this.removeListener=(e,t)=>this.events.removeListener(e,t),this.projectId=null==e?void 0:e.projectId,this.relayUrl=(null==e?void 0:e.relayUrl)||Ka;const t=typeof(null==e?void 0:e.logger)<"u"&&"string"!=typeof(null==e?void 0:e.logger)?e.logger:Zr(hn({level:(null==e?void 0:e.logger)||ka}));this.logger=fn(t,this.name),this.heartbeat=new Xr.HeartBeat,this.crypto=new wc(this,this.logger,null==e?void 0:e.keychain),this.history=new Yc(this,this.logger),this.expirer=new Jc(this,this.logger),this.storage=null!=e&&e.storage?e.storage:new Rr(nu(nu({},$a),null==e?void 0:e.storageOptions)),this.relayer=new zc({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Gc(this,this.logger),this.verify=new Qc(this.projectId||"",this.logger)}static async init(e){const t=new iu(e);await t.initialize();const r=await t.crypto.getClientId();return await t.storage.setItem("WALLETCONNECT_CLIENT_ID",r),t}get context(){return ln(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const su=iu,ou="client",au=`wc@2:${ou}:`,cu=ou,uu="error",hu="Proposal expired",lu=Lt.SEVEN_DAYS,fu={wc_sessionPropose:{req:{ttl:Lt.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Lt.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Lt.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Lt.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Lt.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Lt.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Lt.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Lt.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Lt.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Lt.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Lt.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Lt.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Lt.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Lt.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Lt.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Lt.THIRTY_SECONDS,prompt:!1,tag:1115}}},pu={min:Lt.FIVE_MINUTES,max:Lt.SEVEN_DAYS},du="idle",gu="active",yu=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var vu=Object.defineProperty,mu=Object.defineProperties,bu=Object.getOwnPropertyDescriptors,_u=Object.getOwnPropertySymbols,wu=Object.prototype.hasOwnProperty,Eu=Object.prototype.propertyIsEnumerable,Su=(e,t,r)=>t in e?vu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Iu=(e,t)=>{for(var r in t||(t={}))wu.call(t,r)&&Su(e,r,t[r]);if(_u)for(var r of _u(t))Eu.call(t,r)&&Su(e,r,t[r]);return e},Ou=(e,t)=>mu(e,bu(t));class Pu extends Sn{constructor(e){super(e),this.name="engine",this.events=new u,this.initialized=!1,this.ignoredPayloadTypes=[1],this.requestQueue={state:du,requests:[]},this.requestQueueDelay=Lt.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(fu)}),this.initialized=!0,setTimeout((()=>{this.requestQueue.requests=this.getPendingSessionRequests(),this.processRequestQueue()}),Lt.toMiliseconds(this.requestQueueDelay)))},this.connect=async e=>{this.isInitialized();const t=Ou(Iu({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});await this.isValidConnect(t);const{pairingTopic:r,requiredNamespaces:n,optionalNamespaces:i,sessionProperties:s,relays:o}=t;let a,c=r,u=!1;if(c&&(u=this.client.core.pairing.pairings.get(c).active),!c||!u){const{topic:e,uri:t}=await this.client.core.pairing.create();c=e,a=t}const h=await this.client.core.crypto.generateKeyPair(),l=Iu({requiredNamespaces:n,optionalNamespaces:i,relays:o??[{protocol:"irn"}],proposer:{publicKey:h,metadata:this.client.metadata}},s&&{sessionProperties:s}),{reject:f,resolve:p,done:d}=Ri(Lt.FIVE_MINUTES,hu);if(this.events.once(Di("session_connect"),(async({error:e,session:t})=>{if(e)f(e);else if(t){t.self.publicKey=h;const e=Ou(Iu({},t),{requiredNamespaces:t.requiredNamespaces,optionalNamespaces:t.optionalNamespaces});await this.client.session.set(t.topic,e),await this.setExpiry(t.topic,t.expiry),c&&await this.client.core.pairing.updateMetadata({topic:c,metadata:t.peer.metadata}),p(e)}})),!c){const{message:e}=Qi("NO_MATCHING_KEY",`connect() pairing topic: ${c}`);throw new Error(e)}const g=await this.sendRequest(c,"wc_sessionPropose",l),y=Li(Lt.FIVE_MINUTES);return await this.setProposal(g,Iu({id:g,expiry:y},l)),{uri:a,approval:d}},this.pair=async e=>(this.isInitialized(),await this.client.core.pairing.pair(e)),this.approve=async e=>{this.isInitialized(),await this.isValidApprove(e);const{id:t,relayProtocol:r,namespaces:n,sessionProperties:i}=e,s=this.client.proposal.get(t);let{pairingTopic:o,proposer:a,requiredNamespaces:c,optionalNamespaces:u}=s;o=o||"",es(c)||(c=function(e,t){const r=us(e,t);if(r)throw new Error(r.message);const n={};for(const[i,s]of Object.entries(e))n[i]={methods:s.methods,events:s.events,chains:s.accounts.map((e=>`${e.split(":")[0]}:${e.split(":")[1]}`))};return n}(n,"approve()"));const h=await this.client.core.crypto.generateKeyPair(),l=a.publicKey,f=await this.client.core.crypto.generateSharedKey(h,l);o&&t&&(await this.client.core.pairing.updateMetadata({topic:o,metadata:a.metadata}),await this.sendResult(t,o,{relay:{protocol:r??"irn"},responderPublicKey:h}),await this.client.proposal.delete(t,Xi("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:o}));const p=Iu({relay:{protocol:r??"irn"},namespaces:n,requiredNamespaces:c,optionalNamespaces:u,pairingTopic:o,controller:{publicKey:h,metadata:this.client.metadata},expiry:Li(lu)},i&&{sessionProperties:i});await this.client.core.relayer.subscribe(f),await this.sendRequest(f,"wc_sessionSettle",p);const d=Ou(Iu({},p),{topic:f,pairingTopic:o,acknowledged:!1,self:p.controller,peer:{publicKey:a.publicKey,metadata:a.metadata},controller:h});return await this.client.session.set(f,d),await this.setExpiry(f,Li(lu)),{topic:f,acknowledged:()=>new Promise((e=>setTimeout((()=>e(this.client.session.get(f))),500)))}},this.reject=async e=>{this.isInitialized(),await this.isValidReject(e);const{id:t,reason:r}=e,{pairingTopic:n}=this.client.proposal.get(t);n&&(await this.sendError(t,n,r),await this.client.proposal.delete(t,Xi("USER_DISCONNECTED")))},this.update=async e=>{this.isInitialized(),await this.isValidUpdate(e);const{topic:t,namespaces:r}=e,n=await this.sendRequest(t,"wc_sessionUpdate",{namespaces:r}),{done:i,resolve:s,reject:o}=Ri();return this.events.once(Di("session_update",n),(({error:e})=>{e?o(e):s()})),await this.client.session.update(t,{namespaces:r}),{acknowledged:i}},this.extend=async e=>{this.isInitialized(),await this.isValidExtend(e);const{topic:t}=e,r=await this.sendRequest(t,"wc_sessionExtend",{}),{done:n,resolve:i,reject:s}=Ri();return this.events.once(Di("session_extend",r),(({error:e})=>{e?s(e):i()})),await this.setExpiry(t,Li(lu)),{acknowledged:n}},this.request=async t=>{this.isInitialized(),await this.isValidRequest(t);const{chainId:r,request:n,topic:i,expiry:s}=t,o=await this.sendRequest(i,"wc_sessionRequest",{request:n,chainId:r},s),{done:a,resolve:c,reject:u}=Ri(s);this.events.once(Di("session_request",o),(({error:e,result:t})=>{e?u(e):c(t)})),this.client.events.emit("session_request_sent",{topic:i,request:n,chainId:r,id:o});return async function({id:t,topic:r,wcDeepLink:n}){try{if(!n)return;const e="string"==typeof n?JSON.parse(n):n;let i=null==e?void 0:e.href;if("string"!=typeof i)return;i.endsWith("/")&&(i=i.slice(0,-1));const s=`${i}/wc?requestId=${t}&sessionTopic=${r}`,o=Oi();o===bi?s.startsWith("https://")?window.open(s,"_blank","noreferrer noopener"):window.open(s,"_self","noreferrer noopener"):o===vi&&typeof(null==global?void 0:global.Linking)<"u"&&await globalThis.Linking.openURL(s)}catch(e){console.error(e)}}({id:o,topic:i,wcDeepLink:await this.client.core.storage.getItem("WALLETCONNECT_DEEPLINK_CHOICE")}),await a()},this.respond=async e=>{this.isInitialized(),await this.isValidRespond(e);const{topic:t,response:r}=e,{id:n}=r;Qs(r)?await this.sendResult(n,t,r.result):Xs(r)&&await this.sendError(n,t,r.error),this.cleanupAfterResponse(e)},this.ping=async e=>{this.isInitialized(),await this.isValidPing(e);const{topic:t}=e;if(this.client.session.keys.includes(t)){const e=await this.sendRequest(t,"wc_sessionPing",{}),{done:r,resolve:n,reject:i}=Ri();this.events.once(Di("session_ping",e),(({error:e})=>{e?i(e):n()})),await r()}else this.client.core.pairing.pairings.keys.includes(t)&&await this.client.core.pairing.ping({topic:t})},this.emit=async e=>{this.isInitialized(),await this.isValidEmit(e);const{topic:t,event:r,chainId:n}=e;await this.sendRequest(t,"wc_sessionEvent",{event:r,chainId:n})},this.disconnect=async e=>{this.isInitialized(),await this.isValidDisconnect(e);const{topic:t}=e;if(this.client.session.keys.includes(t)){const e=Ms().toString();let r;const n=t=>{(null==t?void 0:t.id.toString())===e&&(this.client.core.relayer.events.removeListener(Fa,n),r())};await Promise.all([new Promise((e=>{r=e,this.client.core.relayer.on(Fa,n)})),this.sendRequest(t,"wc_sessionDelete",Xi("USER_DISCONNECTED"),void 0,e)]),await this.deleteSession(t)}else await this.client.core.pairing.disconnect({topic:t})},this.find=e=>(this.isInitialized(),this.client.session.getAll().filter((t=>function(e,t){const{requiredNamespaces:r}=t,n=Object.keys(e.namespaces),i=Object.keys(r);let s=!0;return!!Ni(i,n)&&(n.forEach((t=>{const{accounts:n,methods:i,events:o}=e.namespaces[t],a=Gi(n),c=r[t];Ni(Zn(t,c),a)&&Ni(c.methods,i)&&Ni(c.events,o)||(s=!1)})),s)}(t,e)))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async e=>{if(e.pairingTopic)try{const t=this.client.core.pairing.pairings.get(e.pairingTopic),r=this.client.core.pairing.pairings.getAll().filter((r=>{var n,i;return(null==(n=r.peerMetadata)?void 0:n.url)&&(null==(i=r.peerMetadata)?void 0:i.url)===e.peer.metadata.url&&r.topic&&r.topic!==t.topic}));if(0===r.length)return;this.client.logger.info(`Cleaning up ${r.length} duplicate pairing(s)`),await Promise.all(r.map((e=>this.client.core.pairing.disconnect({topic:e.topic})))),this.client.logger.info("Duplicate pairings clean up finished")}catch(t){this.client.logger.error(t)}},this.deleteSession=async(e,t)=>{const{self:r}=this.client.session.get(e);await this.client.core.relayer.unsubscribe(e),this.client.session.delete(e,Xi("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(r.publicKey)&&await this.client.core.crypto.deleteKeyPair(r.publicKey),this.client.core.crypto.keychain.has(e)&&await this.client.core.crypto.deleteSymKey(e),t||this.client.core.expirer.del(e)},this.deleteProposal=async(e,t)=>{await Promise.all([this.client.proposal.delete(e,Xi("USER_DISCONNECTED")),t?Promise.resolve():this.client.core.expirer.del(e)])},this.deletePendingSessionRequest=async(e,t,r=!1)=>{await Promise.all([this.client.pendingRequest.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)]),this.requestQueue.requests=this.requestQueue.requests.filter((t=>t.id!==e)),r&&(this.requestQueue.state=du)},this.setExpiry=async(e,t)=>{this.client.session.keys.includes(e)&&await this.client.session.update(e,{expiry:t}),this.client.core.expirer.set(e,t)},this.setProposal=async(e,t)=>{await this.client.proposal.set(e,t),this.client.core.expirer.set(e,t.expiry)},this.setPendingSessionRequest=async e=>{const t=fu.wc_sessionRequest.req.ttl,{id:r,topic:n,params:i}=e;await this.client.pendingRequest.set(r,{id:r,topic:n,params:i}),t&&this.client.core.expirer.set(r,Li(t))},this.sendRequest=async(e,t,r,n,i)=>{const s=Ds(t,r);if(Ii()&&yu.includes(t)){const e=si(JSON.stringify(s));await this.client.core.verify.register({attestationId:e})}const o=await this.client.core.crypto.encode(e,s),a=fu[t].req;return n&&(a.ttl=n),i&&(a.id=i),this.client.core.history.set(e,s),this.client.core.relayer.publish(e,o,a),s.id},this.sendResult=async(e,t,r)=>{const n=ks(e,r),i=await this.client.core.crypto.encode(t,n),s=await this.client.core.history.get(t,e),o=fu[s.request.method].res;this.client.core.relayer.publish(t,i,o),await this.client.core.history.resolve(n)},this.sendError=async(e,t,r)=>{const n=$s(e,r),i=await this.client.core.crypto.encode(t,n),s=await this.client.core.history.get(t,e),o=fu[s.request.method].res;this.client.core.relayer.publish(t,i,o),await this.client.core.history.resolve(n)},this.cleanup=async()=>{const e=[],t=[];this.client.session.getAll().forEach((t=>{Mi(t.expiry)&&e.push(t.topic)})),this.client.proposal.getAll().forEach((e=>{Mi(e.expiry)&&t.push(e.id)})),await Promise.all([...e.map((e=>this.deleteSession(e))),...t.map((e=>this.deleteProposal(e)))])},this.onRelayEventRequest=e=>{const{topic:t,payload:r}=e,n=r.method;switch(n){case"wc_sessionPropose":return this.onSessionProposeRequest(t,r);case"wc_sessionSettle":return this.onSessionSettleRequest(t,r);case"wc_sessionUpdate":return this.onSessionUpdateRequest(t,r);case"wc_sessionExtend":return this.onSessionExtendRequest(t,r);case"wc_sessionPing":return this.onSessionPingRequest(t,r);case"wc_sessionDelete":return this.onSessionDeleteRequest(t,r);case"wc_sessionRequest":return this.onSessionRequest(t,r);case"wc_sessionEvent":return this.onSessionEventRequest(t,r);default:return this.client.logger.info(`Unsupported request method ${n}`)}},this.onRelayEventResponse=async e=>{const{topic:t,payload:r}=e,n=(await this.client.core.history.get(t,r.id)).request.method;switch(n){case"wc_sessionPropose":return this.onSessionProposeResponse(t,r);case"wc_sessionSettle":return this.onSessionSettleResponse(t,r);case"wc_sessionUpdate":return this.onSessionUpdateResponse(t,r);case"wc_sessionExtend":return this.onSessionExtendResponse(t,r);case"wc_sessionPing":return this.onSessionPingResponse(t,r);case"wc_sessionRequest":return this.onSessionRequestResponse(t,r);default:return this.client.logger.info(`Unsupported response method ${n}`)}},this.onRelayEventUnknownPayload=e=>{const{topic:t}=e,{message:r}=Qi("MISSING_OR_INVALID",`Decoded payload on topic ${t} is not identifiable as a JSON-RPC request or a response.`);throw new Error(r)},this.onSessionProposeRequest=async(e,t)=>{const{params:r,id:n}=t;try{this.isValidConnect(Iu({},t.params));const i=Li(Lt.FIVE_MINUTES),s=Iu({id:n,pairingTopic:e,expiry:i},r);await this.setProposal(n,s);const o=si(JSON.stringify(t)),a=await this.getVerifyContext(o,s.proposer.metadata);this.client.events.emit("session_proposal",{id:n,params:s,verifyContext:a})}catch(i){await this.sendError(n,e,i),this.client.logger.error(i)}},this.onSessionProposeResponse=async(e,t)=>{const{id:r}=t;if(Qs(t)){const{result:n}=t;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:n});const i=this.client.proposal.get(r);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:i});const s=i.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:s});const o=n.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:o});const a=await this.client.core.crypto.generateSharedKey(s,o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:a});const c=await this.client.core.relayer.subscribe(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:c}),await this.client.core.pairing.activate({topic:e})}else Xs(t)&&(await this.client.proposal.delete(r,Xi("USER_DISCONNECTED")),this.events.emit(Di("session_connect"),{error:t.error}))},this.onSessionSettleRequest=async(e,t)=>{const{id:r,params:n}=t;try{this.isValidSessionSettleRequest(n);const{relay:r,controller:i,expiry:s,namespaces:o,requiredNamespaces:a,optionalNamespaces:c,sessionProperties:u,pairingTopic:h}=t.params,l=Iu({topic:e,relay:r,expiry:s,namespaces:o,acknowledged:!0,pairingTopic:h,requiredNamespaces:a,optionalNamespaces:c,controller:i.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:i.publicKey,metadata:i.metadata}},u&&{sessionProperties:u});await this.sendResult(t.id,e,!0),this.events.emit(Di("session_connect"),{session:l}),this.cleanupDuplicatePairings(l)}catch(i){await this.sendError(r,e,i),this.client.logger.error(i)}},this.onSessionSettleResponse=async(e,t)=>{const{id:r}=t;Qs(t)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(Di("session_approve",r),{})):Xs(t)&&(await this.client.session.delete(e,Xi("USER_DISCONNECTED")),this.events.emit(Di("session_approve",r),{error:t.error}))},this.onSessionUpdateRequest=async(e,t)=>{const{params:r,id:n}=t;try{this.isValidUpdate(Iu({topic:e},r)),await this.client.session.update(e,{namespaces:r.namespaces}),await this.sendResult(n,e,!0),this.client.events.emit("session_update",{id:n,topic:e,params:r})}catch(i){await this.sendError(n,e,i),this.client.logger.error(i)}},this.onSessionUpdateResponse=(e,t)=>{const{id:r}=t;Qs(t)?this.events.emit(Di("session_update",r),{}):Xs(t)&&this.events.emit(Di("session_update",r),{error:t.error})},this.onSessionExtendRequest=async(e,t)=>{const{id:r}=t;try{this.isValidExtend({topic:e}),await this.setExpiry(e,Li(lu)),await this.sendResult(r,e,!0),this.client.events.emit("session_extend",{id:r,topic:e})}catch(n){await this.sendError(r,e,n),this.client.logger.error(n)}},this.onSessionExtendResponse=(e,t)=>{const{id:r}=t;Qs(t)?this.events.emit(Di("session_extend",r),{}):Xs(t)&&this.events.emit(Di("session_extend",r),{error:t.error})},this.onSessionPingRequest=async(e,t)=>{const{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult(r,e,!0),this.client.events.emit("session_ping",{id:r,topic:e})}catch(n){await this.sendError(r,e,n),this.client.logger.error(n)}},this.onSessionPingResponse=(e,t)=>{const{id:r}=t;setTimeout((()=>{Qs(t)?this.events.emit(Di("session_ping",r),{}):Xs(t)&&this.events.emit(Di("session_ping",r),{error:t.error})}),500)},this.onSessionDeleteRequest=async(e,t)=>{const{id:r}=t;try{this.isValidDisconnect({topic:e,reason:t.params}),await Promise.all([new Promise((t=>{this.client.core.relayer.once(Xa,(async()=>{t(await this.deleteSession(e))}))})),this.sendResult(r,e,!0)]),this.client.events.emit("session_delete",{id:r,topic:e})}catch(n){this.client.logger.error(n)}},this.onSessionRequest=async(e,t)=>{const{id:r,params:n}=t;try{this.isValidRequest(Iu({topic:e},n)),await this.setPendingSessionRequest({id:r,topic:e,params:n}),this.addRequestToQueue({id:r,topic:e,params:n}),await this.processRequestQueue()}catch(i){await this.sendError(r,e,i),this.client.logger.error(i)}},this.onSessionRequestResponse=(e,t)=>{const{id:r}=t;Qs(t)?this.events.emit(Di("session_request",r),{result:t.result}):Xs(t)&&this.events.emit(Di("session_request",r),{error:t.error})},this.onSessionEventRequest=async(e,t)=>{const{id:r,params:n}=t;try{this.isValidEmit(Iu({topic:e},n)),this.client.events.emit("session_event",{id:r,topic:e,params:n})}catch(i){await this.sendError(r,e,i),this.client.logger.error(i)}},this.addRequestToQueue=e=>{this.requestQueue.requests.push(e)},this.cleanupAfterResponse=e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout((()=>{this.requestQueue.state=du,this.processRequestQueue()}),Lt.toMiliseconds(this.requestQueueDelay))},this.processRequestQueue=async()=>{if(this.requestQueue.state===gu)return void this.client.logger.info("session request queue is already active.");const e=this.requestQueue.requests[0];if(e)try{const{id:t,topic:r,params:n}=e,i=si(JSON.stringify({id:t,params:n})),s=this.client.session.get(r),o=await this.getVerifyContext(i,s.peer.metadata);this.requestQueue.state=gu,this.client.events.emit("session_request",{id:t,topic:r,params:n,verifyContext:o})}catch(t){this.client.logger.error(t)}else this.client.logger.info("session request queue is empty.")},this.isValidConnect=async e=>{if(!ls(e)){const{message:t}=Qi("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw new Error(t)}const{pairingTopic:t,requiredNamespaces:r,optionalNamespaces:n,sessionProperties:i,relays:s}=e;if(ts(t)||await this.isValidPairingTopic(t),!function(e){let t=!1;return e?e&&Zi(e)&&e.length&&e.forEach((e=>{t=hs(e)})):t=!0,t}(s)){const{message:e}=Qi("MISSING_OR_INVALID",`connect() relays: ${s}`);throw new Error(e)}!ts(r)&&0!==es(r)&&this.validateNamespaces(r,"requiredNamespaces"),!ts(n)&&0!==es(n)&&this.validateNamespaces(n,"optionalNamespaces"),ts(i)||this.validateSessionProps(i,"sessionProperties")},this.validateNamespaces=(e,t)=>{const r=function(e,t,r){let n=null;if(e&&es(e)){const i=cs(e,t);i&&(n=i);const s=os(e,t,r);s&&(n=s)}else n=Qi("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return n}(e,"connect()",t);if(r)throw new Error(r.message)},this.isValidApprove=async e=>{if(!ls(e))throw new Error(Qi("MISSING_OR_INVALID",`approve() params: ${e}`).message);const{id:t,namespaces:r,relayProtocol:n,sessionProperties:i}=e;await this.isValidProposalId(t);const s=this.client.proposal.get(t),o=us(r,"approve()");if(o)throw new Error(o.message);const a=gs(s.requiredNamespaces,r,"approve()");if(a)throw new Error(a.message);if(!rs(n,!0)){const{message:e}=Qi("MISSING_OR_INVALID",`approve() relayProtocol: ${n}`);throw new Error(e)}ts(i)||this.validateSessionProps(i,"sessionProperties")},this.isValidReject=async e=>{if(!ls(e)){const{message:t}=Qi("MISSING_OR_INVALID",`reject() params: ${e}`);throw new Error(t)}const{id:t,reason:r}=e;if(await this.isValidProposalId(t),!function(e){return!!(e&&"object"==typeof e&&e.code&&ns(e.code,!1)&&e.message&&rs(e.message,!1))}(r)){const{message:e}=Qi("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(r)}`);throw new Error(e)}},this.isValidSessionSettleRequest=e=>{if(!ls(e)){const{message:t}=Qi("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw new Error(t)}const{relay:t,controller:r,namespaces:n,expiry:i}=e;if(!hs(t)){const{message:e}=Qi("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(e)}const s=function(e,t){let r=null;return rs(null==e?void 0:e.publicKey,!1)||(r=Qi("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}(r,"onSessionSettleRequest()");if(s)throw new Error(s.message);const o=us(n,"onSessionSettleRequest()");if(o)throw new Error(o.message);if(Mi(i)){const{message:e}=Qi("EXPIRED","onSessionSettleRequest()");throw new Error(e)}},this.isValidUpdate=async e=>{if(!ls(e)){const{message:t}=Qi("MISSING_OR_INVALID",`update() params: ${e}`);throw new Error(t)}const{topic:t,namespaces:r}=e;await this.isValidSessionTopic(t);const n=this.client.session.get(t),i=us(r,"update()");if(i)throw new Error(i.message);const s=gs(n.requiredNamespaces,r,"update()");if(s)throw new Error(s.message)},this.isValidExtend=async e=>{if(!ls(e)){const{message:t}=Qi("MISSING_OR_INVALID",`extend() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidSessionTopic(t)},this.isValidRequest=async e=>{if(!ls(e)){const{message:t}=Qi("MISSING_OR_INVALID",`request() params: ${e}`);throw new Error(t)}const{topic:t,request:r,chainId:n,expiry:i}=e;await this.isValidSessionTopic(t);const{namespaces:s}=this.client.session.get(t);if(!fs(s,n)){const{message:e}=Qi("MISSING_OR_INVALID",`request() chainId: ${n}`);throw new Error(e)}if(!function(e){return!(ts(e)||!rs(e.method,!1))}(r)){const{message:e}=Qi("MISSING_OR_INVALID",`request() ${JSON.stringify(r)}`);throw new Error(e)}if(!ps(s,n,r.method)){const{message:e}=Qi("MISSING_OR_INVALID",`request() method: ${r.method}`);throw new Error(e)}if(i&&!function(e,t){return ns(e,!1)&&e<=t.max&&e>=t.min}(i,pu)){const{message:e}=Qi("MISSING_OR_INVALID",`request() expiry: ${i}. Expiry must be a number (in seconds) between ${pu.min} and ${pu.max}`);throw new Error(e)}},this.isValidRespond=async e=>{if(!ls(e)){const{message:t}=Qi("MISSING_OR_INVALID",`respond() params: ${e}`);throw new Error(t)}const{topic:t,response:r}=e;if(await this.isValidSessionTopic(t),!function(e){return!(ts(e)||ts(e.result)&&ts(e.error)||!ns(e.id,!1)||!rs(e.jsonrpc,!1))}(r)){const{message:e}=Qi("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(r)}`);throw new Error(e)}},this.isValidPing=async e=>{if(!ls(e)){const{message:t}=Qi("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidSessionOrPairingTopic(t)},this.isValidEmit=async e=>{if(!ls(e)){const{message:t}=Qi("MISSING_OR_INVALID",`emit() params: ${e}`);throw new Error(t)}const{topic:t,event:r,chainId:n}=e;await this.isValidSessionTopic(t);const{namespaces:i}=this.client.session.get(t);if(!fs(i,n)){const{message:e}=Qi("MISSING_OR_INVALID",`emit() chainId: ${n}`);throw new Error(e)}if(!function(e){return!(ts(e)||!rs(e.name,!1))}(r)){const{message:e}=Qi("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(r)}`);throw new Error(e)}if(!ds(i,n,r.name)){const{message:e}=Qi("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(r)}`);throw new Error(e)}},this.isValidDisconnect=async e=>{if(!ls(e)){const{message:t}=Qi("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidSessionOrPairingTopic(t)},this.getVerifyContext=async(e,t)=>{const r={verified:{verifyUrl:t.verifyUrl||"",validation:"UNKNOWN",origin:t.url||""}};try{const n=await this.client.core.verify.resolve({attestationId:e,verifyUrl:t.verifyUrl});n&&(r.verified.origin=n,r.verified.validation=n===t.url?"VALID":"INVALID")}catch(n){this.client.logger.error(n)}return this.client.logger.info(`Verify context: ${JSON.stringify(r)}`),r},this.validateSessionProps=(e,t)=>{Object.values(e).forEach((e=>{if(!rs(e,!1)){const{message:r}=Qi("MISSING_OR_INVALID",`${t} must be in Record<string, string> format. Received: ${JSON.stringify(e)}`);throw new Error(r)}}))}}isInitialized(){if(!this.initialized){const{message:e}=Qi("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(Va,(async e=>{const{topic:t,message:r}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(r)))return;const n=await this.client.core.crypto.decode(t,r);Ys(n)?(this.client.core.history.set(t,n),this.onRelayEventRequest({topic:t,payload:n})):Js(n)?(await this.client.core.history.resolve(n),await this.onRelayEventResponse({topic:t,payload:n}),this.client.core.history.delete(t,n.id)):this.onRelayEventUnknownPayload({topic:t,payload:n})}))}registerExpirerEvents(){this.client.core.expirer.on(yc,(async e=>{const{topic:t,id:r}=Ui(e.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,Qi("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))}))}isValidPairingTopic(e){if(!rs(e,!1)){const{message:t}=Qi("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=Qi("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Mi(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=Qi("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!rs(e,!1)){const{message:t}=Qi("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=Qi("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Mi(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:t}=Qi("EXPIRED",`session topic: ${e}`);throw new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else{if(!this.client.core.pairing.pairings.keys.includes(e)){if(rs(e,!1)){const{message:t}=Qi("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}{const{message:t}=Qi("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}this.isValidPairingTopic(e)}}async isValidProposalId(e){if("number"!=typeof e){const{message:t}=Qi("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=Qi("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Mi(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:t}=Qi("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class Au extends Wc{constructor(e,t){super(e,t,"proposal",au),this.core=e,this.logger=t}}class Nu extends Wc{constructor(e,t){super(e,t,"session",au),this.core=e,this.logger=t}}class Tu extends Wc{constructor(e,t){super(e,t,"request",au,(e=>e.id)),this.core=e,this.logger=t}}let xu=class e extends En{constructor(e){super(e),this.protocol="wc",this.version=2,this.name=cu,this.events=new c.EventEmitter,this.on=(e,t)=>this.events.on(e,t),this.once=(e,t)=>this.events.once(e,t),this.off=(e,t)=>this.events.off(e,t),this.removeListener=(e,t)=>this.events.removeListener(e,t),this.removeAllListeners=e=>this.events.removeAllListeners(e),this.connect=async e=>{try{return await this.engine.connect(e)}catch(t){throw this.logger.error(t.message),t}},this.pair=async e=>{try{return await this.engine.pair(e)}catch(t){throw this.logger.error(t.message),t}},this.approve=async e=>{try{return await this.engine.approve(e)}catch(t){throw this.logger.error(t.message),t}},this.reject=async e=>{try{return await this.engine.reject(e)}catch(t){throw this.logger.error(t.message),t}},this.update=async e=>{try{return await this.engine.update(e)}catch(t){throw this.logger.error(t.message),t}},this.extend=async e=>{try{return await this.engine.extend(e)}catch(t){throw this.logger.error(t.message),t}},this.request=async e=>{try{return await this.engine.request(e)}catch(t){throw this.logger.error(t.message),t}},this.respond=async e=>{try{return await this.engine.respond(e)}catch(t){throw this.logger.error(t.message),t}},this.ping=async e=>{try{return await this.engine.ping(e)}catch(t){throw this.logger.error(t.message),t}},this.emit=async e=>{try{return await this.engine.emit(e)}catch(t){throw this.logger.error(t.message),t}},this.disconnect=async e=>{try{return await this.engine.disconnect(e)}catch(t){throw this.logger.error(t.message),t}},this.find=e=>{try{return this.engine.find(e)}catch(t){throw this.logger.error(t.message),t}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(e){throw this.logger.error(e.message),e}},this.name=(null==e?void 0:e.name)||cu,this.metadata=(null==e?void 0:e.metadata)||Jn.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]};const t=typeof(null==e?void 0:e.logger)<"u"&&"string"!=typeof(null==e?void 0:e.logger)?e.logger:Zr(hn({level:(null==e?void 0:e.logger)||uu}));this.core=(null==e?void 0:e.core)||new su(e),this.logger=fn(t,this.name),this.session=new Nu(this.core,this.logger),this.proposal=new Au(this.core,this.logger),this.pendingRequest=new Tu(this.core,this.logger),this.engine=new Pu(this)}static async init(t){const r=new e(t);return await r.initialize(),r}get context(){return ln(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var Ru,ju={};!function(){if(Ru)return ju;Ru=1,Object.defineProperty(ju,"__esModule",{value:!0}),ju.getWindowMetadata=void 0;const e=Dt();ju.getWindowMetadata=function(){let t,r;try{t=e.getDocumentOrThrow(),r=e.getLocationOrThrow()}catch(s){return null}function n(...e){const r=t.getElementsByTagName("meta");for(let t=0;t<r.length;t++){const n=r[t],i=["itemprop","property","name"].map((e=>n.getAttribute(e))).filter((t=>!!t&&e.includes(t)));if(i.length&&i){const e=n.getAttribute("content");if(e)return e}}return""}const i=function(){let e=n("name","og:site_name","og:title","twitter:title");return e||(e=t.title),e}();return{description:n("description","og:description","twitter:description","keywords"),url:r.origin,icons:function(){const e=t.getElementsByTagName("link"),n=[];for(let t=0;t<e.length;t++){const i=e[t],s=i.getAttribute("rel");if(s&&s.toLowerCase().indexOf("icon")>-1){const e=i.getAttribute("href");if(e)if(-1===e.toLowerCase().indexOf("https:")&&-1===e.toLowerCase().indexOf("http:")&&0!==e.indexOf("//")){let t=r.protocol+"//"+r.host;if(0===e.indexOf("/"))t+=e;else{const n=r.pathname.split("/");n.pop();t+=n.join("/")+"/"+e}n.push(t)}else if(0===e.indexOf("//")){const t=r.protocol+e;n.push(t)}else n.push(e)}}return n}(),name:i}}}();var Cu,Uu={};function Lu(e=[],t=[]){return[...new Set([...e,...t])]}function Mu(e){return e.includes(":")}function Du(e){return Mu(e)?e.split(":")[0]:e}Cu||(Cu=1,function(e){const t=Qt(),r=Xt(),n=Zt(),i=er(),s=Symbol("encodeFragmentIdentifier");function o(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function a(e,r){return r.encode?r.strict?t(e):encodeURIComponent(e):e}function c(e,t){return t.decode?r(e):e}function u(e){return Array.isArray(e)?e.sort():"object"==typeof e?u(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function h(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function l(e){const t=(e=h(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function f(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function p(e,t){o((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const r=function(e){let t;switch(e.arrayFormat){case"index":return(e,r,n)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return(e,r,n)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"colon-list-separator":return(e,r,n)=>{t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"comma":case"separator":return(t,r,n)=>{const i="string"==typeof r&&r.includes(e.arrayFormatSeparator),s="string"==typeof r&&!i&&c(r,e).includes(e.arrayFormatSeparator);r=s?c(r,e):r;const o=i||s?r.split(e.arrayFormatSeparator).map((t=>c(t,e))):null===r?r:c(r,e);n[t]=o};case"bracket-separator":return(t,r,n)=>{const i=/(\[\])$/.test(t);if(t=t.replace(/\[\]$/,""),!i)return void(n[t]=r?c(r,e):r);const s=null===r?[]:r.split(e.arrayFormatSeparator).map((t=>c(t,e)));void 0!==n[t]?n[t]=[].concat(n[t],s):n[t]=s};default:return(e,t,r)=>{void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t),i=Object.create(null);if("string"!=typeof e)return i;if(!(e=e.trim().replace(/^[?#&]/,"")))return i;for(const s of e.split("&")){if(""===s)continue;let[e,o]=n(t.decode?s.replace(/\+/g," "):s,"=");o=void 0===o?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?o:c(o,t),r(c(e,t),o,i)}for(const n of Object.keys(i)){const e=i[n];if("object"==typeof e&&null!==e)for(const r of Object.keys(e))e[r]=f(e[r],t);else i[n]=f(e,t)}return!1===t.sort?i:(!0===t.sort?Object.keys(i).sort():Object.keys(i).sort(t.sort)).reduce(((e,t)=>{const r=i[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=u(r):e[t]=r,e}),Object.create(null))}e.extract=l,e.parse=p,e.stringify=(e,t)=>{if(!e)return"";o((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=r=>t.skipNull&&null==e[r]||t.skipEmptyString&&""===e[r],n=function(e){switch(e.arrayFormat){case"index":return t=>(r,n)=>{const i=r.length;return void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[a(t,e),"[",i,"]"].join("")]:[...r,[a(t,e),"[",a(i,e),"]=",a(n,e)].join("")]};case"bracket":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[a(t,e),"[]"].join("")]:[...r,[a(t,e),"[]=",a(n,e)].join("")];case"colon-list-separator":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[a(t,e),":list="].join("")]:[...r,[a(t,e),":list=",a(n,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return r=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:(i=null===i?"":i,0===n.length?[[a(r,e),t,a(i,e)].join("")]:[[n,a(i,e)].join(e.arrayFormatSeparator)])}default:return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,a(t,e)]:[...r,[a(t,e),"=",a(n,e)].join("")]}}(t),i={};for(const o of Object.keys(e))r(o)||(i[o]=e[o]);const s=Object.keys(i);return!1!==t.sort&&s.sort(t.sort),s.map((r=>{const i=e[r];return void 0===i?"":null===i?a(r,t):Array.isArray(i)?0===i.length&&"bracket-separator"===t.arrayFormat?a(r,t)+"[]":i.reduce(n(r),[]).join("&"):a(r,t)+"="+a(i,t)})).filter((e=>e.length>0)).join("&")},e.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[r,i]=n(e,"#");return Object.assign({url:r.split("?")[0]||"",query:p(l(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:c(i,t)}:{})},e.stringifyUrl=(t,r)=>{r=Object.assign({encode:!0,strict:!0,[s]:!0},r);const n=h(t.url).split("?")[0]||"",i=e.extract(t.url),o=e.parse(i,{sort:!1}),c=Object.assign(o,t.query);let u=e.stringify(c,r);u&&(u=`?${u}`);let l=function(e){let t="";const r=e.indexOf("#");return-1!==r&&(t=e.slice(r)),t}(t.url);return t.fragmentIdentifier&&(l=`#${r[s]?a(t.fragmentIdentifier,r):t.fragmentIdentifier}`),`${n}${u}${l}`},e.pick=(t,r,n)=>{n=Object.assign({parseFragmentIdentifier:!0,[s]:!1},n);const{url:o,query:a,fragmentIdentifier:c}=e.parseUrl(t,n);return e.stringifyUrl({url:o,query:i(a,r),fragmentIdentifier:c},n)},e.exclude=(t,r,n)=>{const i=Array.isArray(r)?e=>!r.includes(e):(e,t)=>!r(e,t);return e.pick(t,i,n)}}(Uu));const ku={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function $u(e,t){const{message:r,code:n}=ku[e];return{message:t?`${r} ${t}`:r,code:n}}function zu(e,t){return!!Array.isArray(e)}var qu,Hu={exports:{}};const Ku=e((qu||(qu=1,function(e,t){var r,i="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==n&&n,s=function(){function e(){this.fetch=!1,this.DOMException=i.DOMException}return e.prototype=i,new e}();r=s,function(e){var t=void 0!==r&&r||"undefined"!=typeof self&&self||void 0!==n&&n||{},i="URLSearchParams"in t,s="Symbol"in t&&"iterator"in Symbol,o="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(e){return!1}}(),a="FormData"in t,c="ArrayBuffer"in t;if(c)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(e){return e&&u.indexOf(Object.prototype.toString.call(e))>-1};function l(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function f(e){return"string"!=typeof e&&(e=String(e)),e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return s&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){if(2!=e.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function g(e){if(!e._noBody)return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function y(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function v(e){var t=new FileReader,r=y(t);return t.readAsArrayBuffer(e),r}function m(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:o&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:a&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:i&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():c&&o&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=m(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c&&(ArrayBuffer.prototype.isPrototypeOf(e)||h(e))?this._bodyArrayBuffer=m(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=g(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=g(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}if(o)return this.blob().then(v);throw new Error("could not read as ArrayBuffer")},this.text=function(){var e,t,r,n,i,s=g(this);if(s)return s;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=y(t),n=/charset=([A-Za-z0-9_-]+)/.exec(e.type),i=n?n[1]:"utf-8",t.readAsText(e,i),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a&&(this.formData=function(){return this.text().then(E)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(e,t){e=l(e),t=f(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},d.prototype.delete=function(e){delete this.map[l(e)]},d.prototype.get=function(e){return e=l(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(l(e))},d.prototype.set=function(e,t){this.map[l(e)]=f(t)},d.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},d.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),p(e)},d.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),p(e)},d.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),p(e)},s&&(d.prototype[Symbol.iterator]=d.prototype.entries);var _=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function w(e,r){if(!(this instanceof w))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,i,s=(r=r||{}).body;if(e instanceof w){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,r.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,s||null==e._bodyInit||(s=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=r.credentials||this.credentials||"same-origin",!r.headers&&this.headers||(this.headers=new d(r.headers)),this.method=(n=r.method||this.method||"GET",i=n.toUpperCase(),_.indexOf(i)>-1?i:n),this.mode=r.mode||this.mode||null,this.signal=r.signal||this.signal||function(){if("AbortController"in t)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&s)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(s),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==r.cache&&"no-cache"!==r.cache)){var o=/([?&])_=[^&]*/;o.test(this.url)?this.url=this.url.replace(o,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function E(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}})),t}function S(e,t){if(!(this instanceof S))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},b.call(w.prototype),b.call(S.prototype),S.prototype.clone=function(){return new S(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},S.error=function(){var e=new S(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var I=[301,302,303,307,308];S.redirect=function(e,t){if(-1===I.indexOf(t))throw new RangeError("Invalid status code");return new S(null,{status:t,headers:{location:e}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(P){e.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function O(r,n){return new Promise((function(i,s){var a=new w(r,n);if(a.signal&&a.signal.aborted)return s(new e.DOMException("Aborted","AbortError"));var u=new XMLHttpRequest;function h(){u.abort()}if(u.onload=function(){var e,t,r={statusText:u.statusText,headers:(e=u.getAllResponseHeaders()||"",t=new d,e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();try{t.append(n,i)}catch(s){s.message}}})),t)};0===a.url.indexOf("file://")&&(u.status<200||u.status>599)?r.status=200:r.status=u.status,r.url="responseURL"in u?u.responseURL:r.headers.get("X-Request-URL");var n="response"in u?u.response:u.responseText;setTimeout((function(){i(new S(n,r))}),0)},u.onerror=function(){setTimeout((function(){s(new TypeError("Network request failed"))}),0)},u.ontimeout=function(){setTimeout((function(){s(new TypeError("Network request timed out"))}),0)},u.onabort=function(){setTimeout((function(){s(new e.DOMException("Aborted","AbortError"))}),0)},u.open(a.method,function(e){try{return""===e&&t.location.href?t.location.href:e}catch(r){return e}}(a.url),!0),"include"===a.credentials?u.withCredentials=!0:"omit"===a.credentials&&(u.withCredentials=!1),"responseType"in u&&(o?u.responseType="blob":c&&(u.responseType="arraybuffer")),n&&"object"==typeof n.headers&&!(n.headers instanceof d||t.Headers&&n.headers instanceof t.Headers)){var p=[];Object.getOwnPropertyNames(n.headers).forEach((function(e){p.push(l(e)),u.setRequestHeader(e,f(n.headers[e]))})),a.headers.forEach((function(e,t){-1===p.indexOf(t)&&u.setRequestHeader(t,e)}))}else a.headers.forEach((function(e,t){u.setRequestHeader(t,e)}));a.signal&&(a.signal.addEventListener("abort",h),u.onreadystatechange=function(){4===u.readyState&&a.signal.removeEventListener("abort",h)}),u.send(void 0===a._bodyInit?null:a._bodyInit)}))}O.polyfill=!0,t.fetch||(t.fetch=O,t.Headers=d,t.Request=w,t.Response=S),e.Headers=d,e.Request=w,e.Response=S,e.fetch=O,Object.defineProperty(e,"__esModule",{value:!0})}({}),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=i.fetch?i:s;(t=o.fetch).default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,e.exports=t}(Hu,Hu.exports)),Hu.exports));var Bu=Object.defineProperty,Vu=Object.defineProperties,Fu=Object.getOwnPropertyDescriptors,Wu=Object.getOwnPropertySymbols,Gu=Object.prototype.hasOwnProperty,Yu=Object.prototype.propertyIsEnumerable,Ju=(e,t,r)=>t in e?Bu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Qu=(e,t)=>{for(var r in t)Gu.call(t,r)&&Ju(e,r,t[r]);if(Wu)for(var r of Wu(t))Yu.call(t,r)&&Ju(e,r,t[r]);return e},Xu=(e,t)=>Vu(e,Fu(t));const Zu={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};let eh=class{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new c.EventEmitter,this.isAvailable=!1,this.registering=!1,!Vs(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const t=Sr(e),r=await(await Ku(this.url,Xu(Qu({},Zu),{body:t}))).json();this.onPayload({data:r})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!Vs(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise(((e,t)=>{this.events.once("register_error",(e=>{this.resetMaxListeners(),t(e)})),this.events.once("open",(()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return t(new Error("HTTP connection is missing or invalid"));e()}))}))}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=Sr({id:1,jsonrpc:"2.0",method:"test",params:[]});await Ku(e,Xu(Qu({},Zu),{body:t}))}this.onOpen()}catch(t){const e=this.parseError(t);throw this.events.emit("register_error",e),this.onClose(),e}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t="string"==typeof e.data?Er(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const r=this.parseError(t),n=$s(e,r.message||r.toString());this.events.emit("payload",n)}parseError(e,t=this.url){return As(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}};const th="error",rh="wc@2:universal_provider:",nh="default_chain_changed";var ih,sh,oh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ah={exports:{}};
/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/ih=ah,sh=ah.exports,function(){var e,t="Expected a function",r="__lodash_hash_undefined__",n="__lodash_placeholder__",i=32,s=128,o=256,a=1/0,c=9007199254740991,u=NaN,h=4294967295,l=h-1,f=h>>>1,p=[["ary",s],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",i],["partialRight",64],["rearg",o]],d="[object Arguments]",g="[object Array]",y="[object Boolean]",v="[object Date]",m="[object Error]",b="[object Function]",_="[object GeneratorFunction]",w="[object Map]",E="[object Number]",S="[object Object]",I="[object Promise]",O="[object RegExp]",P="[object Set]",A="[object String]",N="[object Symbol]",T="[object WeakMap]",x="[object ArrayBuffer]",R="[object DataView]",j="[object Float32Array]",C="[object Float64Array]",U="[object Int8Array]",L="[object Int16Array]",M="[object Int32Array]",D="[object Uint8Array]",k="[object Uint8ClampedArray]",$="[object Uint16Array]",z="[object Uint32Array]",q=/\b__p \+= '';/g,H=/\b(__p \+=) '' \+/g,K=/(__e\(.*?\)|\b__t\)) \+\n'';/g,B=/&(?:amp|lt|gt|quot|#39);/g,V=/[&<>"']/g,F=RegExp(B.source),W=RegExp(V.source),G=/<%-([\s\S]+?)%>/g,Y=/<%([\s\S]+?)%>/g,J=/<%=([\s\S]+?)%>/g,Q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,X=/^\w*$/,Z=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ee=/[\\^$.*+?()[\]{}|]/g,te=RegExp(ee.source),re=/^\s+/,ne=/\s/,ie=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,se=/\{\n\/\* \[wrapped with (.+)\] \*/,oe=/,? & /,ae=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ce=/[()=,{}\[\]\/\s]/,ue=/\\(\\)?/g,he=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,le=/\w*$/,fe=/^[-+]0x[0-9a-f]+$/i,pe=/^0b[01]+$/i,de=/^\[object .+?Constructor\]$/,ge=/^0o[0-7]+$/i,ye=/^(?:0|[1-9]\d*)$/,ve=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,me=/($^)/,be=/['\n\r\u2028\u2029\\]/g,_e="\\ud800-\\udfff",we="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ee="\\u2700-\\u27bf",Se="a-z\\xdf-\\xf6\\xf8-\\xff",Ie="A-Z\\xc0-\\xd6\\xd8-\\xde",Oe="\\ufe0e\\ufe0f",Pe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ae="['â€™]",Ne="["+_e+"]",Te="["+Pe+"]",xe="["+we+"]",Re="\\d+",je="["+Ee+"]",Ce="["+Se+"]",Ue="[^"+_e+Pe+Re+Ee+Se+Ie+"]",Le="\\ud83c[\\udffb-\\udfff]",Me="[^"+_e+"]",De="(?:\\ud83c[\\udde6-\\uddff]){2}",ke="[\\ud800-\\udbff][\\udc00-\\udfff]",$e="["+Ie+"]",ze="\\u200d",qe="(?:"+Ce+"|"+Ue+")",He="(?:"+$e+"|"+Ue+")",Ke="(?:['â€™](?:d|ll|m|re|s|t|ve))?",Be="(?:['â€™](?:D|LL|M|RE|S|T|VE))?",Ve="(?:"+xe+"|"+Le+")?",Fe="["+Oe+"]?",We=Fe+Ve+"(?:"+ze+"(?:"+[Me,De,ke].join("|")+")"+Fe+Ve+")*",Ge="(?:"+[je,De,ke].join("|")+")"+We,Ye="(?:"+[Me+xe+"?",xe,De,ke,Ne].join("|")+")",Je=RegExp(Ae,"g"),Qe=RegExp(xe,"g"),Xe=RegExp(Le+"(?="+Le+")|"+Ye+We,"g"),Ze=RegExp([$e+"?"+Ce+"+"+Ke+"(?="+[Te,$e,"$"].join("|")+")",He+"+"+Be+"(?="+[Te,$e+qe,"$"].join("|")+")",$e+"?"+qe+"+"+Ke,$e+"+"+Be,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Re,Ge].join("|"),"g"),et=RegExp("["+ze+_e+we+Oe+"]"),tt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,rt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],nt=-1,it={};it[j]=it[C]=it[U]=it[L]=it[M]=it[D]=it[k]=it[$]=it[z]=!0,it[d]=it[g]=it[x]=it[y]=it[R]=it[v]=it[m]=it[b]=it[w]=it[E]=it[S]=it[O]=it[P]=it[A]=it[T]=!1;var st={};st[d]=st[g]=st[x]=st[R]=st[y]=st[v]=st[j]=st[C]=st[U]=st[L]=st[M]=st[w]=st[E]=st[S]=st[O]=st[P]=st[A]=st[N]=st[D]=st[k]=st[$]=st[z]=!0,st[m]=st[b]=st[T]=!1;var ot={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},at=parseFloat,ct=parseInt,ut="object"==typeof oh&&oh&&oh.Object===Object&&oh,ht="object"==typeof self&&self&&self.Object===Object&&self,lt=ut||ht||Function("return this")(),ft=sh&&!sh.nodeType&&sh,pt=ft&&ih&&!ih.nodeType&&ih,dt=pt&&pt.exports===ft,gt=dt&&ut.process,yt=function(){try{return pt&&pt.require&&pt.require("util").types||gt&&gt.binding&&gt.binding("util")}catch{}}(),vt=yt&&yt.isArrayBuffer,mt=yt&&yt.isDate,bt=yt&&yt.isMap,_t=yt&&yt.isRegExp,wt=yt&&yt.isSet,Et=yt&&yt.isTypedArray;function St(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function It(e,t,r,n){for(var i=-1,s=null==e?0:e.length;++i<s;){var o=e[i];t(n,o,r(o),e)}return n}function Ot(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}function Pt(e,t){for(var r=null==e?0:e.length;r--&&!1!==t(e[r],r,e););return e}function At(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}function Nt(e,t){for(var r=-1,n=null==e?0:e.length,i=0,s=[];++r<n;){var o=e[r];t(o,r,e)&&(s[i++]=o)}return s}function Tt(e,t){return!(null==e||!e.length)&&$t(e,t,0)>-1}function xt(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}function Rt(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}function jt(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}function Ct(e,t,r,n){var i=-1,s=null==e?0:e.length;for(n&&s&&(r=e[++i]);++i<s;)r=t(r,e[i],i,e);return r}function Ut(e,t,r,n){var i=null==e?0:e.length;for(n&&i&&(r=e[--i]);i--;)r=t(r,e[i],i,e);return r}function Lt(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var Mt=Kt("length");function Dt(e,t,r){var n;return r(e,(function(e,r,i){if(t(e,r,i))return n=r,!1})),n}function kt(e,t,r,n){for(var i=e.length,s=r+(n?1:-1);n?s--:++s<i;)if(t(e[s],s,e))return s;return-1}function $t(e,t,r){return t==t?function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}(e,t,r):kt(e,qt,r)}function zt(e,t,r,n){for(var i=r-1,s=e.length;++i<s;)if(n(e[i],t))return i;return-1}function qt(e){return e!=e}function Ht(e,t){var r=null==e?0:e.length;return r?Ft(e,t)/r:u}function Kt(t){return function(r){return null==r?e:r[t]}}function Bt(t){return function(r){return null==t?e:t[r]}}function Vt(e,t,r,n,i){return i(e,(function(e,i,s){r=n?(n=!1,e):t(r,e,i,s)})),r}function Ft(t,r){for(var n,i=-1,s=t.length;++i<s;){var o=r(t[i]);o!==e&&(n=n===e?o:n+o)}return n}function Wt(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function Gt(e){return e&&e.slice(0,hr(e)+1).replace(re,"")}function Yt(e){return function(t){return e(t)}}function Jt(e,t){return Rt(t,(function(t){return e[t]}))}function Qt(e,t){return e.has(t)}function Xt(e,t){for(var r=-1,n=e.length;++r<n&&$t(t,e[r],0)>-1;);return r}function Zt(e,t){for(var r=e.length;r--&&$t(t,e[r],0)>-1;);return r}var er=Bt({"Ã€":"A","Ã":"A","Ã‚":"A","Ãƒ":"A","Ã„":"A","Ã…":"A","Ã ":"a","Ã¡":"a","Ã¢":"a","Ã£":"a","Ã¤":"a","Ã¥":"a","Ã‡":"C","Ã§":"c","Ã":"D","Ã°":"d","Ãˆ":"E","Ã‰":"E","ÃŠ":"E","Ã‹":"E","Ã¨":"e","Ã©":"e","Ãª":"e","Ã«":"e","ÃŒ":"I","Ã":"I","ÃŽ":"I","Ã":"I","Ã¬":"i","Ã­":"i","Ã®":"i","Ã¯":"i","Ã‘":"N","Ã±":"n","Ã’":"O","Ã“":"O","Ã”":"O","Ã•":"O","Ã–":"O","Ã˜":"O","Ã²":"o","Ã³":"o","Ã´":"o","Ãµ":"o","Ã¶":"o","Ã¸":"o","Ã™":"U","Ãš":"U","Ã›":"U","Ãœ":"U","Ã¹":"u","Ãº":"u","Ã»":"u","Ã¼":"u","Ã":"Y","Ã½":"y","Ã¿":"y","Ã†":"Ae","Ã¦":"ae","Ãž":"Th","Ã¾":"th","ÃŸ":"ss","Ä€":"A","Ä‚":"A","Ä„":"A","Ä":"a","Äƒ":"a","Ä…":"a","Ä†":"C","Äˆ":"C","ÄŠ":"C","ÄŒ":"C","Ä‡":"c","Ä‰":"c","Ä‹":"c","Ä":"c","ÄŽ":"D","Ä":"D","Ä":"d","Ä‘":"d","Ä’":"E","Ä”":"E","Ä–":"E","Ä˜":"E","Äš":"E","Ä“":"e","Ä•":"e","Ä—":"e","Ä™":"e","Ä›":"e","Äœ":"G","Äž":"G","Ä ":"G","Ä¢":"G","Ä":"g","ÄŸ":"g","Ä¡":"g","Ä£":"g","Ä¤":"H","Ä¦":"H","Ä¥":"h","Ä§":"h","Ä¨":"I","Äª":"I","Ä¬":"I","Ä®":"I","Ä°":"I","Ä©":"i","Ä«":"i","Ä­":"i","Ä¯":"i","Ä±":"i","Ä´":"J","Äµ":"j","Ä¶":"K","Ä·":"k","Ä¸":"k","Ä¹":"L","Ä»":"L","Ä½":"L","Ä¿":"L","Å":"L","Äº":"l","Ä¼":"l","Ä¾":"l","Å€":"l","Å‚":"l","Åƒ":"N","Å…":"N","Å‡":"N","ÅŠ":"N","Å„":"n","Å†":"n","Åˆ":"n","Å‹":"n","ÅŒ":"O","ÅŽ":"O","Å":"O","Å":"o","Å":"o","Å‘":"o","Å”":"R","Å–":"R","Å˜":"R","Å•":"r","Å—":"r","Å™":"r","Åš":"S","Åœ":"S","Åž":"S","Å ":"S","Å›":"s","Å":"s","ÅŸ":"s","Å¡":"s","Å¢":"T","Å¤":"T","Å¦":"T","Å£":"t","Å¥":"t","Å§":"t","Å¨":"U","Åª":"U","Å¬":"U","Å®":"U","Å°":"U","Å²":"U","Å©":"u","Å«":"u","Å­":"u","Å¯":"u","Å±":"u","Å³":"u","Å´":"W","Åµ":"w","Å¶":"Y","Å·":"y","Å¸":"Y","Å¹":"Z","Å»":"Z","Å½":"Z","Åº":"z","Å¼":"z","Å¾":"z","Ä²":"IJ","Ä³":"ij","Å’":"Oe","Å“":"oe","Å‰":"'n","Å¿":"s"}),tr=Bt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function rr(e){return"\\"+ot[e]}function nr(e){return et.test(e)}function ir(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function sr(e,t){return function(r){return e(t(r))}}function or(e,t){for(var r=-1,i=e.length,s=0,o=[];++r<i;){var a=e[r];(a===t||a===n)&&(e[r]=n,o[s++]=r)}return o}function ar(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}function cr(e){return nr(e)?function(e){for(var t=Xe.lastIndex=0;Xe.test(e);)++t;return t}(e):Mt(e)}function ur(e){return nr(e)?function(e){return e.match(Xe)||[]}(e):function(e){return e.split("")}(e)}function hr(e){for(var t=e.length;t--&&ne.test(e.charAt(t)););return t}var lr=Bt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),fr=function ne(_e){var we,Ee=(_e=null==_e?lt:fr.defaults(lt.Object(),_e,fr.pick(lt,rt))).Array,Se=_e.Date,Ie=_e.Error,Oe=_e.Function,Pe=_e.Math,Ae=_e.Object,Ne=_e.RegExp,Te=_e.String,xe=_e.TypeError,Re=Ee.prototype,je=Oe.prototype,Ce=Ae.prototype,Ue=_e["__core-js_shared__"],Le=je.toString,Me=Ce.hasOwnProperty,De=0,ke=(we=/[^.]+$/.exec(Ue&&Ue.keys&&Ue.keys.IE_PROTO||""))?"Symbol(src)_1."+we:"",$e=Ce.toString,ze=Le.call(Ae),qe=lt._,He=Ne("^"+Le.call(Me).replace(ee,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ke=dt?_e.Buffer:e,Be=_e.Symbol,Ve=_e.Uint8Array,Fe=Ke?Ke.allocUnsafe:e,We=sr(Ae.getPrototypeOf,Ae),Ge=Ae.create,Ye=Ce.propertyIsEnumerable,Xe=Re.splice,et=Be?Be.isConcatSpreadable:e,ot=Be?Be.iterator:e,ut=Be?Be.toStringTag:e,ht=function(){try{var e=ls(Ae,"defineProperty");return e({},"",{}),e}catch{}}(),ft=_e.clearTimeout!==lt.clearTimeout&&_e.clearTimeout,pt=Se&&Se.now!==lt.Date.now&&Se.now,gt=_e.setTimeout!==lt.setTimeout&&_e.setTimeout,yt=Pe.ceil,Mt=Pe.floor,Bt=Ae.getOwnPropertySymbols,pr=Ke?Ke.isBuffer:e,dr=_e.isFinite,gr=Re.join,yr=sr(Ae.keys,Ae),vr=Pe.max,mr=Pe.min,br=Se.now,_r=_e.parseInt,wr=Pe.random,Er=Re.reverse,Sr=ls(_e,"DataView"),Ir=ls(_e,"Map"),Or=ls(_e,"Promise"),Pr=ls(_e,"Set"),Ar=ls(_e,"WeakMap"),Nr=ls(Ae,"create"),Tr=Ar&&new Ar,xr={},Rr=Ds(Sr),jr=Ds(Ir),Cr=Ds(Or),Ur=Ds(Pr),Lr=Ds(Ar),Mr=Be?Be.prototype:e,Dr=Mr?Mr.valueOf:e,kr=Mr?Mr.toString:e;function $r(e){if(ta(e)&&!Bo(e)&&!(e instanceof Kr)){if(e instanceof Hr)return e;if(Me.call(e,"__wrapped__"))return ks(e)}return new Hr(e)}var zr=function(){function t(){}return function(r){if(!ea(r))return{};if(Ge)return Ge(r);t.prototype=r;var n=new t;return t.prototype=e,n}}();function qr(){}function Hr(t,r){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!r,this.__index__=0,this.__values__=e}function Kr(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=h,this.__views__=[]}function Br(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Vr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Fr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Wr(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Fr;++t<r;)this.add(e[t])}function Gr(e){var t=this.__data__=new Vr(e);this.size=t.size}function Yr(e,t){var r=Bo(e),n=!r&&Ko(e),i=!r&&!n&&Go(e),s=!r&&!n&&!i&&ua(e),o=r||n||i||s,a=o?Wt(e.length,Te):[],c=a.length;for(var u in e)(t||Me.call(e,u))&&(!o||!("length"==u||i&&("offset"==u||"parent"==u)||s&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ms(u,c)))&&a.push(u);return a}function Jr(t){var r=t.length;return r?t[Gn(0,r-1)]:e}function Qr(e,t){return Us(Ti(e),an(t,0,e.length))}function Xr(e){return Us(Ti(e))}function Zr(t,r,n){(n!==e&&!zo(t[r],n)||n===e&&!(r in t))&&sn(t,r,n)}function en(t,r,n){var i=t[r];(!Me.call(t,r)||!zo(i,n)||n===e&&!(r in t))&&sn(t,r,n)}function tn(e,t){for(var r=e.length;r--;)if(zo(e[r][0],t))return r;return-1}function rn(e,t,r,n){return fn(e,(function(e,i,s){t(n,e,r(e),s)})),n}function nn(e,t){return e&&xi(t,Ra(t),e)}function sn(e,t,r){"__proto__"==t&&ht?ht(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function on(t,r){for(var n=-1,i=r.length,s=Ee(i),o=null==t;++n<i;)s[n]=o?e:Pa(t,r[n]);return s}function an(t,r,n){return t==t&&(n!==e&&(t=t<=n?t:n),r!==e&&(t=t>=r?t:r)),t}function cn(t,r,n,i,s,o){var a,c=1&r,u=2&r,h=4&r;if(n&&(a=s?n(t,i,s,o):n(t)),a!==e)return a;if(!ea(t))return t;var l=Bo(t);if(l){if(a=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&Me.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(t),!c)return Ti(t,a)}else{var f=ds(t),p=f==b||f==_;if(Go(t))return Si(t,c);if(f==S||f==d||p&&!s){if(a=u||p?{}:ys(t),!c)return u?function(e,t){return xi(e,ps(e),t)}(t,function(e,t){return e&&xi(t,ja(t),e)}(a,t)):function(e,t){return xi(e,fs(e),t)}(t,nn(a,t))}else{if(!st[f])return s?t:{};a=function(e,t,r){var n=e.constructor;switch(t){case x:return Ii(e);case y:case v:return new n(+e);case R:return function(e,t){var r=t?Ii(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case j:case C:case U:case L:case M:case D:case k:case $:case z:return Oi(e,r);case w:return new n;case E:case A:return new n(e);case O:return function(e){var t=new e.constructor(e.source,le.exec(e));return t.lastIndex=e.lastIndex,t}(e);case P:return new n;case N:return function(e){return Dr?Ae(Dr.call(e)):{}}(e)}}(t,f,c)}}o||(o=new Gr);var g=o.get(t);if(g)return g;o.set(t,a),oa(t)?t.forEach((function(e){a.add(cn(e,r,n,e,t,o))})):ra(t)&&t.forEach((function(e,i){a.set(i,cn(e,r,n,i,t,o))}));var m=l?e:(h?u?is:ns:u?ja:Ra)(t);return Ot(m||t,(function(e,i){m&&(e=t[i=e]),en(a,i,cn(e,r,n,i,t,o))})),a}function un(t,r,n){var i=n.length;if(null==t)return!i;for(t=Ae(t);i--;){var s=n[i],o=r[s],a=t[s];if(a===e&&!(s in t)||!o(a))return!1}return!0}function hn(r,n,i){if("function"!=typeof r)throw new xe(t);return xs((function(){r.apply(e,i)}),n)}function ln(e,t,r,n){var i=-1,s=Tt,o=!0,a=e.length,c=[],u=t.length;if(!a)return c;r&&(t=Rt(t,Yt(r))),n?(s=xt,o=!1):t.length>=200&&(s=Qt,o=!1,t=new Wr(t));e:for(;++i<a;){var h=e[i],l=null==r?h:r(h);if(h=n||0!==h?h:0,o&&l==l){for(var f=u;f--;)if(t[f]===l)continue e;c.push(h)}else s(t,l,n)||c.push(h)}return c}$r.templateSettings={escape:G,evaluate:Y,interpolate:J,variable:"",imports:{_:$r}},$r.prototype=qr.prototype,$r.prototype.constructor=$r,Hr.prototype=zr(qr.prototype),Hr.prototype.constructor=Hr,Kr.prototype=zr(qr.prototype),Kr.prototype.constructor=Kr,Br.prototype.clear=function(){this.__data__=Nr?Nr(null):{},this.size=0},Br.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Br.prototype.get=function(t){var n=this.__data__;if(Nr){var i=n[t];return i===r?e:i}return Me.call(n,t)?n[t]:e},Br.prototype.has=function(t){var r=this.__data__;return Nr?r[t]!==e:Me.call(r,t)},Br.prototype.set=function(t,n){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=Nr&&n===e?r:n,this},Vr.prototype.clear=function(){this.__data__=[],this.size=0},Vr.prototype.delete=function(e){var t=this.__data__,r=tn(t,e);return!(r<0||(r==t.length-1?t.pop():Xe.call(t,r,1),--this.size,0))},Vr.prototype.get=function(t){var r=this.__data__,n=tn(r,t);return n<0?e:r[n][1]},Vr.prototype.has=function(e){return tn(this.__data__,e)>-1},Vr.prototype.set=function(e,t){var r=this.__data__,n=tn(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},Fr.prototype.clear=function(){this.size=0,this.__data__={hash:new Br,map:new(Ir||Vr),string:new Br}},Fr.prototype.delete=function(e){var t=us(this,e).delete(e);return this.size-=t?1:0,t},Fr.prototype.get=function(e){return us(this,e).get(e)},Fr.prototype.has=function(e){return us(this,e).has(e)},Fr.prototype.set=function(e,t){var r=us(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},Wr.prototype.add=Wr.prototype.push=function(e){return this.__data__.set(e,r),this},Wr.prototype.has=function(e){return this.__data__.has(e)},Gr.prototype.clear=function(){this.__data__=new Vr,this.size=0},Gr.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},Gr.prototype.get=function(e){return this.__data__.get(e)},Gr.prototype.has=function(e){return this.__data__.has(e)},Gr.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Vr){var n=r.__data__;if(!Ir||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Fr(n)}return r.set(e,t),this.size=r.size,this};var fn=Ci(_n),pn=Ci(wn,!0);function dn(e,t){var r=!0;return fn(e,(function(e,n,i){return r=!!t(e,n,i)})),r}function gn(t,r,n){for(var i=-1,s=t.length;++i<s;){var o=t[i],a=r(o);if(null!=a&&(c===e?a==a&&!ca(a):n(a,c)))var c=a,u=o}return u}function yn(e,t){var r=[];return fn(e,(function(e,n,i){t(e,n,i)&&r.push(e)})),r}function vn(e,t,r,n,i){var s=-1,o=e.length;for(r||(r=vs),i||(i=[]);++s<o;){var a=e[s];t>0&&r(a)?t>1?vn(a,t-1,r,n,i):jt(i,a):n||(i[i.length]=a)}return i}var mn=Ui(),bn=Ui(!0);function _n(e,t){return e&&mn(e,t,Ra)}function wn(e,t){return e&&bn(e,t,Ra)}function En(e,t){return Nt(t,(function(t){return Qo(e[t])}))}function Sn(t,r){for(var n=0,i=(r=bi(r,t)).length;null!=t&&n<i;)t=t[Ms(r[n++])];return n&&n==i?t:e}function In(e,t,r){var n=t(e);return Bo(e)?n:jt(n,r(e))}function On(t){return null==t?t===e?"[object Undefined]":"[object Null]":ut&&ut in Ae(t)?function(t){var r=Me.call(t,ut),n=t[ut];try{t[ut]=e;var i=!0}catch{}var s=$e.call(t);return i&&(r?t[ut]=n:delete t[ut]),s}(t):function(e){return $e.call(e)}(t)}function Pn(e,t){return e>t}function An(e,t){return null!=e&&Me.call(e,t)}function Nn(e,t){return null!=e&&t in Ae(e)}function Tn(t,r,n){for(var i=n?xt:Tt,s=t[0].length,o=t.length,a=o,c=Ee(o),u=1/0,h=[];a--;){var l=t[a];a&&r&&(l=Rt(l,Yt(r))),u=mr(l.length,u),c[a]=!n&&(r||s>=120&&l.length>=120)?new Wr(a&&l):e}l=t[0];var f=-1,p=c[0];e:for(;++f<s&&h.length<u;){var d=l[f],g=r?r(d):d;if(d=n||0!==d?d:0,!(p?Qt(p,g):i(h,g,n))){for(a=o;--a;){var y=c[a];if(!(y?Qt(y,g):i(t[a],g,n)))continue e}p&&p.push(g),h.push(d)}}return h}function xn(t,r,n){var i=null==(t=As(t,r=bi(r,t)))?t:t[Ms(Ys(r))];return null==i?e:St(i,t,n)}function Rn(e){return ta(e)&&On(e)==d}function jn(t,r,n,i,s){return t===r||(null==t||null==r||!ta(t)&&!ta(r)?t!=t&&r!=r:function(t,r,n,i,s,o){var a=Bo(t),c=Bo(r),u=a?g:ds(t),h=c?g:ds(r),l=(u=u==d?S:u)==S,f=(h=h==d?S:h)==S,p=u==h;if(p&&Go(t)){if(!Go(r))return!1;a=!0,l=!1}if(p&&!l)return o||(o=new Gr),a||ua(t)?ts(t,r,n,i,s,o):function(e,t,r,n,i,s,o){switch(r){case R:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case x:return!(e.byteLength!=t.byteLength||!s(new Ve(e),new Ve(t)));case y:case v:case E:return zo(+e,+t);case m:return e.name==t.name&&e.message==t.message;case O:case A:return e==t+"";case w:var a=ir;case P:var c=1&n;if(a||(a=ar),e.size!=t.size&&!c)return!1;var u=o.get(e);if(u)return u==t;n|=2,o.set(e,t);var h=ts(a(e),a(t),n,i,s,o);return o.delete(e),h;case N:if(Dr)return Dr.call(e)==Dr.call(t)}return!1}(t,r,u,n,i,s,o);if(!(1&n)){var b=l&&Me.call(t,"__wrapped__"),_=f&&Me.call(r,"__wrapped__");if(b||_){var I=b?t.value():t,T=_?r.value():r;return o||(o=new Gr),s(I,T,n,i,o)}}return!!p&&(o||(o=new Gr),function(t,r,n,i,s,o){var a=1&n,c=ns(t),u=c.length,h=ns(r),l=h.length;if(u!=l&&!a)return!1;for(var f=u;f--;){var p=c[f];if(!(a?p in r:Me.call(r,p)))return!1}var d=o.get(t),g=o.get(r);if(d&&g)return d==r&&g==t;var y=!0;o.set(t,r),o.set(r,t);for(var v=a;++f<u;){var m=t[p=c[f]],b=r[p];if(i)var _=a?i(b,m,p,r,t,o):i(m,b,p,t,r,o);if(!(_===e?m===b||s(m,b,n,i,o):_)){y=!1;break}v||(v="constructor"==p)}if(y&&!v){var w=t.constructor,E=r.constructor;w!=E&&"constructor"in t&&"constructor"in r&&!("function"==typeof w&&w instanceof w&&"function"==typeof E&&E instanceof E)&&(y=!1)}return o.delete(t),o.delete(r),y}(t,r,n,i,s,o))}(t,r,n,i,jn,s))}function Cn(t,r,n,i){var s=n.length,o=s,a=!i;if(null==t)return!o;for(t=Ae(t);s--;){var c=n[s];if(a&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++s<o;){var u=(c=n[s])[0],h=t[u],l=c[1];if(a&&c[2]){if(h===e&&!(u in t))return!1}else{var f=new Gr;if(i)var p=i(h,l,u,t,r,f);if(!(p===e?jn(l,h,3,i,f):p))return!1}}return!0}function Un(e){return!(!ea(e)||function(e){return!!ke&&ke in e}(e))&&(Qo(e)?He:de).test(Ds(e))}function Ln(e){return"function"==typeof e?e:null==e?nc:"object"==typeof e?Bo(e)?qn(e[0],e[1]):zn(e):fc(e)}function Mn(e){if(!Ss(e))return yr(e);var t=[];for(var r in Ae(e))Me.call(e,r)&&"constructor"!=r&&t.push(r);return t}function Dn(e){if(!ea(e))return function(e){var t=[];if(null!=e)for(var r in Ae(e))t.push(r);return t}(e);var t=Ss(e),r=[];for(var n in e)"constructor"==n&&(t||!Me.call(e,n))||r.push(n);return r}function kn(e,t){return e<t}function $n(e,t){var r=-1,n=Fo(e)?Ee(e.length):[];return fn(e,(function(e,i,s){n[++r]=t(e,i,s)})),n}function zn(e){var t=hs(e);return 1==t.length&&t[0][2]?Os(t[0][0],t[0][1]):function(r){return r===e||Cn(r,e,t)}}function qn(t,r){return _s(t)&&Is(r)?Os(Ms(t),r):function(n){var i=Pa(n,t);return i===e&&i===r?Aa(n,t):jn(r,i,3)}}function Hn(t,r,n,i,s){t!==r&&mn(r,(function(o,a){if(s||(s=new Gr),ea(o))!function(t,r,n,i,s,o,a){var c=Ns(t,n),u=Ns(r,n),h=a.get(u);if(h)Zr(t,n,h);else{var l=o?o(c,u,n+"",t,r,a):e,f=l===e;if(f){var p=Bo(u),d=!p&&Go(u),g=!p&&!d&&ua(u);l=u,p||d||g?Bo(c)?l=c:Wo(c)?l=Ti(c):d?(f=!1,l=Si(u,!0)):g?(f=!1,l=Oi(u,!0)):l=[]:ia(u)||Ko(u)?(l=c,Ko(c)?l=va(c):(!ea(c)||Qo(c))&&(l=ys(u))):f=!1}f&&(a.set(u,l),s(l,u,i,o,a),a.delete(u)),Zr(t,n,l)}}(t,r,a,n,Hn,i,s);else{var c=i?i(Ns(t,a),o,a+"",t,r,s):e;c===e&&(c=o),Zr(t,a,c)}}),ja)}function Kn(t,r){var n=t.length;if(n)return ms(r+=r<0?n:0,n)?t[r]:e}function Bn(e,t,r){t=t.length?Rt(t,(function(e){return Bo(e)?function(t){return Sn(t,1===e.length?e[0]:e)}:e})):[nc];var n=-1;return t=Rt(t,Yt(cs())),function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}($n(e,(function(e,r,i){return{criteria:Rt(t,(function(t){return t(e)})),index:++n,value:e}})),(function(e,t){return function(e,t,r){for(var n=-1,i=e.criteria,s=t.criteria,o=i.length,a=r.length;++n<o;){var c=Pi(i[n],s[n]);if(c)return n>=a?c:c*("desc"==r[n]?-1:1)}return e.index-t.index}(e,t,r)}))}function Vn(e,t,r){for(var n=-1,i=t.length,s={};++n<i;){var o=t[n],a=Sn(e,o);r(a,o)&&Zn(s,bi(o,e),a)}return s}function Fn(e,t,r,n){var i=n?zt:$t,s=-1,o=t.length,a=e;for(e===t&&(t=Ti(t)),r&&(a=Rt(e,Yt(r)));++s<o;)for(var c=0,u=t[s],h=r?r(u):u;(c=i(a,h,c,n))>-1;)a!==e&&Xe.call(a,c,1),Xe.call(e,c,1);return e}function Wn(e,t){for(var r=e?t.length:0,n=r-1;r--;){var i=t[r];if(r==n||i!==s){var s=i;ms(i)?Xe.call(e,i,1):li(e,i)}}return e}function Gn(e,t){return e+Mt(wr()*(t-e+1))}function Yn(e,t){var r="";if(!e||t<1||t>c)return r;do{t%2&&(r+=e),(t=Mt(t/2))&&(e+=e)}while(t);return r}function Jn(e,t){return Rs(Ps(e,t,nc),e+"")}function Qn(e){return Jr(za(e))}function Xn(e,t){var r=za(e);return Us(r,an(t,0,r.length))}function Zn(t,r,n,i){if(!ea(t))return t;for(var s=-1,o=(r=bi(r,t)).length,a=o-1,c=t;null!=c&&++s<o;){var u=Ms(r[s]),h=n;if("__proto__"===u||"constructor"===u||"prototype"===u)return t;if(s!=a){var l=c[u];(h=i?i(l,u,c):e)===e&&(h=ea(l)?l:ms(r[s+1])?[]:{})}en(c,u,h),c=c[u]}return t}var ei=Tr?function(e,t){return Tr.set(e,t),e}:nc,ti=ht?function(e,t){return ht(e,"toString",{configurable:!0,enumerable:!1,value:ec(t),writable:!0})}:nc;function ri(e){return Us(za(e))}function ni(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var s=Ee(i);++n<i;)s[n]=e[n+t];return s}function ii(e,t){var r;return fn(e,(function(e,n,i){return!(r=t(e,n,i))})),!!r}function si(e,t,r){var n=0,i=null==e?n:e.length;if("number"==typeof t&&t==t&&i<=f){for(;n<i;){var s=n+i>>>1,o=e[s];null!==o&&!ca(o)&&(r?o<=t:o<t)?n=s+1:i=s}return i}return oi(e,t,nc,r)}function oi(t,r,n,i){var s=0,o=null==t?0:t.length;if(0===o)return 0;for(var a=(r=n(r))!=r,c=null===r,u=ca(r),h=r===e;s<o;){var f=Mt((s+o)/2),p=n(t[f]),d=p!==e,g=null===p,y=p==p,v=ca(p);if(a)var m=i||y;else m=h?y&&(i||d):c?y&&d&&(i||!g):u?y&&d&&!g&&(i||!v):!g&&!v&&(i?p<=r:p<r);m?s=f+1:o=f}return mr(o,l)}function ai(e,t){for(var r=-1,n=e.length,i=0,s=[];++r<n;){var o=e[r],a=t?t(o):o;if(!r||!zo(a,c)){var c=a;s[i++]=0===o?0:o}}return s}function ci(e){return"number"==typeof e?e:ca(e)?u:+e}function ui(e){if("string"==typeof e)return e;if(Bo(e))return Rt(e,ui)+"";if(ca(e))return kr?kr.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function hi(e,t,r){var n=-1,i=Tt,s=e.length,o=!0,a=[],c=a;if(r)o=!1,i=xt;else if(s>=200){var u=t?null:Yi(e);if(u)return ar(u);o=!1,i=Qt,c=new Wr}else c=t?[]:a;e:for(;++n<s;){var h=e[n],l=t?t(h):h;if(h=r||0!==h?h:0,o&&l==l){for(var f=c.length;f--;)if(c[f]===l)continue e;t&&c.push(l),a.push(h)}else i(c,l,r)||(c!==a&&c.push(l),a.push(h))}return a}function li(e,t){return null==(e=As(e,t=bi(t,e)))||delete e[Ms(Ys(t))]}function fi(e,t,r,n){return Zn(e,t,r(Sn(e,t)),n)}function pi(e,t,r,n){for(var i=e.length,s=n?i:-1;(n?s--:++s<i)&&t(e[s],s,e););return r?ni(e,n?0:s,n?s+1:i):ni(e,n?s+1:0,n?i:s)}function di(e,t){var r=e;return r instanceof Kr&&(r=r.value()),Ct(t,(function(e,t){return t.func.apply(t.thisArg,jt([e],t.args))}),r)}function gi(e,t,r){var n=e.length;if(n<2)return n?hi(e[0]):[];for(var i=-1,s=Ee(n);++i<n;)for(var o=e[i],a=-1;++a<n;)a!=i&&(s[i]=ln(s[i]||o,e[a],t,r));return hi(vn(s,1),t,r)}function yi(t,r,n){for(var i=-1,s=t.length,o=r.length,a={};++i<s;){var c=i<o?r[i]:e;n(a,t[i],c)}return a}function vi(e){return Wo(e)?e:[]}function mi(e){return"function"==typeof e?e:nc}function bi(e,t){return Bo(e)?e:_s(e,t)?[e]:Ls(ma(e))}var _i=Jn;function wi(t,r,n){var i=t.length;return n=n===e?i:n,!r&&n>=i?t:ni(t,r,n)}var Ei=ft||function(e){return lt.clearTimeout(e)};function Si(e,t){if(t)return e.slice();var r=e.length,n=Fe?Fe(r):new e.constructor(r);return e.copy(n),n}function Ii(e){var t=new e.constructor(e.byteLength);return new Ve(t).set(new Ve(e)),t}function Oi(e,t){var r=t?Ii(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function Pi(t,r){if(t!==r){var n=t!==e,i=null===t,s=t==t,o=ca(t),a=r!==e,c=null===r,u=r==r,h=ca(r);if(!c&&!h&&!o&&t>r||o&&a&&u&&!c&&!h||i&&a&&u||!n&&u||!s)return 1;if(!i&&!o&&!h&&t<r||h&&n&&s&&!i&&!o||c&&n&&s||!a&&s||!u)return-1}return 0}function Ai(e,t,r,n){for(var i=-1,s=e.length,o=r.length,a=-1,c=t.length,u=vr(s-o,0),h=Ee(c+u),l=!n;++a<c;)h[a]=t[a];for(;++i<o;)(l||i<s)&&(h[r[i]]=e[i]);for(;u--;)h[a++]=e[i++];return h}function Ni(e,t,r,n){for(var i=-1,s=e.length,o=-1,a=r.length,c=-1,u=t.length,h=vr(s-a,0),l=Ee(h+u),f=!n;++i<h;)l[i]=e[i];for(var p=i;++c<u;)l[p+c]=t[c];for(;++o<a;)(f||i<s)&&(l[p+r[o]]=e[i++]);return l}function Ti(e,t){var r=-1,n=e.length;for(t||(t=Ee(n));++r<n;)t[r]=e[r];return t}function xi(t,r,n,i){var s=!n;n||(n={});for(var o=-1,a=r.length;++o<a;){var c=r[o],u=i?i(n[c],t[c],c,n,t):e;u===e&&(u=t[c]),s?sn(n,c,u):en(n,c,u)}return n}function Ri(e,t){return function(r,n){var i=Bo(r)?It:rn,s=t?t():{};return i(r,e,cs(n,2),s)}}function ji(t){return Jn((function(r,n){var i=-1,s=n.length,o=s>1?n[s-1]:e,a=s>2?n[2]:e;for(o=t.length>3&&"function"==typeof o?(s--,o):e,a&&bs(n[0],n[1],a)&&(o=s<3?e:o,s=1),r=Ae(r);++i<s;){var c=n[i];c&&t(r,c,i,o)}return r}))}function Ci(e,t){return function(r,n){if(null==r)return r;if(!Fo(r))return e(r,n);for(var i=r.length,s=t?i:-1,o=Ae(r);(t?s--:++s<i)&&!1!==n(o[s],s,o););return r}}function Ui(e){return function(t,r,n){for(var i=-1,s=Ae(t),o=n(t),a=o.length;a--;){var c=o[e?a:++i];if(!1===r(s[c],c,s))break}return t}}function Li(t){return function(r){var n=nr(r=ma(r))?ur(r):e,i=n?n[0]:r.charAt(0),s=n?wi(n,1).join(""):r.slice(1);return i[t]()+s}}function Mi(e){return function(t){return Ct(Qa(Ka(t).replace(Je,"")),e,"")}}function Di(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=zr(e.prototype),n=e.apply(r,t);return ea(n)?n:r}}function ki(t){return function(r,n,i){var s=Ae(r);if(!Fo(r)){var o=cs(n,3);r=Ra(r),n=function(e){return o(s[e],e,s)}}var a=t(r,n,i);return a>-1?s[o?r[a]:a]:e}}function $i(r){return rs((function(n){var i=n.length,s=i,o=Hr.prototype.thru;for(r&&n.reverse();s--;){var a=n[s];if("function"!=typeof a)throw new xe(t);if(o&&!c&&"wrapper"==os(a))var c=new Hr([],!0)}for(s=c?s:i;++s<i;){var u=os(a=n[s]),h="wrapper"==u?ss(a):e;c=h&&ws(h[0])&&424==h[1]&&!h[4].length&&1==h[9]?c[os(h[0])].apply(c,h[3]):1==a.length&&ws(a)?c[u]():c.thru(a)}return function(){var e=arguments,t=e[0];if(c&&1==e.length&&Bo(t))return c.plant(t).value();for(var r=0,s=i?n[r].apply(this,e):t;++r<i;)s=n[r].call(this,s);return s}}))}function zi(t,r,n,i,o,a,c,u,h,l){var f=r&s,p=1&r,d=2&r,g=24&r,y=512&r,v=d?e:Di(t);return function s(){for(var m=arguments.length,b=Ee(m),_=m;_--;)b[_]=arguments[_];if(g)var w=as(s),E=function(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n}(b,w);if(i&&(b=Ai(b,i,o,g)),a&&(b=Ni(b,a,c,g)),m-=E,g&&m<l){var S=or(b,w);return Wi(t,r,zi,s.placeholder,n,b,S,u,h,l-m)}var I=p?n:this,O=d?I[t]:t;return m=b.length,u?b=function(t,r){for(var n=t.length,i=mr(r.length,n),s=Ti(t);i--;){var o=r[i];t[i]=ms(o,n)?s[o]:e}return t}(b,u):y&&m>1&&b.reverse(),f&&h<m&&(b.length=h),this&&this!==lt&&this instanceof s&&(O=v||Di(O)),O.apply(I,b)}}function qi(e,t){return function(r,n){return function(e,t,r,n){return _n(e,(function(e,i,s){t(n,r(e),i,s)})),n}(r,e,t(n),{})}}function Hi(t,r){return function(n,i){var s;if(n===e&&i===e)return r;if(n!==e&&(s=n),i!==e){if(s===e)return i;"string"==typeof n||"string"==typeof i?(n=ui(n),i=ui(i)):(n=ci(n),i=ci(i)),s=t(n,i)}return s}}function Ki(e){return rs((function(t){return t=Rt(t,Yt(cs())),Jn((function(r){var n=this;return e(t,(function(e){return St(e,n,r)}))}))}))}function Bi(t,r){var n=(r=r===e?" ":ui(r)).length;if(n<2)return n?Yn(r,t):r;var i=Yn(r,yt(t/cr(r)));return nr(r)?wi(ur(i),0,t).join(""):i.slice(0,t)}function Vi(t){return function(r,n,i){return i&&"number"!=typeof i&&bs(r,n,i)&&(n=i=e),r=pa(r),n===e?(n=r,r=0):n=pa(n),function(e,t,r,n){for(var i=-1,s=vr(yt((t-e)/(r||1)),0),o=Ee(s);s--;)o[n?s:++i]=e,e+=r;return o}(r,n,i=i===e?r<n?1:-1:pa(i),t)}}function Fi(e){return function(t,r){return"string"==typeof t&&"string"==typeof r||(t=ya(t),r=ya(r)),e(t,r)}}function Wi(t,r,n,s,o,a,c,u,h,l){var f=8&r;r|=f?i:64,4&(r&=~(f?64:i))||(r&=-4);var p=[t,r,o,f?a:e,f?c:e,f?e:a,f?e:c,u,h,l],d=n.apply(e,p);return ws(t)&&Ts(d,p),d.placeholder=s,js(d,t,r)}function Gi(e){var t=Pe[e];return function(e,r){if(e=ya(e),(r=null==r?0:mr(da(r),292))&&dr(e)){var n=(ma(e)+"e").split("e");return+((n=(ma(t(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return t(e)}}var Yi=Pr&&1/ar(new Pr([,-0]))[1]==a?function(e){return new Pr(e)}:cc;function Ji(e){return function(t){var r=ds(t);return r==w?ir(t):r==P?function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=[e,e]})),r}(t):function(e,t){return Rt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Qi(r,a,c,u,h,l,f,p){var d=2&a;if(!d&&"function"!=typeof r)throw new xe(t);var g=u?u.length:0;if(g||(a&=-97,u=h=e),f=f===e?f:vr(da(f),0),p=p===e?p:da(p),g-=h?h.length:0,64&a){var y=u,v=h;u=h=e}var m=d?e:ss(r),b=[r,a,c,u,h,y,v,l,f,p];if(m&&function(e,t){var r=e[1],i=t[1],a=r|i,c=a<131,u=i==s&&8==r||i==s&&r==o&&e[7].length<=t[8]||384==i&&t[7].length<=t[8]&&8==r;if(!c&&!u)return e;1&i&&(e[2]=t[2],a|=1&r?0:4);var h=t[3];if(h){var l=e[3];e[3]=l?Ai(l,h,t[4]):h,e[4]=l?or(e[3],n):t[4]}(h=t[5])&&(l=e[5],e[5]=l?Ni(l,h,t[6]):h,e[6]=l?or(e[5],n):t[6]),(h=t[7])&&(e[7]=h),i&s&&(e[8]=null==e[8]?t[8]:mr(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=a}(b,m),r=b[0],a=b[1],c=b[2],u=b[3],h=b[4],!(p=b[9]=b[9]===e?d?0:r.length:vr(b[9]-g,0))&&24&a&&(a&=-25),a&&1!=a)_=8==a||16==a?function(t,r,n){var i=Di(t);return function s(){for(var o=arguments.length,a=Ee(o),c=o,u=as(s);c--;)a[c]=arguments[c];var h=o<3&&a[0]!==u&&a[o-1]!==u?[]:or(a,u);return(o-=h.length)<n?Wi(t,r,zi,s.placeholder,e,a,h,e,e,n-o):St(this&&this!==lt&&this instanceof s?i:t,this,a)}}(r,a,p):a!=i&&33!=a||h.length?zi.apply(e,b):function(e,t,r,n){var i=1&t,s=Di(e);return function t(){for(var o=-1,a=arguments.length,c=-1,u=n.length,h=Ee(u+a),l=this&&this!==lt&&this instanceof t?s:e;++c<u;)h[c]=n[c];for(;a--;)h[c++]=arguments[++o];return St(l,i?r:this,h)}}(r,a,c,u);else var _=function(e,t,r){var n=1&t,i=Di(e);return function t(){return(this&&this!==lt&&this instanceof t?i:e).apply(n?r:this,arguments)}}(r,a,c);return js((m?ei:Ts)(_,b),r,a)}function Xi(t,r,n,i){return t===e||zo(t,Ce[n])&&!Me.call(i,n)?r:t}function Zi(t,r,n,i,s,o){return ea(t)&&ea(r)&&(o.set(r,t),Hn(t,r,e,Zi,o),o.delete(r)),t}function es(t){return ia(t)?e:t}function ts(t,r,n,i,s,o){var a=1&n,c=t.length,u=r.length;if(c!=u&&!(a&&u>c))return!1;var h=o.get(t),l=o.get(r);if(h&&l)return h==r&&l==t;var f=-1,p=!0,d=2&n?new Wr:e;for(o.set(t,r),o.set(r,t);++f<c;){var g=t[f],y=r[f];if(i)var v=a?i(y,g,f,r,t,o):i(g,y,f,t,r,o);if(v!==e){if(v)continue;p=!1;break}if(d){if(!Lt(r,(function(e,t){if(!Qt(d,t)&&(g===e||s(g,e,n,i,o)))return d.push(t)}))){p=!1;break}}else if(g!==y&&!s(g,y,n,i,o)){p=!1;break}}return o.delete(t),o.delete(r),p}function rs(t){return Rs(Ps(t,e,Bs),t+"")}function ns(e){return In(e,Ra,fs)}function is(e){return In(e,ja,ps)}var ss=Tr?function(e){return Tr.get(e)}:cc;function os(e){for(var t=e.name+"",r=xr[t],n=Me.call(xr,t)?r.length:0;n--;){var i=r[n],s=i.func;if(null==s||s==e)return i.name}return t}function as(e){return(Me.call($r,"placeholder")?$r:e).placeholder}function cs(){var e=$r.iteratee||ic;return e=e===ic?Ln:e,arguments.length?e(arguments[0],arguments[1]):e}function us(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map}function hs(e){for(var t=Ra(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,Is(i)]}return t}function ls(t,r){var n=function(t,r){return null==t?e:t[r]}(t,r);return Un(n)?n:e}var fs=Bt?function(e){return null==e?[]:(e=Ae(e),Nt(Bt(e),(function(t){return Ye.call(e,t)})))}:gc,ps=Bt?function(e){for(var t=[];e;)jt(t,fs(e)),e=We(e);return t}:gc,ds=On;function gs(e,t,r){for(var n=-1,i=(t=bi(t,e)).length,s=!1;++n<i;){var o=Ms(t[n]);if(!(s=null!=e&&r(e,o)))break;e=e[o]}return s||++n!=i?s:!!(i=null==e?0:e.length)&&Zo(i)&&ms(o,i)&&(Bo(e)||Ko(e))}function ys(e){return"function"!=typeof e.constructor||Ss(e)?{}:zr(We(e))}function vs(e){return Bo(e)||Ko(e)||!!(et&&e&&e[et])}function ms(e,t){var r=typeof e;return!!(t=t??c)&&("number"==r||"symbol"!=r&&ye.test(e))&&e>-1&&e%1==0&&e<t}function bs(e,t,r){if(!ea(r))return!1;var n=typeof t;return!!("number"==n?Fo(r)&&ms(t,r.length):"string"==n&&t in r)&&zo(r[t],e)}function _s(e,t){if(Bo(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!ca(e))||X.test(e)||!Q.test(e)||null!=t&&e in Ae(t)}function ws(e){var t=os(e),r=$r[t];if("function"!=typeof r||!(t in Kr.prototype))return!1;if(e===r)return!0;var n=ss(r);return!!n&&e===n[0]}(Sr&&ds(new Sr(new ArrayBuffer(1)))!=R||Ir&&ds(new Ir)!=w||Or&&ds(Or.resolve())!=I||Pr&&ds(new Pr)!=P||Ar&&ds(new Ar)!=T)&&(ds=function(t){var r=On(t),n=r==S?t.constructor:e,i=n?Ds(n):"";if(i)switch(i){case Rr:return R;case jr:return w;case Cr:return I;case Ur:return P;case Lr:return T}return r});var Es=Ue?Qo:yc;function Ss(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ce)}function Is(e){return e==e&&!ea(e)}function Os(t,r){return function(n){return null!=n&&n[t]===r&&(r!==e||t in Ae(n))}}function Ps(t,r,n){return r=vr(r===e?t.length-1:r,0),function(){for(var e=arguments,i=-1,s=vr(e.length-r,0),o=Ee(s);++i<s;)o[i]=e[r+i];i=-1;for(var a=Ee(r+1);++i<r;)a[i]=e[i];return a[r]=n(o),St(t,this,a)}}function As(e,t){return t.length<2?e:Sn(e,ni(t,0,-1))}function Ns(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Ts=Cs(ei),xs=gt||function(e,t){return lt.setTimeout(e,t)},Rs=Cs(ti);function js(e,t,r){var n=t+"";return Rs(e,function(e,t){var r=t.length;if(!r)return e;var n=r-1;return t[n]=(r>1?"& ":"")+t[n],t=t.join(r>2?", ":" "),e.replace(ie,"{\n/* [wrapped with "+t+"] */\n")}(n,function(e,t){return Ot(p,(function(r){var n="_."+r[0];t&r[1]&&!Tt(e,n)&&e.push(n)})),e.sort()}(function(e){var t=e.match(se);return t?t[1].split(oe):[]}(n),r)))}function Cs(t){var r=0,n=0;return function(){var i=br(),s=16-(i-n);if(n=i,s>0){if(++r>=800)return arguments[0]}else r=0;return t.apply(e,arguments)}}function Us(t,r){var n=-1,i=t.length,s=i-1;for(r=r===e?i:r;++n<r;){var o=Gn(n,s),a=t[o];t[o]=t[n],t[n]=a}return t.length=r,t}var Ls=function(e){var t=Uo(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Z,(function(e,r,n,i){t.push(n?i.replace(ue,"$1"):r||e)})),t}));function Ms(e){if("string"==typeof e||ca(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Ds(e){if(null!=e){try{return Le.call(e)}catch{}try{return e+""}catch{}}return""}function ks(e){if(e instanceof Kr)return e.clone();var t=new Hr(e.__wrapped__,e.__chain__);return t.__actions__=Ti(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var $s=Jn((function(e,t){return Wo(e)?ln(e,vn(t,1,Wo,!0)):[]})),zs=Jn((function(t,r){var n=Ys(r);return Wo(n)&&(n=e),Wo(t)?ln(t,vn(r,1,Wo,!0),cs(n,2)):[]})),qs=Jn((function(t,r){var n=Ys(r);return Wo(n)&&(n=e),Wo(t)?ln(t,vn(r,1,Wo,!0),e,n):[]}));function Hs(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:da(r);return i<0&&(i=vr(n+i,0)),kt(e,cs(t,3),i)}function Ks(t,r,n){var i=null==t?0:t.length;if(!i)return-1;var s=i-1;return n!==e&&(s=da(n),s=n<0?vr(i+s,0):mr(s,i-1)),kt(t,cs(r,3),s,!0)}function Bs(e){return null!=e&&e.length?vn(e,1):[]}function Vs(t){return t&&t.length?t[0]:e}var Fs=Jn((function(e){var t=Rt(e,vi);return t.length&&t[0]===e[0]?Tn(t):[]})),Ws=Jn((function(t){var r=Ys(t),n=Rt(t,vi);return r===Ys(n)?r=e:n.pop(),n.length&&n[0]===t[0]?Tn(n,cs(r,2)):[]})),Gs=Jn((function(t){var r=Ys(t),n=Rt(t,vi);return(r="function"==typeof r?r:e)&&n.pop(),n.length&&n[0]===t[0]?Tn(n,e,r):[]}));function Ys(t){var r=null==t?0:t.length;return r?t[r-1]:e}var Js=Jn(Qs);function Qs(e,t){return e&&e.length&&t&&t.length?Fn(e,t):e}var Xs=rs((function(e,t){var r=null==e?0:e.length,n=on(e,t);return Wn(e,Rt(t,(function(e){return ms(e,r)?+e:e})).sort(Pi)),n}));function Zs(e){return null==e?e:Er.call(e)}var eo=Jn((function(e){return hi(vn(e,1,Wo,!0))})),to=Jn((function(t){var r=Ys(t);return Wo(r)&&(r=e),hi(vn(t,1,Wo,!0),cs(r,2))})),ro=Jn((function(t){var r=Ys(t);return r="function"==typeof r?r:e,hi(vn(t,1,Wo,!0),e,r)}));function no(e){if(!e||!e.length)return[];var t=0;return e=Nt(e,(function(e){if(Wo(e))return t=vr(e.length,t),!0})),Wt(t,(function(t){return Rt(e,Kt(t))}))}function io(t,r){if(!t||!t.length)return[];var n=no(t);return null==r?n:Rt(n,(function(t){return St(r,e,t)}))}var so=Jn((function(e,t){return Wo(e)?ln(e,t):[]})),oo=Jn((function(e){return gi(Nt(e,Wo))})),ao=Jn((function(t){var r=Ys(t);return Wo(r)&&(r=e),gi(Nt(t,Wo),cs(r,2))})),co=Jn((function(t){var r=Ys(t);return r="function"==typeof r?r:e,gi(Nt(t,Wo),e,r)})),uo=Jn(no),ho=Jn((function(t){var r=t.length,n=r>1?t[r-1]:e;return n="function"==typeof n?(t.pop(),n):e,io(t,n)}));function lo(e){var t=$r(e);return t.__chain__=!0,t}function fo(e,t){return t(e)}var po=rs((function(t){var r=t.length,n=r?t[0]:0,i=this.__wrapped__,s=function(e){return on(e,t)};return!(r>1||this.__actions__.length)&&i instanceof Kr&&ms(n)?((i=i.slice(n,+n+(r?1:0))).__actions__.push({func:fo,args:[s],thisArg:e}),new Hr(i,this.__chain__).thru((function(t){return r&&!t.length&&t.push(e),t}))):this.thru(s)})),go=Ri((function(e,t,r){Me.call(e,r)?++e[r]:sn(e,r,1)})),yo=ki(Hs),vo=ki(Ks);function mo(e,t){return(Bo(e)?Ot:fn)(e,cs(t,3))}function bo(e,t){return(Bo(e)?Pt:pn)(e,cs(t,3))}var _o=Ri((function(e,t,r){Me.call(e,r)?e[r].push(t):sn(e,r,[t])})),wo=Jn((function(e,t,r){var n=-1,i="function"==typeof t,s=Fo(e)?Ee(e.length):[];return fn(e,(function(e){s[++n]=i?St(t,e,r):xn(e,t,r)})),s})),Eo=Ri((function(e,t,r){sn(e,r,t)}));function So(e,t){return(Bo(e)?Rt:$n)(e,cs(t,3))}var Io=Ri((function(e,t,r){e[r?0:1].push(t)}),(function(){return[[],[]]})),Oo=Jn((function(e,t){if(null==e)return[];var r=t.length;return r>1&&bs(e,t[0],t[1])?t=[]:r>2&&bs(t[0],t[1],t[2])&&(t=[t[0]]),Bn(e,vn(t,1),[])})),Po=pt||function(){return lt.Date.now()};function Ao(t,r,n){return r=n?e:r,r=t&&null==r?t.length:r,Qi(t,s,e,e,e,e,r)}function No(r,n){var i;if("function"!=typeof n)throw new xe(t);return r=da(r),function(){return--r>0&&(i=n.apply(this,arguments)),r<=1&&(n=e),i}}var To=Jn((function(e,t,r){var n=1;if(r.length){var s=or(r,as(To));n|=i}return Qi(e,n,t,r,s)})),xo=Jn((function(e,t,r){var n=3;if(r.length){var s=or(r,as(xo));n|=i}return Qi(t,n,e,r,s)}));function Ro(r,n,i){var s,o,a,c,u,h,l=0,f=!1,p=!1,d=!0;if("function"!=typeof r)throw new xe(t);function g(t){var n=s,i=o;return s=o=e,l=t,c=r.apply(i,n)}function y(t){var r=t-h;return h===e||r>=n||r<0||p&&t-l>=a}function v(){var e=Po();if(y(e))return m(e);u=xs(v,function(e){var t=n-(e-h);return p?mr(t,a-(e-l)):t}(e))}function m(t){return u=e,d&&s?g(t):(s=o=e,c)}function b(){var t=Po(),r=y(t);if(s=arguments,o=this,h=t,r){if(u===e)return function(e){return l=e,u=xs(v,n),f?g(e):c}(h);if(p)return Ei(u),u=xs(v,n),g(h)}return u===e&&(u=xs(v,n)),c}return n=ya(n)||0,ea(i)&&(f=!!i.leading,a=(p="maxWait"in i)?vr(ya(i.maxWait)||0,n):a,d="trailing"in i?!!i.trailing:d),b.cancel=function(){u!==e&&Ei(u),l=0,s=h=o=u=e},b.flush=function(){return u===e?c:m(Po())},b}var jo=Jn((function(e,t){return hn(e,1,t)})),Co=Jn((function(e,t,r){return hn(e,ya(t)||0,r)}));function Uo(e,r){if("function"!=typeof e||null!=r&&"function"!=typeof r)throw new xe(t);var n=function(){var t=arguments,i=r?r.apply(this,t):t[0],s=n.cache;if(s.has(i))return s.get(i);var o=e.apply(this,t);return n.cache=s.set(i,o)||s,o};return n.cache=new(Uo.Cache||Fr),n}function Lo(e){if("function"!=typeof e)throw new xe(t);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Uo.Cache=Fr;var Mo=_i((function(e,t){var r=(t=1==t.length&&Bo(t[0])?Rt(t[0],Yt(cs())):Rt(vn(t,1),Yt(cs()))).length;return Jn((function(n){for(var i=-1,s=mr(n.length,r);++i<s;)n[i]=t[i].call(this,n[i]);return St(e,this,n)}))})),Do=Jn((function(t,r){var n=or(r,as(Do));return Qi(t,i,e,r,n)})),ko=Jn((function(t,r){var n=or(r,as(ko));return Qi(t,64,e,r,n)})),$o=rs((function(t,r){return Qi(t,o,e,e,e,r)}));function zo(e,t){return e===t||e!=e&&t!=t}var qo=Fi(Pn),Ho=Fi((function(e,t){return e>=t})),Ko=Rn(function(){return arguments}())?Rn:function(e){return ta(e)&&Me.call(e,"callee")&&!Ye.call(e,"callee")},Bo=Ee.isArray,Vo=vt?Yt(vt):function(e){return ta(e)&&On(e)==x};function Fo(e){return null!=e&&Zo(e.length)&&!Qo(e)}function Wo(e){return ta(e)&&Fo(e)}var Go=pr||yc,Yo=mt?Yt(mt):function(e){return ta(e)&&On(e)==v};function Jo(e){if(!ta(e))return!1;var t=On(e);return t==m||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!ia(e)}function Qo(e){if(!ea(e))return!1;var t=On(e);return t==b||t==_||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Xo(e){return"number"==typeof e&&e==da(e)}function Zo(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=c}function ea(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ta(e){return null!=e&&"object"==typeof e}var ra=bt?Yt(bt):function(e){return ta(e)&&ds(e)==w};function na(e){return"number"==typeof e||ta(e)&&On(e)==E}function ia(e){if(!ta(e)||On(e)!=S)return!1;var t=We(e);if(null===t)return!0;var r=Me.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Le.call(r)==ze}var sa=_t?Yt(_t):function(e){return ta(e)&&On(e)==O},oa=wt?Yt(wt):function(e){return ta(e)&&ds(e)==P};function aa(e){return"string"==typeof e||!Bo(e)&&ta(e)&&On(e)==A}function ca(e){return"symbol"==typeof e||ta(e)&&On(e)==N}var ua=Et?Yt(Et):function(e){return ta(e)&&Zo(e.length)&&!!it[On(e)]},ha=Fi(kn),la=Fi((function(e,t){return e<=t}));function fa(e){if(!e)return[];if(Fo(e))return aa(e)?ur(e):Ti(e);if(ot&&e[ot])return function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}(e[ot]());var t=ds(e);return(t==w?ir:t==P?ar:za)(e)}function pa(e){return e?(e=ya(e))===a||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function da(e){var t=pa(e),r=t%1;return t==t?r?t-r:t:0}function ga(e){return e?an(da(e),0,h):0}function ya(e){if("number"==typeof e)return e;if(ca(e))return u;if(ea(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ea(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Gt(e);var r=pe.test(e);return r||ge.test(e)?ct(e.slice(2),r?2:8):fe.test(e)?u:+e}function va(e){return xi(e,ja(e))}function ma(e){return null==e?"":ui(e)}var ba=ji((function(e,t){if(Ss(t)||Fo(t))xi(t,Ra(t),e);else for(var r in t)Me.call(t,r)&&en(e,r,t[r])})),_a=ji((function(e,t){xi(t,ja(t),e)})),wa=ji((function(e,t,r,n){xi(t,ja(t),e,n)})),Ea=ji((function(e,t,r,n){xi(t,Ra(t),e,n)})),Sa=rs(on),Ia=Jn((function(t,r){t=Ae(t);var n=-1,i=r.length,s=i>2?r[2]:e;for(s&&bs(r[0],r[1],s)&&(i=1);++n<i;)for(var o=r[n],a=ja(o),c=-1,u=a.length;++c<u;){var h=a[c],l=t[h];(l===e||zo(l,Ce[h])&&!Me.call(t,h))&&(t[h]=o[h])}return t})),Oa=Jn((function(t){return t.push(e,Zi),St(Ua,e,t)}));function Pa(t,r,n){var i=null==t?e:Sn(t,r);return i===e?n:i}function Aa(e,t){return null!=e&&gs(e,t,Nn)}var Na=qi((function(e,t,r){null!=t&&"function"!=typeof t.toString&&(t=$e.call(t)),e[t]=r}),ec(nc)),Ta=qi((function(e,t,r){null!=t&&"function"!=typeof t.toString&&(t=$e.call(t)),Me.call(e,t)?e[t].push(r):e[t]=[r]}),cs),xa=Jn(xn);function Ra(e){return Fo(e)?Yr(e):Mn(e)}function ja(e){return Fo(e)?Yr(e,!0):Dn(e)}var Ca=ji((function(e,t,r){Hn(e,t,r)})),Ua=ji((function(e,t,r,n){Hn(e,t,r,n)})),La=rs((function(e,t){var r={};if(null==e)return r;var n=!1;t=Rt(t,(function(t){return t=bi(t,e),n||(n=t.length>1),t})),xi(e,is(e),r),n&&(r=cn(r,7,es));for(var i=t.length;i--;)li(r,t[i]);return r})),Ma=rs((function(e,t){return null==e?{}:function(e,t){return Vn(e,t,(function(t,r){return Aa(e,r)}))}(e,t)}));function Da(e,t){if(null==e)return{};var r=Rt(is(e),(function(e){return[e]}));return t=cs(t),Vn(e,r,(function(e,r){return t(e,r[0])}))}var ka=Ji(Ra),$a=Ji(ja);function za(e){return null==e?[]:Jt(e,Ra(e))}var qa=Mi((function(e,t,r){return t=t.toLowerCase(),e+(r?Ha(t):t)}));function Ha(e){return Ja(ma(e).toLowerCase())}function Ka(e){return(e=ma(e))&&e.replace(ve,er).replace(Qe,"")}var Ba=Mi((function(e,t,r){return e+(r?"-":"")+t.toLowerCase()})),Va=Mi((function(e,t,r){return e+(r?" ":"")+t.toLowerCase()})),Fa=Li("toLowerCase"),Wa=Mi((function(e,t,r){return e+(r?"_":"")+t.toLowerCase()})),Ga=Mi((function(e,t,r){return e+(r?" ":"")+Ja(t)})),Ya=Mi((function(e,t,r){return e+(r?" ":"")+t.toUpperCase()})),Ja=Li("toUpperCase");function Qa(t,r,n){return t=ma(t),(r=n?e:r)===e?function(e){return tt.test(e)}(t)?function(e){return e.match(Ze)||[]}(t):function(e){return e.match(ae)||[]}(t):t.match(r)||[]}var Xa=Jn((function(t,r){try{return St(t,e,r)}catch(n){return Jo(n)?n:new Ie(n)}})),Za=rs((function(e,t){return Ot(t,(function(t){t=Ms(t),sn(e,t,To(e[t],e))})),e}));function ec(e){return function(){return e}}var tc=$i(),rc=$i(!0);function nc(e){return e}function ic(e){return Ln("function"==typeof e?e:cn(e,1))}var sc=Jn((function(e,t){return function(r){return xn(r,e,t)}})),oc=Jn((function(e,t){return function(r){return xn(e,r,t)}}));function ac(e,t,r){var n=Ra(t),i=En(t,n);null==r&&(!ea(t)||!i.length&&n.length)&&(r=t,t=e,e=this,i=En(t,Ra(t)));var s=!(ea(r)&&"chain"in r&&!r.chain),o=Qo(e);return Ot(i,(function(r){var n=t[r];e[r]=n,o&&(e.prototype[r]=function(){var t=this.__chain__;if(s||t){var r=e(this.__wrapped__);return(r.__actions__=Ti(this.__actions__)).push({func:n,args:arguments,thisArg:e}),r.__chain__=t,r}return n.apply(e,jt([this.value()],arguments))})})),e}function cc(){}var uc=Ki(Rt),hc=Ki(At),lc=Ki(Lt);function fc(e){return _s(e)?Kt(Ms(e)):function(e){return function(t){return Sn(t,e)}}(e)}var pc=Vi(),dc=Vi(!0);function gc(){return[]}function yc(){return!1}var vc=Hi((function(e,t){return e+t}),0),mc=Gi("ceil"),bc=Hi((function(e,t){return e/t}),1),_c=Gi("floor"),wc=Hi((function(e,t){return e*t}),1),Ec=Gi("round"),Sc=Hi((function(e,t){return e-t}),0);return $r.after=function(e,r){if("function"!=typeof r)throw new xe(t);return e=da(e),function(){if(--e<1)return r.apply(this,arguments)}},$r.ary=Ao,$r.assign=ba,$r.assignIn=_a,$r.assignInWith=wa,$r.assignWith=Ea,$r.at=Sa,$r.before=No,$r.bind=To,$r.bindAll=Za,$r.bindKey=xo,$r.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Bo(e)?e:[e]},$r.chain=lo,$r.chunk=function(t,r,n){r=(n?bs(t,r,n):r===e)?1:vr(da(r),0);var i=null==t?0:t.length;if(!i||r<1)return[];for(var s=0,o=0,a=Ee(yt(i/r));s<i;)a[o++]=ni(t,s,s+=r);return a},$r.compact=function(e){for(var t=-1,r=null==e?0:e.length,n=0,i=[];++t<r;){var s=e[t];s&&(i[n++]=s)}return i},$r.concat=function(){var e=arguments.length;if(!e)return[];for(var t=Ee(e-1),r=arguments[0],n=e;n--;)t[n-1]=arguments[n];return jt(Bo(r)?Ti(r):[r],vn(t,1))},$r.cond=function(e){var r=null==e?0:e.length,n=cs();return e=r?Rt(e,(function(e){if("function"!=typeof e[1])throw new xe(t);return[n(e[0]),e[1]]})):[],Jn((function(t){for(var n=-1;++n<r;){var i=e[n];if(St(i[0],this,t))return St(i[1],this,t)}}))},$r.conforms=function(e){return function(e){var t=Ra(e);return function(r){return un(r,e,t)}}(cn(e,1))},$r.constant=ec,$r.countBy=go,$r.create=function(e,t){var r=zr(e);return null==t?r:nn(r,t)},$r.curry=function t(r,n,i){var s=Qi(r,8,e,e,e,e,e,n=i?e:n);return s.placeholder=t.placeholder,s},$r.curryRight=function t(r,n,i){var s=Qi(r,16,e,e,e,e,e,n=i?e:n);return s.placeholder=t.placeholder,s},$r.debounce=Ro,$r.defaults=Ia,$r.defaultsDeep=Oa,$r.defer=jo,$r.delay=Co,$r.difference=$s,$r.differenceBy=zs,$r.differenceWith=qs,$r.drop=function(t,r,n){var i=null==t?0:t.length;return i?ni(t,(r=n||r===e?1:da(r))<0?0:r,i):[]},$r.dropRight=function(t,r,n){var i=null==t?0:t.length;return i?ni(t,0,(r=i-(r=n||r===e?1:da(r)))<0?0:r):[]},$r.dropRightWhile=function(e,t){return e&&e.length?pi(e,cs(t,3),!0,!0):[]},$r.dropWhile=function(e,t){return e&&e.length?pi(e,cs(t,3),!0):[]},$r.fill=function(t,r,n,i){var s=null==t?0:t.length;return s?(n&&"number"!=typeof n&&bs(t,r,n)&&(n=0,i=s),function(t,r,n,i){var s=t.length;for((n=da(n))<0&&(n=-n>s?0:s+n),(i=i===e||i>s?s:da(i))<0&&(i+=s),i=n>i?0:ga(i);n<i;)t[n++]=r;return t}(t,r,n,i)):[]},$r.filter=function(e,t){return(Bo(e)?Nt:yn)(e,cs(t,3))},$r.flatMap=function(e,t){return vn(So(e,t),1)},$r.flatMapDeep=function(e,t){return vn(So(e,t),a)},$r.flatMapDepth=function(t,r,n){return n=n===e?1:da(n),vn(So(t,r),n)},$r.flatten=Bs,$r.flattenDeep=function(e){return null!=e&&e.length?vn(e,a):[]},$r.flattenDepth=function(t,r){return null!=t&&t.length?vn(t,r=r===e?1:da(r)):[]},$r.flip=function(e){return Qi(e,512)},$r.flow=tc,$r.flowRight=rc,$r.fromPairs=function(e){for(var t=-1,r=null==e?0:e.length,n={};++t<r;){var i=e[t];n[i[0]]=i[1]}return n},$r.functions=function(e){return null==e?[]:En(e,Ra(e))},$r.functionsIn=function(e){return null==e?[]:En(e,ja(e))},$r.groupBy=_o,$r.initial=function(e){return null!=e&&e.length?ni(e,0,-1):[]},$r.intersection=Fs,$r.intersectionBy=Ws,$r.intersectionWith=Gs,$r.invert=Na,$r.invertBy=Ta,$r.invokeMap=wo,$r.iteratee=ic,$r.keyBy=Eo,$r.keys=Ra,$r.keysIn=ja,$r.map=So,$r.mapKeys=function(e,t){var r={};return t=cs(t,3),_n(e,(function(e,n,i){sn(r,t(e,n,i),e)})),r},$r.mapValues=function(e,t){var r={};return t=cs(t,3),_n(e,(function(e,n,i){sn(r,n,t(e,n,i))})),r},$r.matches=function(e){return zn(cn(e,1))},$r.matchesProperty=function(e,t){return qn(e,cn(t,1))},$r.memoize=Uo,$r.merge=Ca,$r.mergeWith=Ua,$r.method=sc,$r.methodOf=oc,$r.mixin=ac,$r.negate=Lo,$r.nthArg=function(e){return e=da(e),Jn((function(t){return Kn(t,e)}))},$r.omit=La,$r.omitBy=function(e,t){return Da(e,Lo(cs(t)))},$r.once=function(e){return No(2,e)},$r.orderBy=function(t,r,n,i){return null==t?[]:(Bo(r)||(r=null==r?[]:[r]),Bo(n=i?e:n)||(n=null==n?[]:[n]),Bn(t,r,n))},$r.over=uc,$r.overArgs=Mo,$r.overEvery=hc,$r.overSome=lc,$r.partial=Do,$r.partialRight=ko,$r.partition=Io,$r.pick=Ma,$r.pickBy=Da,$r.property=fc,$r.propertyOf=function(t){return function(r){return null==t?e:Sn(t,r)}},$r.pull=Js,$r.pullAll=Qs,$r.pullAllBy=function(e,t,r){return e&&e.length&&t&&t.length?Fn(e,t,cs(r,2)):e},$r.pullAllWith=function(t,r,n){return t&&t.length&&r&&r.length?Fn(t,r,e,n):t},$r.pullAt=Xs,$r.range=pc,$r.rangeRight=dc,$r.rearg=$o,$r.reject=function(e,t){return(Bo(e)?Nt:yn)(e,Lo(cs(t,3)))},$r.remove=function(e,t){var r=[];if(!e||!e.length)return r;var n=-1,i=[],s=e.length;for(t=cs(t,3);++n<s;){var o=e[n];t(o,n,e)&&(r.push(o),i.push(n))}return Wn(e,i),r},$r.rest=function(r,n){if("function"!=typeof r)throw new xe(t);return Jn(r,n=n===e?n:da(n))},$r.reverse=Zs,$r.sampleSize=function(t,r,n){return r=(n?bs(t,r,n):r===e)?1:da(r),(Bo(t)?Qr:Xn)(t,r)},$r.set=function(e,t,r){return null==e?e:Zn(e,t,r)},$r.setWith=function(t,r,n,i){return i="function"==typeof i?i:e,null==t?t:Zn(t,r,n,i)},$r.shuffle=function(e){return(Bo(e)?Xr:ri)(e)},$r.slice=function(t,r,n){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&bs(t,r,n)?(r=0,n=i):(r=null==r?0:da(r),n=n===e?i:da(n)),ni(t,r,n)):[]},$r.sortBy=Oo,$r.sortedUniq=function(e){return e&&e.length?ai(e):[]},$r.sortedUniqBy=function(e,t){return e&&e.length?ai(e,cs(t,2)):[]},$r.split=function(t,r,n){return n&&"number"!=typeof n&&bs(t,r,n)&&(r=n=e),(n=n===e?h:n>>>0)?(t=ma(t))&&("string"==typeof r||null!=r&&!sa(r))&&!(r=ui(r))&&nr(t)?wi(ur(t),0,n):t.split(r,n):[]},$r.spread=function(e,r){if("function"!=typeof e)throw new xe(t);return r=null==r?0:vr(da(r),0),Jn((function(t){var n=t[r],i=wi(t,0,r);return n&&jt(i,n),St(e,this,i)}))},$r.tail=function(e){var t=null==e?0:e.length;return t?ni(e,1,t):[]},$r.take=function(t,r,n){return t&&t.length?ni(t,0,(r=n||r===e?1:da(r))<0?0:r):[]},$r.takeRight=function(t,r,n){var i=null==t?0:t.length;return i?ni(t,(r=i-(r=n||r===e?1:da(r)))<0?0:r,i):[]},$r.takeRightWhile=function(e,t){return e&&e.length?pi(e,cs(t,3),!1,!0):[]},$r.takeWhile=function(e,t){return e&&e.length?pi(e,cs(t,3)):[]},$r.tap=function(e,t){return t(e),e},$r.throttle=function(e,r,n){var i=!0,s=!0;if("function"!=typeof e)throw new xe(t);return ea(n)&&(i="leading"in n?!!n.leading:i,s="trailing"in n?!!n.trailing:s),Ro(e,r,{leading:i,maxWait:r,trailing:s})},$r.thru=fo,$r.toArray=fa,$r.toPairs=ka,$r.toPairsIn=$a,$r.toPath=function(e){return Bo(e)?Rt(e,Ms):ca(e)?[e]:Ti(Ls(ma(e)))},$r.toPlainObject=va,$r.transform=function(e,t,r){var n=Bo(e),i=n||Go(e)||ua(e);if(t=cs(t,4),null==r){var s=e&&e.constructor;r=i?n?new s:[]:ea(e)&&Qo(s)?zr(We(e)):{}}return(i?Ot:_n)(e,(function(e,n,i){return t(r,e,n,i)})),r},$r.unary=function(e){return Ao(e,1)},$r.union=eo,$r.unionBy=to,$r.unionWith=ro,$r.uniq=function(e){return e&&e.length?hi(e):[]},$r.uniqBy=function(e,t){return e&&e.length?hi(e,cs(t,2)):[]},$r.uniqWith=function(t,r){return r="function"==typeof r?r:e,t&&t.length?hi(t,e,r):[]},$r.unset=function(e,t){return null==e||li(e,t)},$r.unzip=no,$r.unzipWith=io,$r.update=function(e,t,r){return null==e?e:fi(e,t,mi(r))},$r.updateWith=function(t,r,n,i){return i="function"==typeof i?i:e,null==t?t:fi(t,r,mi(n),i)},$r.values=za,$r.valuesIn=function(e){return null==e?[]:Jt(e,ja(e))},$r.without=so,$r.words=Qa,$r.wrap=function(e,t){return Do(mi(t),e)},$r.xor=oo,$r.xorBy=ao,$r.xorWith=co,$r.zip=uo,$r.zipObject=function(e,t){return yi(e||[],t||[],en)},$r.zipObjectDeep=function(e,t){return yi(e||[],t||[],Zn)},$r.zipWith=ho,$r.entries=ka,$r.entriesIn=$a,$r.extend=_a,$r.extendWith=wa,ac($r,$r),$r.add=vc,$r.attempt=Xa,$r.camelCase=qa,$r.capitalize=Ha,$r.ceil=mc,$r.clamp=function(t,r,n){return n===e&&(n=r,r=e),n!==e&&(n=(n=ya(n))==n?n:0),r!==e&&(r=(r=ya(r))==r?r:0),an(ya(t),r,n)},$r.clone=function(e){return cn(e,4)},$r.cloneDeep=function(e){return cn(e,5)},$r.cloneDeepWith=function(t,r){return cn(t,5,r="function"==typeof r?r:e)},$r.cloneWith=function(t,r){return cn(t,4,r="function"==typeof r?r:e)},$r.conformsTo=function(e,t){return null==t||un(e,t,Ra(t))},$r.deburr=Ka,$r.defaultTo=function(e,t){return null==e||e!=e?t:e},$r.divide=bc,$r.endsWith=function(t,r,n){t=ma(t),r=ui(r);var i=t.length,s=n=n===e?i:an(da(n),0,i);return(n-=r.length)>=0&&t.slice(n,s)==r},$r.eq=zo,$r.escape=function(e){return(e=ma(e))&&W.test(e)?e.replace(V,tr):e},$r.escapeRegExp=function(e){return(e=ma(e))&&te.test(e)?e.replace(ee,"\\$&"):e},$r.every=function(t,r,n){var i=Bo(t)?At:dn;return n&&bs(t,r,n)&&(r=e),i(t,cs(r,3))},$r.find=yo,$r.findIndex=Hs,$r.findKey=function(e,t){return Dt(e,cs(t,3),_n)},$r.findLast=vo,$r.findLastIndex=Ks,$r.findLastKey=function(e,t){return Dt(e,cs(t,3),wn)},$r.floor=_c,$r.forEach=mo,$r.forEachRight=bo,$r.forIn=function(e,t){return null==e?e:mn(e,cs(t,3),ja)},$r.forInRight=function(e,t){return null==e?e:bn(e,cs(t,3),ja)},$r.forOwn=function(e,t){return e&&_n(e,cs(t,3))},$r.forOwnRight=function(e,t){return e&&wn(e,cs(t,3))},$r.get=Pa,$r.gt=qo,$r.gte=Ho,$r.has=function(e,t){return null!=e&&gs(e,t,An)},$r.hasIn=Aa,$r.head=Vs,$r.identity=nc,$r.includes=function(e,t,r,n){e=Fo(e)?e:za(e),r=r&&!n?da(r):0;var i=e.length;return r<0&&(r=vr(i+r,0)),aa(e)?r<=i&&e.indexOf(t,r)>-1:!!i&&$t(e,t,r)>-1},$r.indexOf=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:da(r);return i<0&&(i=vr(n+i,0)),$t(e,t,i)},$r.inRange=function(t,r,n){return r=pa(r),n===e?(n=r,r=0):n=pa(n),function(e,t,r){return e>=mr(t,r)&&e<vr(t,r)}(t=ya(t),r,n)},$r.invoke=xa,$r.isArguments=Ko,$r.isArray=Bo,$r.isArrayBuffer=Vo,$r.isArrayLike=Fo,$r.isArrayLikeObject=Wo,$r.isBoolean=function(e){return!0===e||!1===e||ta(e)&&On(e)==y},$r.isBuffer=Go,$r.isDate=Yo,$r.isElement=function(e){return ta(e)&&1===e.nodeType&&!ia(e)},$r.isEmpty=function(e){if(null==e)return!0;if(Fo(e)&&(Bo(e)||"string"==typeof e||"function"==typeof e.splice||Go(e)||ua(e)||Ko(e)))return!e.length;var t=ds(e);if(t==w||t==P)return!e.size;if(Ss(e))return!Mn(e).length;for(var r in e)if(Me.call(e,r))return!1;return!0},$r.isEqual=function(e,t){return jn(e,t)},$r.isEqualWith=function(t,r,n){var i=(n="function"==typeof n?n:e)?n(t,r):e;return i===e?jn(t,r,e,n):!!i},$r.isError=Jo,$r.isFinite=function(e){return"number"==typeof e&&dr(e)},$r.isFunction=Qo,$r.isInteger=Xo,$r.isLength=Zo,$r.isMap=ra,$r.isMatch=function(e,t){return e===t||Cn(e,t,hs(t))},$r.isMatchWith=function(t,r,n){return n="function"==typeof n?n:e,Cn(t,r,hs(r),n)},$r.isNaN=function(e){return na(e)&&e!=+e},$r.isNative=function(e){if(Es(e))throw new Ie("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Un(e)},$r.isNil=function(e){return null==e},$r.isNull=function(e){return null===e},$r.isNumber=na,$r.isObject=ea,$r.isObjectLike=ta,$r.isPlainObject=ia,$r.isRegExp=sa,$r.isSafeInteger=function(e){return Xo(e)&&e>=-9007199254740991&&e<=c},$r.isSet=oa,$r.isString=aa,$r.isSymbol=ca,$r.isTypedArray=ua,$r.isUndefined=function(t){return t===e},$r.isWeakMap=function(e){return ta(e)&&ds(e)==T},$r.isWeakSet=function(e){return ta(e)&&"[object WeakSet]"==On(e)},$r.join=function(e,t){return null==e?"":gr.call(e,t)},$r.kebabCase=Ba,$r.last=Ys,$r.lastIndexOf=function(t,r,n){var i=null==t?0:t.length;if(!i)return-1;var s=i;return n!==e&&(s=(s=da(n))<0?vr(i+s,0):mr(s,i-1)),r==r?function(e,t,r){for(var n=r+1;n--;)if(e[n]===t)return n;return n}(t,r,s):kt(t,qt,s,!0)},$r.lowerCase=Va,$r.lowerFirst=Fa,$r.lt=ha,$r.lte=la,$r.max=function(t){return t&&t.length?gn(t,nc,Pn):e},$r.maxBy=function(t,r){return t&&t.length?gn(t,cs(r,2),Pn):e},$r.mean=function(e){return Ht(e,nc)},$r.meanBy=function(e,t){return Ht(e,cs(t,2))},$r.min=function(t){return t&&t.length?gn(t,nc,kn):e},$r.minBy=function(t,r){return t&&t.length?gn(t,cs(r,2),kn):e},$r.stubArray=gc,$r.stubFalse=yc,$r.stubObject=function(){return{}},$r.stubString=function(){return""},$r.stubTrue=function(){return!0},$r.multiply=wc,$r.nth=function(t,r){return t&&t.length?Kn(t,da(r)):e},$r.noConflict=function(){return lt._===this&&(lt._=qe),this},$r.noop=cc,$r.now=Po,$r.pad=function(e,t,r){e=ma(e);var n=(t=da(t))?cr(e):0;if(!t||n>=t)return e;var i=(t-n)/2;return Bi(Mt(i),r)+e+Bi(yt(i),r)},$r.padEnd=function(e,t,r){e=ma(e);var n=(t=da(t))?cr(e):0;return t&&n<t?e+Bi(t-n,r):e},$r.padStart=function(e,t,r){e=ma(e);var n=(t=da(t))?cr(e):0;return t&&n<t?Bi(t-n,r)+e:e},$r.parseInt=function(e,t,r){return r||null==t?t=0:t&&(t=+t),_r(ma(e).replace(re,""),t||0)},$r.random=function(t,r,n){if(n&&"boolean"!=typeof n&&bs(t,r,n)&&(r=n=e),n===e&&("boolean"==typeof r?(n=r,r=e):"boolean"==typeof t&&(n=t,t=e)),t===e&&r===e?(t=0,r=1):(t=pa(t),r===e?(r=t,t=0):r=pa(r)),t>r){var i=t;t=r,r=i}if(n||t%1||r%1){var s=wr();return mr(t+s*(r-t+at("1e-"+((s+"").length-1))),r)}return Gn(t,r)},$r.reduce=function(e,t,r){var n=Bo(e)?Ct:Vt,i=arguments.length<3;return n(e,cs(t,4),r,i,fn)},$r.reduceRight=function(e,t,r){var n=Bo(e)?Ut:Vt,i=arguments.length<3;return n(e,cs(t,4),r,i,pn)},$r.repeat=function(t,r,n){return r=(n?bs(t,r,n):r===e)?1:da(r),Yn(ma(t),r)},$r.replace=function(){var e=arguments,t=ma(e[0]);return e.length<3?t:t.replace(e[1],e[2])},$r.result=function(t,r,n){var i=-1,s=(r=bi(r,t)).length;for(s||(s=1,t=e);++i<s;){var o=null==t?e:t[Ms(r[i])];o===e&&(i=s,o=n),t=Qo(o)?o.call(t):o}return t},$r.round=Ec,$r.runInContext=ne,$r.sample=function(e){return(Bo(e)?Jr:Qn)(e)},$r.size=function(e){if(null==e)return 0;if(Fo(e))return aa(e)?cr(e):e.length;var t=ds(e);return t==w||t==P?e.size:Mn(e).length},$r.snakeCase=Wa,$r.some=function(t,r,n){var i=Bo(t)?Lt:ii;return n&&bs(t,r,n)&&(r=e),i(t,cs(r,3))},$r.sortedIndex=function(e,t){return si(e,t)},$r.sortedIndexBy=function(e,t,r){return oi(e,t,cs(r,2))},$r.sortedIndexOf=function(e,t){var r=null==e?0:e.length;if(r){var n=si(e,t);if(n<r&&zo(e[n],t))return n}return-1},$r.sortedLastIndex=function(e,t){return si(e,t,!0)},$r.sortedLastIndexBy=function(e,t,r){return oi(e,t,cs(r,2),!0)},$r.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var r=si(e,t,!0)-1;if(zo(e[r],t))return r}return-1},$r.startCase=Ga,$r.startsWith=function(e,t,r){return e=ma(e),r=null==r?0:an(da(r),0,e.length),t=ui(t),e.slice(r,r+t.length)==t},$r.subtract=Sc,$r.sum=function(e){return e&&e.length?Ft(e,nc):0},$r.sumBy=function(e,t){return e&&e.length?Ft(e,cs(t,2)):0},$r.template=function(t,r,n){var i=$r.templateSettings;n&&bs(t,r,n)&&(r=e),t=ma(t),r=wa({},r,i,Xi);var s,o,a=wa({},r.imports,i.imports,Xi),c=Ra(a),u=Jt(a,c),h=0,l=r.interpolate||me,f="__p += '",p=Ne((r.escape||me).source+"|"+l.source+"|"+(l===J?he:me).source+"|"+(r.evaluate||me).source+"|$","g"),d="//# sourceURL="+(Me.call(r,"sourceURL")?(r.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++nt+"]")+"\n";t.replace(p,(function(e,r,n,i,a,c){return n||(n=i),f+=t.slice(h,c).replace(be,rr),r&&(s=!0,f+="' +\n__e("+r+") +\n'"),a&&(o=!0,f+="';\n"+a+";\n__p += '"),n&&(f+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),h=c+e.length,e})),f+="';\n";var g=Me.call(r,"variable")&&r.variable;if(g){if(ce.test(g))throw new Ie("Invalid `variable` option passed into `_.template`")}else f="with (obj) {\n"+f+"\n}\n";f=(o?f.replace(q,""):f).replace(H,"$1").replace(K,"$1;"),f="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(s?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var y=Xa((function(){return Oe(c,d+"return "+f).apply(e,u)}));if(y.source=f,Jo(y))throw y;return y},$r.times=function(e,t){if((e=da(e))<1||e>c)return[];var r=h,n=mr(e,h);t=cs(t),e-=h;for(var i=Wt(n,t);++r<e;)t(r);return i},$r.toFinite=pa,$r.toInteger=da,$r.toLength=ga,$r.toLower=function(e){return ma(e).toLowerCase()},$r.toNumber=ya,$r.toSafeInteger=function(e){return e?an(da(e),-9007199254740991,c):0===e?e:0},$r.toString=ma,$r.toUpper=function(e){return ma(e).toUpperCase()},$r.trim=function(t,r,n){if((t=ma(t))&&(n||r===e))return Gt(t);if(!t||!(r=ui(r)))return t;var i=ur(t),s=ur(r);return wi(i,Xt(i,s),Zt(i,s)+1).join("")},$r.trimEnd=function(t,r,n){if((t=ma(t))&&(n||r===e))return t.slice(0,hr(t)+1);if(!t||!(r=ui(r)))return t;var i=ur(t);return wi(i,0,Zt(i,ur(r))+1).join("")},$r.trimStart=function(t,r,n){if((t=ma(t))&&(n||r===e))return t.replace(re,"");if(!t||!(r=ui(r)))return t;var i=ur(t);return wi(i,Xt(i,ur(r))).join("")},$r.truncate=function(t,r){var n=30,i="...";if(ea(r)){var s="separator"in r?r.separator:s;n="length"in r?da(r.length):n,i="omission"in r?ui(r.omission):i}var o=(t=ma(t)).length;if(nr(t)){var a=ur(t);o=a.length}if(n>=o)return t;var c=n-cr(i);if(c<1)return i;var u=a?wi(a,0,c).join(""):t.slice(0,c);if(s===e)return u+i;if(a&&(c+=u.length-c),sa(s)){if(t.slice(c).search(s)){var h,l=u;for(s.global||(s=Ne(s.source,ma(le.exec(s))+"g")),s.lastIndex=0;h=s.exec(l);)var f=h.index;u=u.slice(0,f===e?c:f)}}else if(t.indexOf(ui(s),c)!=c){var p=u.lastIndexOf(s);p>-1&&(u=u.slice(0,p))}return u+i},$r.unescape=function(e){return(e=ma(e))&&F.test(e)?e.replace(B,lr):e},$r.uniqueId=function(e){var t=++De;return ma(e)+t},$r.upperCase=Ya,$r.upperFirst=Ja,$r.each=mo,$r.eachRight=bo,$r.first=Vs,ac($r,function(){var e={};return _n($r,(function(t,r){Me.call($r.prototype,r)||(e[r]=t)})),e}(),{chain:!1}),$r.VERSION="4.17.21",Ot(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){$r[e].placeholder=$r})),Ot(["drop","take"],(function(t,r){Kr.prototype[t]=function(n){n=n===e?1:vr(da(n),0);var i=this.__filtered__&&!r?new Kr(this):this.clone();return i.__filtered__?i.__takeCount__=mr(n,i.__takeCount__):i.__views__.push({size:mr(n,h),type:t+(i.__dir__<0?"Right":"")}),i},Kr.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),Ot(["filter","map","takeWhile"],(function(e,t){var r=t+1,n=1==r||3==r;Kr.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:cs(e,3),type:r}),t.__filtered__=t.__filtered__||n,t}})),Ot(["head","last"],(function(e,t){var r="take"+(t?"Right":"");Kr.prototype[e]=function(){return this[r](1).value()[0]}})),Ot(["initial","tail"],(function(e,t){var r="drop"+(t?"":"Right");Kr.prototype[e]=function(){return this.__filtered__?new Kr(this):this[r](1)}})),Kr.prototype.compact=function(){return this.filter(nc)},Kr.prototype.find=function(e){return this.filter(e).head()},Kr.prototype.findLast=function(e){return this.reverse().find(e)},Kr.prototype.invokeMap=Jn((function(e,t){return"function"==typeof e?new Kr(this):this.map((function(r){return xn(r,e,t)}))})),Kr.prototype.reject=function(e){return this.filter(Lo(cs(e)))},Kr.prototype.slice=function(t,r){t=da(t);var n=this;return n.__filtered__&&(t>0||r<0)?new Kr(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),r!==e&&(n=(r=da(r))<0?n.dropRight(-r):n.take(r-t)),n)},Kr.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Kr.prototype.toArray=function(){return this.take(h)},_n(Kr.prototype,(function(t,r){var n=/^(?:filter|find|map|reject)|While$/.test(r),i=/^(?:head|last)$/.test(r),s=$r[i?"take"+("last"==r?"Right":""):r],o=i||/^find/.test(r);s&&($r.prototype[r]=function(){var r=this.__wrapped__,a=i?[1]:arguments,c=r instanceof Kr,u=a[0],h=c||Bo(r),l=function(e){var t=s.apply($r,jt([e],a));return i&&f?t[0]:t};h&&n&&"function"==typeof u&&1!=u.length&&(c=h=!1);var f=this.__chain__,p=!!this.__actions__.length,d=o&&!f,g=c&&!p;if(!o&&h){r=g?r:new Kr(this);var y=t.apply(r,a);return y.__actions__.push({func:fo,args:[l],thisArg:e}),new Hr(y,f)}return d&&g?t.apply(this,a):(y=this.thru(l),d?i?y.value()[0]:y.value():y)})})),Ot(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Re[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",n=/^(?:pop|shift)$/.test(e);$r.prototype[e]=function(){var e=arguments;if(n&&!this.__chain__){var i=this.value();return t.apply(Bo(i)?i:[],e)}return this[r]((function(r){return t.apply(Bo(r)?r:[],e)}))}})),_n(Kr.prototype,(function(e,t){var r=$r[t];if(r){var n=r.name+"";Me.call(xr,n)||(xr[n]=[]),xr[n].push({name:t,func:r})}})),xr[zi(e,2).name]=[{name:"wrapper",func:e}],Kr.prototype.clone=function(){var e=new Kr(this.__wrapped__);return e.__actions__=Ti(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ti(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ti(this.__views__),e},Kr.prototype.reverse=function(){if(this.__filtered__){var e=new Kr(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Kr.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,r=Bo(e),n=t<0,i=r?e.length:0,s=function(e,t,r){for(var n=-1,i=r.length;++n<i;){var s=r[n],o=s.size;switch(s.type){case"drop":e+=o;break;case"dropRight":t-=o;break;case"take":t=mr(t,e+o);break;case"takeRight":e=vr(e,t-o)}}return{start:e,end:t}}(0,i,this.__views__),o=s.start,a=s.end,c=a-o,u=n?a:o-1,h=this.__iteratees__,l=h.length,f=0,p=mr(c,this.__takeCount__);if(!r||!n&&i==c&&p==c)return di(e,this.__actions__);var d=[];e:for(;c--&&f<p;){for(var g=-1,y=e[u+=t];++g<l;){var v=h[g],m=v.iteratee,b=v.type,_=m(y);if(2==b)y=_;else if(!_){if(1==b)continue e;break e}}d[f++]=y}return d},$r.prototype.at=po,$r.prototype.chain=function(){return lo(this)},$r.prototype.commit=function(){return new Hr(this.value(),this.__chain__)},$r.prototype.next=function(){this.__values__===e&&(this.__values__=fa(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?e:this.__values__[this.__index__++]}},$r.prototype.plant=function(t){for(var r,n=this;n instanceof qr;){var i=ks(n);i.__index__=0,i.__values__=e,r?s.__wrapped__=i:r=i;var s=i;n=n.__wrapped__}return s.__wrapped__=t,r},$r.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Kr){var r=t;return this.__actions__.length&&(r=new Kr(this)),(r=r.reverse()).__actions__.push({func:fo,args:[Zs],thisArg:e}),new Hr(r,this.__chain__)}return this.thru(Zs)},$r.prototype.toJSON=$r.prototype.valueOf=$r.prototype.value=function(){return di(this.__wrapped__,this.__actions__)},$r.prototype.first=$r.prototype.head,ot&&($r.prototype[ot]=function(){return this}),$r}();pt?((pt.exports=fr)._=fr,ft._=fr):lt._=fr}.call(oh);var ch=Object.defineProperty,uh=Object.defineProperties,hh=Object.getOwnPropertyDescriptors,lh=Object.getOwnPropertySymbols,fh=Object.prototype.hasOwnProperty,ph=Object.prototype.propertyIsEnumerable,dh=(e,t,r)=>t in e?ch(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,gh=(e,t)=>{for(var r in t||(t={}))fh.call(t,r)&&dh(e,r,t[r]);if(lh)for(var r of lh(t))ph.call(t,r)&&dh(e,r,t[r]);return e},yh=(e,t)=>uh(e,hh(t));function vh(e,t,r){let n;const i=mh(e);return t.rpcMap&&(n=t.rpcMap[i]),n||(n=`https://rpc.walletconnect.com/v1?chainId=eip155:${i}&projectId=${r}`),n}function mh(e){return e.includes("eip155")?Number(e.split(":")[1]):Number(e)}function bh(e){return e.map((e=>`${e.split(":")[0]}:${e.split(":")[1]}`))}function _h(e){var t,r,n,i;const s={};if(o=e,Object.getPrototypeOf(o)!==Object.prototype||!Object.keys(o).length)return s;var o;for(const[a,c]of Object.entries(e)){const e=Mu(a)?[a]:c.chains,o=c.methods||[],u=c.events||[],h=c.rpcMap||{},l=Du(a);s[l]=yh(gh(gh({},s[l]),c),{chains:Lu(e,null==(t=s[l])?void 0:t.chains),methods:Lu(o,null==(r=s[l])?void 0:r.methods),events:Lu(u,null==(n=s[l])?void 0:n.events),rpcMap:gh(gh({},h),null==(i=s[l])?void 0:i.rpcMap)})}return s}function wh(e){return e.includes(":")?e.split(":")[2]:e}function Eh(e){const t={};for(const[r,n]of Object.entries(e)){const e=n.methods||[],i=n.events||[],s=n.accounts||[],o=Mu(r)?[r]:n.chains?n.chains:bh(n.accounts);t[r]={chains:o,methods:e,events:i,accounts:s}}return t}const Sh={},Ih=e=>Sh[e],Oh=(e,t)=>{Sh[e]=t};class Ph{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=Ih("events"),this.client=Ih("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const r=t||vh(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(nh,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e&&e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2]))||[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{var r;e[t]=this.createHttpProvider(t,null==(r=this.namespace.rpcMap)?void 0:r[t])})),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||vh(e,this.namespace);return typeof r>"u"?void 0:new Zs(new eh(r,Ih("disableProviderPing")))}}class Ah{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=Ih("events"),this.client=Ih("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){const r=mh(e);if(!this.httpProviders[r]){const e=t||vh(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!e)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,e)}this.chainId=r,this.events.emit(nh,`${this.name}:${r}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const r=t||vh(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new Zs(new eh(r,Ih("disableProviderPing")))}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{var r;const n=mh(t);e[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[t])})),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,r;let n=e.request.params?null==(t=e.request.params[0])?void 0:t.chainId:"0x0";n=n.startsWith("0x")?n:`0x${n}`;const i=parseInt(n,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else{if(!this.namespace.methods.includes("wallet_switchEthereumChain"))throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:n}]},chainId:null==(r=this.namespace.chains)?void 0:r[0]}),this.setDefaultChain(`${i}`)}return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class Nh{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=Ih("events"),this.client=Ih("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const r=t||vh(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.chainId=e,this.events.emit(nh,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{var r;e[t]=this.createHttpProvider(t,null==(r=this.namespace.rpcMap)?void 0:r[t])})),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||vh(e,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new Zs(new eh(r,Ih("disableProviderPing")))}}class Th{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=Ih("events"),this.client=Ih("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const r=t||vh(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(nh,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{var r;e[t]=this.createHttpProvider(t,null==(r=this.namespace.rpcMap)?void 0:r[t])})),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||vh(e,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new Zs(new eh(r,Ih("disableProviderPing")))}}class xh{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=Ih("events"),this.client=Ih("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const r=t||this.getCardanoRPCUrl(e);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(nh,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{const r=this.getCardanoRPCUrl(t);e[t]=this.createHttpProvider(t,r)})),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||this.getCardanoRPCUrl(e);return typeof r>"u"?void 0:new Zs(new eh(r,Ih("disableProviderPing")))}}class Rh{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=Ih("events"),this.client=Ih("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const r=t||vh(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.chainId=e,this.events.emit(nh,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{var r;e[t]=this.createHttpProvider(t,null==(r=this.namespace.rpcMap)?void 0:r[t])})),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||vh(e,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new Zs(new eh(r,Ih("disableProviderPing")))}}class jh{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=Ih("events"),this.client=Ih("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const r=t||vh(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.chainId=e,this.events.emit(nh,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{var r;e[t]=this.createHttpProvider(t,null==(r=this.namespace.rpcMap)?void 0:r[t])})),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||vh(e,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new Zs(new eh(r,Ih("disableProviderPing")))}}var Ch=Object.defineProperty,Uh=Object.defineProperties,Lh=Object.getOwnPropertyDescriptors,Mh=Object.getOwnPropertySymbols,Dh=Object.prototype.hasOwnProperty,kh=Object.prototype.propertyIsEnumerable,$h=(e,t,r)=>t in e?Ch(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,zh=(e,t)=>{for(var r in t||(t={}))Dh.call(t,r)&&$h(e,r,t[r]);if(Mh)for(var r of Mh(t))kh.call(t,r)&&$h(e,r,t[r]);return e},qh=(e,t)=>Uh(e,Lh(t));class Hh{constructor(e){this.events=new u,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(null==e?void 0:e.logger)<"u"&&"string"!=typeof(null==e?void 0:e.logger)?e.logger:Zr(hn({level:(null==e?void 0:e.logger)||th})),this.disableProviderPing=(null==e?void 0:e.disableProviderPing)||!1}static async init(e){const t=new Hh(e);return await t.initialize(),t}async request(e,t){const[r,n]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(r).request({request:zh({},e),chainId:`${r}:${n}`,topic:this.session.topic})}sendAsync(e,t,r){this.request(e,r).then((e=>t(null,e))).catch((e=>t(e,void 0)))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:null==(e=this.session)?void 0:e.topic,reason:$u("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:r,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});r&&(this.uri=r,this.events.emit("display_uri",r)),await n().then((e=>{this.session=e,this.namespaces||(this.namespaces=Eh(e.namespaces),this.persist("namespaces",this.namespaces))})).catch((e=>{if(e.message!==hu)throw e;t++}))}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[r,n]=this.validateChain(e);this.getProvider(r).setDefaultChain(n,t)}catch(r){if(!/Please call connect/.test(r.message))throw r}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(zu(t)){for(const r of t)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await xu.init({logger:this.providerOpts.logger||th,relayUrl:this.providerOpts.relayUrl||"wss://relay.walletconnect.com",projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map((e=>Du(e))))];Oh("client",this.client),Oh("events",this.events),Oh("disableProviderPing",this.disableProviderPing),e.forEach((e=>{if(!this.session)return;const t=function(e,t){const r=Object.keys(t.namespaces).filter((t=>t.includes(e)));if(!r.length)return[];const n=[];return r.forEach((e=>{const r=t.namespaces[e].accounts;n.push(...r)})),n}(e,this.session),r=bh(t),n=function(e={},t={}){const r=_h(e),n=_h(t);return ah.exports.merge(r,n)}(this.namespaces,this.optionalNamespaces),i=qh(zh({},n[e]),{accounts:t,chains:r});switch(e){case"eip155":this.rpcProviders[e]=new Ah({namespace:i});break;case"solana":this.rpcProviders[e]=new Nh({namespace:i});break;case"cosmos":this.rpcProviders[e]=new Th({namespace:i});break;case"polkadot":this.rpcProviders[e]=new Ph({namespace:i});break;case"cip34":this.rpcProviders[e]=new xh({namespace:i});break;case"elrond":this.rpcProviders[e]=new Rh({namespace:i});break;case"multiversx":this.rpcProviders[e]=new jh({namespace:i})}}))}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",(e=>{this.events.emit("session_ping",e)})),this.client.on("session_event",(e=>{const{params:t}=e,{event:r}=t;if("accountsChanged"===r.name){const e=r.data;e&&zu(e)&&this.events.emit("accountsChanged",e.map(wh))}else"chainChanged"===r.name?this.onChainChanged(t.chainId):this.events.emit(r.name,r.data);this.events.emit("session_event",e)})),this.client.on("session_update",(({topic:e,params:t})=>{var r;const{namespaces:n}=t,i=null==(r=this.client)?void 0:r.session.get(e);this.session=qh(zh({},i),{namespaces:n}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})})),this.client.on("session_delete",(async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",qh(zh({},$u("USER_DISCONNECTED")),{data:e.topic}))})),this.on(nh,(e=>{this.onChainChanged(e,!0)}))}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach((e=>{var t;this.getProvider(e).updateNamespace(null==(t=this.session)?void 0:t.namespaces[e])}))}setNamespaces(e){const{namespaces:t,optionalNamespaces:r,sessionProperties:n}=e;t&&Object.keys(t).length&&(this.namespaces=t),r&&Object.keys(r).length&&(this.optionalNamespaces=r),this.sessionProperties=n,this.persist("namespaces",t),this.persist("optionalNamespaces",r)}validateChain(e){const[t,r]=(null==e?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,r];if(t&&!Object.keys(this.namespaces||{}).map((e=>Du(e))).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&r)return[t,r];const n=Du(Object.keys(this.namespaces)[0]);return[n,this.rpcProviders[n].getDefaultChain()]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){var r;if(!this.namespaces)return;const[n,i]=this.validateChain(e);t||this.getProvider(n).setDefaultChain(i),(null!=(r=this.namespaces[n])?r:this.namespaces[`${n}:${i}`]).defaultChain=i,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",i)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${rh}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${rh}/${e}`)}}const Kh=Hh,Bh=["eth_sendTransaction","personal_sign"],Vh=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Fh=["chainChanged","accountsChanged"],Wh=["message","disconnect","connect"];var Gh=Object.defineProperty,Yh=Object.defineProperties,Jh=Object.getOwnPropertyDescriptors,Qh=Object.getOwnPropertySymbols,Xh=Object.prototype.hasOwnProperty,Zh=Object.prototype.propertyIsEnumerable,el=(e,t,r)=>t in e?Gh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,tl=(e,t)=>{for(var r in t||(t={}))Xh.call(t,r)&&el(e,r,t[r]);if(Qh)for(var r of Qh(t))Zh.call(t,r)&&el(e,r,t[r]);return e},rl=(e,t)=>Yh(e,Jh(t));function nl(e){return Number(e[0].split(":")[1])}function il(e){return`0x${e.toString(16)}`}class sl{constructor(){this.events=new c.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY="wc@2:ethereum_provider:",this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new sl;return await t.initialize(e),t}async request(e){return await this.signer.request(e,this.formatChainId(this.chainId))}sendAsync(e,t){this.signer.sendAsync(e,t,this.formatChainId(this.chainId))}get connected(){return!!this.signer.client&&this.signer.client.core.relayer.connected}get connecting(){return!!this.signer.client&&this.signer.client.core.relayer.connecting}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:r}=function(e){const{chains:t,optionalChains:r,methods:n,optionalMethods:i,events:s,optionalEvents:o,rpcMap:a}=e;if(!nr(t))throw new Error("Invalid chains");const c={chains:t,methods:n||Bh,events:s||Fh,rpcMap:tl({},t.length?{[nl(t)]:a[nl(t)]}:{})},u=null==s?void 0:s.filter((e=>!Fh.includes(e))),h=null==n?void 0:n.filter((e=>!Bh.includes(e)));if(!(r||o||i||null!=u&&u.length||null!=h&&h.length))return{required:t.length?c:void 0};const l=(null==u?void 0:u.length)&&(null==h?void 0:h.length)||!r,f={chains:[...new Set(l?c.chains.concat(r||[]):r)],methods:[...new Set(c.methods.concat(null!=i&&i.length?i:Vh))],events:[...new Set(c.events.concat(o||Wh))],rpcMap:a};return{required:t.length?c:void 0,optional:r.length?f:void 0}}(this.rpc);try{const n=await new Promise((async(n,i)=>{var s;this.rpc.showQrModal&&(null==(s=this.modal)||s.subscribeModal((e=>{!e.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),i(new Error("Connection request reset. Please try again.")))}))),await this.signer.connect(rl(tl({namespaces:tl({},t&&{[this.namespace]:t})},r&&{optionalNamespaces:{[this.namespace]:r}}),{pairingTopic:null==e?void 0:e.pairingTopic})).then((e=>{n(e)})).catch((e=>{i(new Error(e.message))}))}));if(!n)return;this.setChainIds(this.rpc.chains);const i=function(e,t=[]){const r=[];return Object.keys(e).forEach((n=>{if(t.length&&!t.includes(n))return;const i=e[n];r.push(...i.accounts)})),r}(n.namespaces,[this.namespace]);this.setAccounts(i),this.events.emit("connect",{chainId:il(this.chainId)})}catch(n){throw this.signer.logger.error(n),n}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",(e=>{const{params:t}=e,{event:r}=t;"accountsChanged"===r.name?(this.accounts=this.parseAccounts(r.data),this.events.emit("accountsChanged",this.accounts)):"chainChanged"===r.name?this.setChainId(this.formatChainId(r.data)):this.events.emit(r.name,r.data),this.events.emit("session_event",e)})),this.signer.on("chainChanged",(e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",il(this.chainId)),this.persist()})),this.signer.on("session_update",(e=>{this.events.emit("session_update",e)})),this.signer.on("session_delete",(e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",rl(tl({},function(e){const{message:t,code:r}=rr[e];return{message:t,code:r}}("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))})),this.signer.on("display_uri",(e=>{var t,r;this.rpc.showQrModal&&(null==(t=this.modal)||t.closeModal(),null==(r=this.modal)||r.openModal({uri:e})),this.events.emit("display_uri",e)}))}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return"string"==typeof e&&e.startsWith(`${this.namespace}:`)}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter((e=>this.isCompatibleChainId(e))).map((e=>this.parseChainId(e)));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",il(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,r,n]=e.split(":");return{chainId:`${t}:${r}`,address:n}}setAccounts(e){this.accounts=e.filter((e=>this.parseChainId(this.parseAccountId(e).chainId)===this.chainId)).map((e=>this.parseAccountId(e).address)),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,r;const n=null!=(t=null==e?void 0:e.chains)?t:[],i=null!=(r=null==e?void 0:e.optionalChains)?r:[],s=n.concat(i);if(!s.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const o=n.length?(null==e?void 0:e.methods)||Bh:[],a=n.length?(null==e?void 0:e.events)||Fh:[],c=(null==e?void 0:e.optionalMethods)||[],u=(null==e?void 0:e.optionalEvents)||[],h=(null==e?void 0:e.rpcMap)||this.buildRpcMap(s,e.projectId),l=(null==e?void 0:e.qrModalOptions)||void 0;return{chains:null==n?void 0:n.map((e=>this.formatChainId(e))),optionalChains:i.map((e=>this.formatChainId(e))),methods:o,events:a,optionalMethods:c,optionalEvents:u,rpcMap:h,showQrModal:!(null==e||!e.showQrModal),qrModalOptions:l,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const r={};return e.forEach((e=>{r[e]=this.getRpcUrl(e,t)})),r}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?nl(this.rpc.chains):nl(this.rpc.optionalChains),this.signer=await Kh.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let e;try{const{WalletConnectModal:t}=await i((()=>import("./Cizri-kS.js").then((e=>e.i))),__vite__mapDeps([0,1,2]),import.meta.url);e=t}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(e)try{this.modal=new e(tl({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(t){throw this.signer.logger.error(t),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:r,rpcMap:n}=e;t&&nr(t)&&(this.rpc.chains=t.map((e=>this.formatChainId(e))),t.forEach((e=>{this.rpc.rpcMap[e]=(null==n?void 0:n[e])||this.getRpcUrl(e)}))),r&&nr(r)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=null==r?void 0:r.map((e=>this.formatChainId(e))),r.forEach((e=>{this.rpc.rpcMap[e]=(null==n?void 0:n[e])||this.getRpcUrl(e)})))}getRpcUrl(e,t){var r;return(null==(r=this.rpc.rpcMap)?void 0:r[e])||`https://rpc.walletconnect.com/v1/?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:null==t?void 0:t.accounts),this.setAccounts(null==t?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return"string"==typeof e||e instanceof String?[this.parseAccount(e)]:e.map((e=>this.parseAccount(e)))}}export{Wh as OPTIONAL_EVENTS,Vh as OPTIONAL_METHODS,Fh as REQUIRED_EVENTS,Bh as REQUIRED_METHODS,sl as default};
